{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "d99f0b89_24aebf78",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 5064
      },
      "writtenOn": "2020-10-23T15:35:38Z",
      "side": 1,
      "message": "mfoltz: Can you provide some input on how Chromium would like to handle this in your desktop_capture code?\n\n",
      "revId": "a5685075bdea023492090bec83a6064b71b20b84",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "2493b102_185a816f",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 8046
      },
      "writtenOn": "2020-10-23T15:50:59Z",
      "side": 1,
      "message": "We actually had a long (very long) discussion about this with Mark, we went through many iterations, where the very first one was actually about skipping the Chromium dialog and that\u0027s why the change description didn\u0027t match. This should be the version approved by Mark as we were basically not allowed any UI changes on Chromium side and the only minor change we did was slight modification of the \"Window tab\" in the preview dialog to behave like \"Screen tab\".",
      "parentUuid": "d99f0b89_24aebf78",
      "revId": "a5685075bdea023492090bec83a6064b71b20b84",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "78403895_b4df492e",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 5064
      },
      "writtenOn": "2020-10-27T18:31:56Z",
      "side": 1,
      "message": "Hi Jan,\n\nThanks for your patience. I\u0027m still struggling a little to understand the specifics of the XDG interaction, since I originally misunderstood which picker we plan to show, I think.\n\nWhat is the specific mechanism by which we suppress the XDG picker?\n\nThanks,\n\nWez\n",
      "revId": "a5685075bdea023492090bec83a6064b71b20b84",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "42b60dd1_afd0523c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 8046
      },
      "writtenOn": "2020-10-27T19:26:52Z",
      "side": 1,
      "message": "Hi,\n\nI will try to explain the concept of xdg-desktop-portal (XDP). XDP is a DBus interface, primarily introduced for sandboxed applications to provide a way how those application can access things outside sandbox. Think of for example a file dialog. In strict sandbox environment apps wouldn\u0027t have access to system files so opening a file dialog inside sandbox would not allow them to open anything useful. That\u0027s where XDP comes on the stage. As I said it\u0027s a DBus interface which is by default accessible by everyone and consists from several portals . In the file dialog scenario it\u0027s a FileChooser portal which lets apps to send a request through XDP and open a file dialog outside the sandbox environment. With screen sharing it\u0027s quite similar, because Wayland is sort of similar to sandboxed environment, because apps on Wayland don\u0027t see each other and because of this we have to go through ScreenSharing portal.\n\nIf you want to share a screen on Wayland, you have to make a ScreenSharing portal request, specifying whether you want to request a screen or a window and then a dialog from XDP is shown where the user has to explicitly allow access to requested content. That\u0027s the only way how we can access screen content or access to some other app window.\n\nIn case of Chromium, we basically want to access screen/window two times, for the first time it\u0027s in the Chromium preview dialog and again on the web page itself, because each uses new webrtc::DesktopCapturer instance. Originally XDP implementation was part of webrtc::DesktopCapturer and deleted together and that was the reason why we did two XDP calls resulting into two XDP dialogs. With this change we no longer keep XDP interface as part of webrtc::DesktopCapturer and it\u0027s left alive so we avoid the second XDP screensharing request where the user would basically pick the same screen/window as before and therefore it was useless and annoying. \n\nDoes this make sense?",
      "parentUuid": "78403895_b4df492e",
      "revId": "a5685075bdea023492090bec83a6064b71b20b84",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "86abc448_6c204e66",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 14134
      },
      "writtenOn": "2020-10-27T20:38:29Z",
      "side": 1,
      "message": "Wez, \n\nThe design doc for this project has some of the background information covered by Jan.\n\nhttps://docs.google.com/document/d/1DTO1GzA1Iwdhw4KQPYSW9iRwA0QRi0Bsobbq6YCK77g/edit?usp\u003dsharing\n\n",
      "revId": "a5685075bdea023492090bec83a6064b71b20b84",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f97233e1_7bb7f080",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 8046
      },
      "writtenOn": "2020-10-27T20:43:45Z",
      "side": 1,
      "message": "This was the very first proposal where we didn\u0027t want the Chromium dialog to show up, which was not allowed in the end, but it should help to understand how it works with portals.",
      "parentUuid": "86abc448_6c204e66",
      "revId": "a5685075bdea023492090bec83a6064b71b20b84",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "87126abf_3b191607",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 5064
      },
      "writtenOn": "2020-10-29T01:01:39Z",
      "side": 1,
      "message": "Thanks Jan.\n\nReading through the document that Mark linked, if I understand correctly, the current situation is actually that we show _three_ pickers, not two - one XDG screen picker, then the Chromium picker, and then another XDG picker - and we want to reduce that to just the initial XDG ScreenSharing picker \u0026 the Chromium picker.  That\u0027s the detail I was confused about. ðŸ˜Š\n\nBut to suppress the second XDG ScreenSharing picker when we actually start the capture do we need just to create the capturer over the same XDG ScreenSharing portal connection, or is there a picker per-request-Id even over a single XDG connection?\n\nEither way, we need to convey sufficient information in the DesktopCaptureOptions of the CreateCapturer request used for the actual capture to link it back to the CreateCapturer call used for the picker.  With the current implementation in the matching Chromium CL I\u0027m not sure how the request-Id is getting preserved between the picker capture operation, and the one used for the actual capture?",
      "parentUuid": "42b60dd1_afd0523c",
      "revId": "a5685075bdea023492090bec83a6064b71b20b84",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    }
  ]
}