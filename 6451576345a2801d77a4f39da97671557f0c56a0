{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "8eee000e_d2f9f45c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 5053
      },
      "writtenOn": "2021-01-22T06:12:53Z",
      "side": 1,
      "message": "This isn\u0027t ready for review quite yet, still need to clean some stuff up and add tests. Just wanted to gather feedback on the concept first.\n\nI think it\u0027s a very good idea to make usrsctp operate on a single thread to insulate us against further race condition bugs. There are a few options I can think of each with some downside:\n\n1. Use network thread as usrsctp timer thread (this CL)\n\n   Cons: Doesn\u0027t work if two PeerConnectionFactories use different network threads, but that should only happen in a test environment anyway (right?). Should work at least for chromium and every user of the mobile SDKs.\n\n2. Use new standalone thread for timer operations, wrapping usrsctp_handle_timers in a global mutex.\n\n   Cons: Introduces yet another mutex, on top of the ones that usrsctp uses internally. Also, would we use this mutex for every method or just usrsctp_handle_timers/usrsctp_close?\n\n3. Use new standalone thread, piping *all* usrsctp operations (including usrsctp_sendv, usrsctp_conninput) through it.\n\n   Cons: Additional threading complexity; makes every send operation even more delayed because it must go from the network thread to the usrsctp thread and back again.\n\n\n\nThoughts? Any other options I may be overlooking?",
      "revId": "6451576345a2801d77a4f39da97671557f0c56a0",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c076233f_96fd5bea",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 5087
      },
      "writtenOn": "2021-01-22T09:09:37Z",
      "side": 1,
      "message": "Early feedback/thoughts from my side:\n\nI prefer option (1) and users with the requirement of using different network threads in different PeerConnectionFactories should be able to switch to the single_threaded_mode\u003dfalse mode.\n\nAdding also +titovartem@ for feedback/thoughts.",
      "parentUuid": "8eee000e_d2f9f45c",
      "revId": "6451576345a2801d77a4f39da97671557f0c56a0",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e3f2d077_35e4e444",
        "filename": "media/sctp/sctp_transport.cc",
        "patchSetId": 2
      },
      "lineNbr": 388,
      "author": {
        "id": 6337
      },
      "writtenOn": "2021-01-22T11:12:11Z",
      "side": 1,
      "message": "Should we first stop the task?",
      "range": {
        "startLine": 388,
        "startChar": 8,
        "endLine": 388,
        "endChar": 44
      },
      "revId": "6451576345a2801d77a4f39da97671557f0c56a0",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "7667b70c_29b38f10",
        "filename": "media/sctp/sctp_transport.cc",
        "patchSetId": 2
      },
      "lineNbr": 388,
      "author": {
        "id": 5053
      },
      "writtenOn": "2021-01-22T20:45:44Z",
      "side": 1,
      "message": "Not necessary here, especially since we should be on the thread the task runs on, but the code does looks safer that way.",
      "parentUuid": "e3f2d077_35e4e444",
      "range": {
        "startLine": 388,
        "startChar": 8,
        "endLine": 388,
        "endChar": 44
      },
      "revId": "6451576345a2801d77a4f39da97671557f0c56a0",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3846e5b4_79597951",
        "filename": "media/sctp/sctp_transport.h",
        "patchSetId": 2
      },
      "lineNbr": 79,
      "author": {
        "id": 5087
      },
      "writtenOn": "2021-01-22T09:09:37Z",
      "side": 1,
      "message": "Should this be an \"also\"?",
      "range": {
        "startLine": 79,
        "startChar": 62,
        "endLine": 79,
        "endChar": 68
      },
      "revId": "6451576345a2801d77a4f39da97671557f0c56a0",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "92ccbfbd_090c4066",
        "filename": "media/sctp/sctp_transport.h",
        "patchSetId": 2
      },
      "lineNbr": 79,
      "author": {
        "id": 5053
      },
      "writtenOn": "2021-01-22T20:45:44Z",
      "side": 1,
      "message": "Yep, thanks",
      "parentUuid": "3846e5b4_79597951",
      "range": {
        "startLine": 79,
        "startChar": 62,
        "endLine": 79,
        "endChar": 68
      },
      "revId": "6451576345a2801d77a4f39da97671557f0c56a0",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    }
  ]
}