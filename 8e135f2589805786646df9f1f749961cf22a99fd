{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "5dba85d9_68981dfc",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 5234
      },
      "writtenOn": "2021-08-30T11:20:46Z",
      "side": 1,
      "message": "If it is intended to be efficient, I would recommend keeping an uint64_t member variable to cache bits read from the input (below I\u0027m assuming normalized, with the msb always being next bit to read, but it might be better to leave cache_ unmodified and instead have an and operation to eliminate unwanted bits), and an inline ReadBits method like\n\nuint64_t ReadBits(int bits) {\n  if (bits \u003e\u003d remaining_bits_) {\n     remaining_bits -\u003d bits; \n     uint64_t val \u003d cache_ \u003e\u003e remaining_bits;\n     cache_ \u003c\u003c\u003d bits;\n     return val;\n   } else {\n     return ReadBitsSlow();\n   }\n}\n\nwhere ReadBitsSlow isn\u0027t inlined, and responsible for filling the cache when it runs out, as well as handling of end of buffer or any other errors. The intention is that the common case should be a single well-predicted branch and a few arithmetic instructions.",
      "revId": "8e135f2589805786646df9f1f749961cf22a99fd",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f7916d6a_bfcb8d5c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 5019
      },
      "writtenOn": "2021-08-30T11:49:06Z",
      "side": 1,
      "message": "That\u0027s a good advice, however efficiency is not the goal of this effort. Readability and binary size are.\n\nI think it would be good to do efficiency optimisation as a separate effort (including measuring how much cpu parsing takes and how much it can be optimised)",
      "parentUuid": "5dba85d9_68981dfc",
      "revId": "8e135f2589805786646df9f1f749961cf22a99fd",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "bc556c4f_3fc95ba8",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 5524
      },
      "writtenOn": "2021-08-30T12:32:24Z",
      "side": 1,
      "message": "lgtm with the caveat that I\u0027m not super well versed in how the nonsymmetric case works.",
      "revId": "8e135f2589805786646df9f1f749961cf22a99fd",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ee1e8f1f_55909b3b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 5234
      },
      "writtenOn": "2021-08-31T07:53:21Z",
      "side": 1,
      "message": "\u003e That\u0027s a good advice, however efficiency is not the goal of this effort. Readability and binary size are.\n\nFair enough. Maybe rephrase commit message, \"optimized for\" made me think efficiency was a goal.",
      "parentUuid": "f7916d6a_bfcb8d5c",
      "revId": "8e135f2589805786646df9f1f749961cf22a99fd",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "057316ff_7966c9f3",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 5019
      },
      "writtenOn": "2021-08-31T08:54:20Z",
      "side": 1,
      "message": "Is new description better?",
      "parentUuid": "ee1e8f1f_55909b3b",
      "revId": "8e135f2589805786646df9f1f749961cf22a99fd",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "71a5b49b_ac7e0e73",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 5234
      },
      "writtenOn": "2021-08-31T08:55:48Z",
      "side": 1,
      "message": "lgtm",
      "parentUuid": "057316ff_7966c9f3",
      "revId": "8e135f2589805786646df9f1f749961cf22a99fd",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "64cbf99e_72ee86f7",
        "filename": "rtc_base/bitstream_reader.h",
        "patchSetId": 3
      },
      "lineNbr": 124,
      "author": {
        "id": 5524
      },
      "writtenOn": "2021-08-30T12:32:24Z",
      "side": 1,
      "message": "nit: since `last_read_is_verified_` is initialized to true and never updated in the non-dchecked case, you could move the ctor out of here and only have the assignment `last_read_is_verified_ \u003d value;` within an #ifdef clause",
      "range": {
        "startLine": 124,
        "startChar": 0,
        "endLine": 124,
        "endChar": 23
      },
      "revId": "8e135f2589805786646df9f1f749961cf22a99fd",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a331ca38_3feca430",
        "filename": "rtc_base/bitstream_reader.h",
        "patchSetId": 3
      },
      "lineNbr": 124,
      "author": {
        "id": 5019
      },
      "writtenOn": "2021-08-30T13:01:45Z",
      "side": 1,
      "message": "you mean dtor? (there are two constructors that are not in this #ifdef clause)\nusually compiler can detect empty destructors and treat class as trivially destructible. But then again, optimising destruction of this class is likely not important.",
      "parentUuid": "64cbf99e_72ee86f7",
      "range": {
        "startLine": 124,
        "startChar": 0,
        "endLine": 124,
        "endChar": 23
      },
      "revId": "8e135f2589805786646df9f1f749961cf22a99fd",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3072fed5_5904169c",
        "filename": "rtc_base/bitstream_reader_unittest.cc",
        "patchSetId": 3
      },
      "lineNbr": 199,
      "author": {
        "id": 5524
      },
      "writtenOn": "2021-08-30T12:32:24Z",
      "side": 1,
      "message": "nit: spelling",
      "range": {
        "startLine": 199,
        "startChar": 51,
        "endLine": 199,
        "endChar": 61
      },
      "revId": "8e135f2589805786646df9f1f749961cf22a99fd",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d8dfa8bc_6256dfe7",
        "filename": "rtc_base/bitstream_reader_unittest.cc",
        "patchSetId": 3
      },
      "lineNbr": 199,
      "author": {
        "id": 5019
      },
      "writtenOn": "2021-08-30T13:01:45Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "3072fed5_5904169c",
      "range": {
        "startLine": 199,
        "startChar": 51,
        "endLine": 199,
        "endChar": 61
      },
      "revId": "8e135f2589805786646df9f1f749961cf22a99fd",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    }
  ]
}