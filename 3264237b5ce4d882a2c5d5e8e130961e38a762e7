{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "4cdd6349_56c0d575",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 5524
      },
      "writtenOn": "2023-06-14T14:11:54Z",
      "side": 1,
      "message": "Increasing the keyframe size will improve the spatial quality - but there is also a significant risk of adding delay and stuttering on constrained networks. Sacrificing quality for latency is a conscious decision here. Any change of this nature would need to be gated by an experiment so we can verify real-world impact under a variety of conditions.",
      "revId": "3264237b5ce4d882a2c5d5e8e130961e38a762e7",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "1ff0f967_c9638655",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 5825
      },
      "writtenOn": "2023-06-14T14:25:49Z",
      "side": 1,
      "message": "Agreed with Erik. Bigger frames mean higher delay. By settings optimal buffer size to 1 second you essentially tell encoder that it is OK to accumulate and keep 1s delay which is very high value for real-time apps (600ms, current default, is already quite high value).",
      "parentUuid": "4cdd6349_56c0d575",
      "revId": "3264237b5ce4d882a2c5d5e8e130961e38a762e7",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f3154bdf_be008c46",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 5825
      },
      "writtenOn": "2023-06-14T14:25:49Z",
      "side": 1,
      "message": "Bigger frames mean higher delays (it takes longer to transmit them over channel with a limited capacity).",
      "revId": "3264237b5ce4d882a2c5d5e8e130961e38a762e7",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "848b8a4c_d2f1a69d",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 18554
      },
      "writtenOn": "2023-06-15T01:33:01Z",
      "side": 1,
      "message": "`rc_buf_initial_sz` is translated into how many bits of buffer to used for first key frame, it is not necessary to increase the encoding latency [1]. But bigger key frame size could introduce transmit latency, that I will investigate. Overall, the size of hundred of delta frames could be decreased.\n\n[1] vp9_encoder.c - Chromium Code Search\nhttps://source.chromium.org/chromium/chromium/src/+/refs/heads/main:third_party/libvpx/source/libvpx/vp9/encoder/vp9_encoder.c;l\u003d1550;drc\u003d20911ffd8a0e1636801ddf303c17375fdedf9c83;bpv\u003d1;bpt\u003d1\n\nWhat interests me if that set maximum `rc_buf_initial_sz` has little impact on L1T1, and base layer of L1T3; The improvement comes mostly from higher layer of SVC. The rate controller of SVC is probably not optimal for SVC here.\n\nIt should exists some optimal points that the picture quality/bitrate improves `A-Persents`, with the COST of `B-Persents` longer latency.\n\nAgreed it should be very cautious to change current value. I will do more analysis on the delay and picture quality, then back to this CL.",
      "parentUuid": "1ff0f967_c9638655",
      "revId": "3264237b5ce4d882a2c5d5e8e130961e38a762e7",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "7d6d75ea_23bbbfe3",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 18005
      },
      "writtenOn": "2023-06-25T08:03:54Z",
      "side": 1,
      "message": "I wonder if any HW decoder/encoder in Chromium is following the HRD conformance for VP9/H.264/AV1, especially when we\u0027re operating at low-latency mode.\n\nFor the WebRTC pipeline in Chromium, decoding is driven by the render timing in RTC stack, ignoring the HRD params for H.264, while for VP9/AV1 I don\u0027t find Chromium handling this as well.\n\nAgree the increased key-frame size results in higher transmit latency, which needs to be measured. However I don\u0027t think this will (noticeably) increase the decoding latency when it\u0027s backed HW, and when the host decoder is not overlooking the HRD params in the bitstream.\n\nAdding Jerome@ and Dale@ to the discussion.",
      "revId": "3264237b5ce4d882a2c5d5e8e130961e38a762e7",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5b54daac_a8a713fc",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 6008
      },
      "writtenOn": "2023-06-26T16:20:20Z",
      "side": 1,
      "message": "No idea about the hardware decoders, so +jzern. This seems easy enough to experiment with though, but defer to RTC experts.",
      "parentUuid": "7d6d75ea_23bbbfe3",
      "revId": "3264237b5ce4d882a2c5d5e8e130961e38a762e7",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "8dc69c45_69e06a2a",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 7949
      },
      "writtenOn": "2023-06-26T19:24:32Z",
      "side": 1,
      "message": "\u003e No idea about the hardware decoders, so +jzern.\n\nI\u0027m not aware of any for AV1 and didn\u0027t get any other suggestions when I asked around. VP9 doesn\u0027t have any decoder model information in the bitstream.\n\n\u003e This seems easy enough to experiment with though, but defer to RTC experts.",
      "parentUuid": "5b54daac_a8a713fc",
      "revId": "3264237b5ce4d882a2c5d5e8e130961e38a762e7",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5fbb3ff3_59e8d0bc",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 5524
      },
      "writtenOn": "2023-06-27T08:59:10Z",
      "side": 1,
      "message": "Yeah, not really worried about decode latency - it\u0027s transmission latency when network constrained that\u0027s the main issue.",
      "parentUuid": "8dc69c45_69e06a2a",
      "revId": "3264237b5ce4d882a2c5d5e8e130961e38a762e7",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    }
  ]
}