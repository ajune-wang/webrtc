{
  "comments": [
    {
      "key": {
        "uuid": "6fbe5e5d_ba90d0f7",
        "filename": "rtc_base/BUILD.gn",
        "patchSetId": 3
      },
      "lineNbr": 943,
      "author": {
        "id": 5234
      },
      "writtenOn": "2019-08-09T06:28:25Z",
      "side": 0,
      "message": "I need some advice on where to move these library dependencies. I get link errors like\n\nFAILED: obj/sdk/mac_framework_objc_shared_library/WebRTC \n[...]\nUndefined symbols for architecture x86_64:\n  \"_OBJC_METACLASS_$_NSView\", referenced from:\n      _OBJC_METACLASS_$_RTCMTLNSVideoView in libmetal_objc.a(RTCMTLNSVideoView.o)\n\nAnd it seems NSView is part of \"Appkit\" (see https://developer.apple.com/documentation/appkit/nsview?language\u003dobjc), which isn\u0027t in the above list of frameworks.",
      "range": {
        "startLine": 937,
        "startChar": 0,
        "endLine": 943,
        "endChar": 5
      },
      "revId": "78a71386005ceac9bca63329a1c247f91a53e12c",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "969da87e_b8da25a8",
        "filename": "rtc_base/BUILD.gn",
        "patchSetId": 3
      },
      "lineNbr": 943,
      "author": {
        "id": 5087
      },
      "writtenOn": "2019-08-09T06:41:51Z",
      "side": 0,
      "message": "Hi, removing these could be an issue since \"libs\" are passed to the -framework linker flag in the final binary (https://gn.googlesource.com/gn/+/master/docs/reference.md#var_libs).\n\nSo it is possible that some WebRTC libs are replying on this list.\n\nWRT AppKit I think you are right, let\u0027s wait for Kari\u0027s here.",
      "parentUuid": "6fbe5e5d_ba90d0f7",
      "range": {
        "startLine": 937,
        "startChar": 0,
        "endLine": 943,
        "endChar": 5
      },
      "revId": "78a71386005ceac9bca63329a1c247f91a53e12c",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6f00c9bb_7d546a7c",
        "filename": "rtc_base/BUILD.gn",
        "patchSetId": 3
      },
      "lineNbr": 943,
      "author": {
        "id": 5234
      },
      "writtenOn": "2019-08-09T06:51:15Z",
      "side": 0,
      "message": "Right, it\u0027s not surprising that deleting these deps break the build. But I don\u0027t think they belong on this target after mac_utils is deleted, so question is where to move them.\n\nWhatever framework is needed for CFStringGetCString should be in the modules/desktop_capture:desktop_capture_generic target, which is where I moved the code depending on that. I don\u0027t quite understand this target though, it includes both mac-specific and windows-specific source files, and no #ifdef:ery in the source files either, as far as I can tell. \n\nBut the other libraries should probably be moved somewhere else.",
      "parentUuid": "969da87e_b8da25a8",
      "range": {
        "startLine": 937,
        "startChar": 0,
        "endLine": 943,
        "endChar": 5
      },
      "revId": "78a71386005ceac9bca63329a1c247f91a53e12c",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "251a4790_26f681f2",
        "filename": "rtc_base/BUILD.gn",
        "patchSetId": 3
      },
      "lineNbr": 943,
      "author": {
        "id": 5520
      },
      "writtenOn": "2019-08-09T06:54:01Z",
      "side": 0,
      "message": "AppKit is also a part of Cocoa.framework, but we should be adding AppKit explicitly to where it\u0027s needed (looks like it\u0027s at least missing from the metal_objc target). Note that it\u0027s mac-only and should be added inside an is_mac block.",
      "parentUuid": "969da87e_b8da25a8",
      "range": {
        "startLine": 937,
        "startChar": 0,
        "endLine": 943,
        "endChar": 5
      },
      "revId": "78a71386005ceac9bca63329a1c247f91a53e12c",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b3137fcc_9f1da3e4",
        "filename": "rtc_base/BUILD.gn",
        "patchSetId": 3
      },
      "lineNbr": 943,
      "author": {
        "id": 5087
      },
      "writtenOn": "2019-08-09T07:01:12Z",
      "side": 0,
      "message": "IIUC #ifdef:ery is not required here because mac targets only exist when it is a mac build and in that case the rtc_base target has the header. I know this is confusing and maybe a bit too magic/implicit.\n\nWRT cleaning these libs from here... I agree but I don\u0027t know the hierarchy of frameworks (e.g. the fact that AppKit is part of Cocoa.framework) so I always procrastinated this but we should definitely do something about it.",
      "parentUuid": "251a4790_26f681f2",
      "range": {
        "startLine": 937,
        "startChar": 0,
        "endLine": 943,
        "endChar": 5
      },
      "revId": "78a71386005ceac9bca63329a1c247f91a53e12c",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4fed29d6_4840f6a2",
        "filename": "rtc_base/BUILD.gn",
        "patchSetId": 3
      },
      "lineNbr": 943,
      "author": {
        "id": 5234
      },
      "writtenOn": "2019-08-09T07:06:45Z",
      "side": 0,
      "message": "KÃ¡ri: Like https://webrtc-review.googlesource.com/c/src/+/148584 ?\n\nMirko: I understand the rtc_base target, it\u0027s modules/desktop_capture:desktop_capture_generic that I find a bit strange.",
      "parentUuid": "b3137fcc_9f1da3e4",
      "range": {
        "startLine": 937,
        "startChar": 0,
        "endLine": 943,
        "endChar": 5
      },
      "revId": "78a71386005ceac9bca63329a1c247f91a53e12c",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    }
  ]
}