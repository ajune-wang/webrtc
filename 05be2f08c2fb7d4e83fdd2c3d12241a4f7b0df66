{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "e7ed2184_a1134b07",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 19549
      },
      "writtenOn": "2023-10-17T10:25:34Z",
      "side": 1,
      "message": "Can you help me figure out why clone-ing drops the codec_type?\nPS2..3 has the test which fails, bot run with more logging happened for PS3.\n\nI tried copying frame_type_ in TransformableVideoSenderFrame::Metadata() but that just lead to TypedThrowBadVariantAccess\u003cconst webrtc::RTPVideoHeaderVP8 \u0026\u003e when running the test :-/",
      "revId": "05be2f08c2fb7d4e83fdd2c3d12241a4f7b0df66",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b485a21f_e56ad44b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 17470
      },
      "writtenOn": "2023-10-17T10:55:59Z",
      "side": 1,
      "message": "Ah, one of these issues where we\u0027re accidentally storing redundant values in these encoded frame classes which leads to inconsistency... Sorry about that!\n\nThe Clone method uses the codec type returned in Metadata() to both set codec_type_ and construct the new RTPVideoHeader, but the issue is that Metadata() doesn\u0027t return the TransformableVideoSenderFrame::codec_type_ property, it uses header_.GetAsMetadata(). The test gives it a default constructed RTPVideoHeader() (line 80), hence Metadata().GetCodec() will return Generic.\n\nQuickest fix is probably to set RTPVideoHeader.codec to VP8 in the test setup. Better fix will be to refactor to not have it confusingly stored in two places.",
      "parentUuid": "e7ed2184_a1134b07",
      "revId": "05be2f08c2fb7d4e83fdd2c3d12241a4f7b0df66",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "748ca1ce_6fe63be8",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 19549
      },
      "writtenOn": "2023-10-17T13:28:37Z",
      "side": 1,
      "message": "That did the trick (but requires codec specifics), thank you!",
      "parentUuid": "b485a21f_e56ad44b",
      "revId": "05be2f08c2fb7d4e83fdd2c3d12241a4f7b0df66",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    }
  ]
}