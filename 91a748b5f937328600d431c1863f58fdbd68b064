{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "21527f38_f2a3f25c",
        "filename": "/COMMIT_MSG",
        "patchSetId": 7
      },
      "lineNbr": 24,
      "author": {
        "id": 9515
      },
      "writtenOn": "2023-11-23T13:48:47Z",
      "side": 1,
      "message": "Please add a unit test in this CL.",
      "range": {
        "startLine": 24,
        "startChar": 0,
        "endLine": 24,
        "endChar": 3
      },
      "revId": "91a748b5f937328600d431c1863f58fdbd68b064",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a190df53_89fe4cc6",
        "filename": "/COMMIT_MSG",
        "patchSetId": 7
      },
      "lineNbr": 24,
      "author": {
        "id": 5091
      },
      "writtenOn": "2023-11-23T14:01:26Z",
      "side": 1,
      "message": "Will do my best to come up with something.",
      "parentUuid": "21527f38_f2a3f25c",
      "range": {
        "startLine": 24,
        "startChar": 0,
        "endLine": 24,
        "endChar": 3
      },
      "revId": "91a748b5f937328600d431c1863f58fdbd68b064",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "533d6dfb_ebd01870",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 5091
      },
      "writtenOn": "2023-11-23T14:01:26Z",
      "side": 1,
      "message": "Only added comments at this stage. Pending feedback from hbos@ and ilnik@ as well.",
      "revId": "91a748b5f937328600d431c1863f58fdbd68b064",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8cab40bb_b32b01fd",
        "filename": "video/frame_cadence_adapter.cc",
        "patchSetId": 7
      },
      "lineNbr": 431,
      "author": {
        "id": 5117
      },
      "writtenOn": "2023-11-23T15:07:02Z",
      "side": 1,
      "message": "Just to be safe, please check that max_frame_rate is larger than zero.",
      "range": {
        "startLine": 431,
        "startChar": 54,
        "endLine": 431,
        "endChar": 69
      },
      "revId": "91a748b5f937328600d431c1863f58fdbd68b064",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e56bb3cc_fdee2cec",
        "filename": "video/frame_cadence_adapter.cc",
        "patchSetId": 7
      },
      "lineNbr": 431,
      "author": {
        "id": 5091
      },
      "writtenOn": "2023-11-23T15:21:03Z",
      "side": 1,
      "message": "Will fix.",
      "parentUuid": "8cab40bb_b32b01fd",
      "range": {
        "startLine": 431,
        "startChar": 54,
        "endLine": 431,
        "endChar": 69
      },
      "revId": "91a748b5f937328600d431c1863f58fdbd68b064",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4023921b_8dbdab50",
        "filename": "video/frame_cadence_adapter.cc",
        "patchSetId": 7
      },
      "lineNbr": 431,
      "author": {
        "id": 5142
      },
      "writtenOn": "2023-11-24T09:22:22Z",
      "side": 1,
      "message": "tip: `.value_or(0) \u003e 0`",
      "parentUuid": "e56bb3cc_fdee2cec",
      "range": {
        "startLine": 431,
        "startChar": 54,
        "endLine": 431,
        "endChar": 69
      },
      "revId": "91a748b5f937328600d431c1863f58fdbd68b064",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "305e532a_d3090b69",
        "filename": "video/frame_cadence_adapter.cc",
        "patchSetId": 7
      },
      "lineNbr": 432,
      "author": {
        "id": 7641
      },
      "writtenOn": "2023-11-23T15:49:24Z",
      "side": 1,
      "message": "Pass-by comment: Should this be RTC_DCHECK_GE?",
      "range": {
        "startLine": 432,
        "startChar": 4,
        "endLine": 432,
        "endChar": 58
      },
      "revId": "91a748b5f937328600d431c1863f58fdbd68b064",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "612ff430_1f1d3bd1",
        "filename": "video/frame_cadence_adapter.cc",
        "patchSetId": 7
      },
      "lineNbr": 432,
      "author": {
        "id": 5142
      },
      "writtenOn": "2023-11-24T09:22:22Z",
      "side": 1,
      "message": "`frame_delay_` is a fixed value based on an API call, while the max frame rate is a combination of an estimated \"current fps\" and an adaptation algorithm reducing this value, but in theory max_frame_rate could be the same as \"current fps\". Because \"current fps\" is an estimate, it could be slightly higher than our max fps, simply due to timing of things. (E.g. a few frames come in back-to-back and our estimate momentarily thinks our fps is 31 or more)\n\nSo while triggering this DCHECK is highly unlikely, it seems brittle to crash here, and we don\u0027t need to make assumptions about what values adaptation algorithm spits out.\n\nSo instead of crashing, if `restricted_frame_delay_` is higher than `frame_delay_`, simply consider this unrestricted (set to `absl::nullopt`).",
      "parentUuid": "305e532a_d3090b69",
      "range": {
        "startLine": 432,
        "startChar": 4,
        "endLine": 432,
        "endChar": 58
      },
      "revId": "91a748b5f937328600d431c1863f58fdbd68b064",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fa9543ca_05bea9b9",
        "filename": "video/frame_cadence_adapter.cc",
        "patchSetId": 7
      },
      "lineNbr": 434,
      "author": {
        "id": 9515
      },
      "writtenOn": "2023-11-23T13:48:47Z",
      "side": 1,
      "message": "Is this what happens when things get framerate adapted, and then the shift back to be unadapted?",
      "range": {
        "startLine": 434,
        "startChar": 30,
        "endLine": 434,
        "endChar": 43
      },
      "revId": "91a748b5f937328600d431c1863f58fdbd68b064",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "cb1d289b_4b71daad",
        "filename": "video/frame_cadence_adapter.cc",
        "patchSetId": 7
      },
      "lineNbr": 434,
      "author": {
        "id": 5091
      },
      "writtenOn": "2023-11-23T14:01:26Z",
      "side": 1,
      "message": "So far, I\u0027ve only seen this being triggered when the call is closed.",
      "parentUuid": "fa9543ca_05bea9b9",
      "range": {
        "startLine": 434,
        "startChar": 30,
        "endLine": 434,
        "endChar": 43
      },
      "revId": "91a748b5f937328600d431c1863f58fdbd68b064",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4bd115d6_aad03fe1",
        "filename": "video/frame_cadence_adapter.cc",
        "patchSetId": 7
      },
      "lineNbr": 434,
      "author": {
        "id": 5142
      },
      "writtenOn": "2023-11-24T09:22:22Z",
      "side": 1,
      "message": "Correct Markus, when we go from being adapted to not being adapted, the new restriction will set `max_frame_rate` to `absl::nullopt`. If you don\u0027t see that happening Henrik A, it sounds like the CPU encode threshold is never low enough to trigger \"Adapt Up\".\n\nDoes not adapting up make sense in your setup?",
      "parentUuid": "cb1d289b_4b71daad",
      "range": {
        "startLine": 434,
        "startChar": 30,
        "endLine": 434,
        "endChar": 43
      },
      "revId": "91a748b5f937328600d431c1863f58fdbd68b064",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e4ba2c34_9005c07b",
        "filename": "video/frame_cadence_adapter.cc",
        "patchSetId": 7
      },
      "lineNbr": 436,
      "author": {
        "id": 9515
      },
      "writtenOn": "2023-11-23T13:48:47Z",
      "side": 1,
      "message": "Can we remove this log? I don\u0027t see a big benefit once initial debugging is complete.",
      "range": {
        "startLine": 436,
        "startChar": 2,
        "endLine": 436,
        "endChar": 9
      },
      "revId": "91a748b5f937328600d431c1863f58fdbd68b064",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e4de624d_91c2d1af",
        "filename": "video/frame_cadence_adapter.cc",
        "patchSetId": 7
      },
      "lineNbr": 436,
      "author": {
        "id": 5091
      },
      "writtenOn": "2023-11-23T14:01:26Z",
      "side": 1,
      "message": "Of course. I kind of like it but I will remove it.",
      "parentUuid": "e4ba2c34_9005c07b",
      "range": {
        "startLine": 436,
        "startChar": 2,
        "endLine": 436,
        "endChar": 9
      },
      "revId": "91a748b5f937328600d431c1863f58fdbd68b064",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8a60b61f_0745a569",
        "filename": "video/frame_cadence_adapter.cc",
        "patchSetId": 7
      },
      "lineNbr": 436,
      "author": {
        "id": 5142
      },
      "writtenOn": "2023-11-24T09:22:22Z",
      "side": 1,
      "message": "I believe there are existing logging in other places every time the adaptation updates restrictions and that this would mostly repeat old information.",
      "parentUuid": "e4de624d_91c2d1af",
      "range": {
        "startLine": 436,
        "startChar": 2,
        "endLine": 436,
        "endChar": 9
      },
      "revId": "91a748b5f937328600d431c1863f58fdbd68b064",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "45f6be74_f06c3b9b",
        "filename": "video/frame_cadence_adapter.cc",
        "patchSetId": 7
      },
      "lineNbr": 466,
      "author": {
        "id": 5117
      },
      "writtenOn": "2023-11-23T15:07:02Z",
      "side": 1,
      "message": "Drive-by fix.\n\nHere we use `true` to check the repeat delay for existing task. But on L480 we use `false` as an actual parameter. Is it not a mistake? \n\nMarkus WDYT?",
      "range": {
        "startLine": 466,
        "startChar": 68,
        "endLine": 466,
        "endChar": 72
      },
      "revId": "91a748b5f937328600d431c1863f58fdbd68b064",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e90ead41_80f79e24",
        "filename": "video/frame_cadence_adapter.cc",
        "patchSetId": 7
      },
      "lineNbr": 609,
      "author": {
        "id": 5142
      },
      "writtenOn": "2023-11-24T09:22:22Z",
      "side": 1,
      "message": "The max fps is an integer, so we will necessarily never limit fps below 1 fps (same as `kZeroHertzIdleRepeatRatePeriod`).\n\nBut the recent comment from Hiroh seemed to illustrate an encode time of 3 seconds is possible on CrOS today (mind blown). This tells me that we definitely also need to drop frames in the encoder queue - regardless of restrictions.\n\nBut that\u0027s a different CL! (And I don\u0027t know why that is different under 0 Hz than non-0 Hz)",
      "revId": "91a748b5f937328600d431c1863f58fdbd68b064",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "68505573_24531b83",
        "filename": "video/frame_cadence_adapter.cc",
        "patchSetId": 7
      },
      "lineNbr": 685,
      "author": {
        "id": 9515
      },
      "writtenOn": "2023-11-23T13:48:47Z",
      "side": 1,
      "message": "If 0hz mode is toggled on-off-on, the restriction is forgotten currently. Should be fixed since toggling is used now.",
      "range": {
        "startLine": 685,
        "startChar": 6,
        "endLine": 685,
        "endChar": 25
      },
      "revId": "91a748b5f937328600d431c1863f58fdbd68b064",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e157bb86_5c1f6393",
        "filename": "video/frame_cadence_adapter.cc",
        "patchSetId": 7
      },
      "lineNbr": 685,
      "author": {
        "id": 5091
      },
      "writtenOn": "2023-11-23T14:01:26Z",
      "side": 1,
      "message": "Good comment. Will improve.",
      "parentUuid": "68505573_24531b83",
      "range": {
        "startLine": 685,
        "startChar": 6,
        "endLine": 685,
        "endChar": 25
      },
      "revId": "91a748b5f937328600d431c1863f58fdbd68b064",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    }
  ]
}