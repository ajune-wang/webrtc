{
  "comments": [
    {
      "key": {
        "uuid": "04359014_628a2448",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 9
      },
      "lineNbr": 0,
      "author": {
        "id": 5126
      },
      "writtenOn": "2020-10-01T23:03:25Z",
      "side": 1,
      "message": "Do we know why the binary size increases so much? (You can probably find out by commenting out individual AddReceiver and Send calls.)",
      "revId": "47b471944783bb428d9097f12831614a74ea437e",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "bd59ed0d_1397c2e3",
        "filename": "p2p/base/dtls_transport.h",
        "patchSetId": 9
      },
      "lineNbr": 218,
      "author": {
        "id": 5126
      },
      "writtenOn": "2020-10-01T23:03:25Z",
      "side": 1,
      "message": "Why? Isn\u0027t this an enum? Passing those by value is preferred.",
      "revId": "47b471944783bb428d9097f12831614a74ea437e",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "33ce64ca_968cef53",
        "filename": "p2p/base/dtls_transport.h",
        "patchSetId": 9
      },
      "lineNbr": 218,
      "author": {
        "id": 13719
      },
      "writtenOn": "2020-10-02T12:12:36Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "bd59ed0d_1397c2e3",
      "revId": "47b471944783bb428d9097f12831614a74ea437e",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8060542d_7a3f8cd6",
        "filename": "p2p/base/dtls_transport.h",
        "patchSetId": 9
      },
      "lineNbr": 218,
      "author": {
        "id": 5126
      },
      "writtenOn": "2020-10-02T20:03:07Z",
      "side": 1,
      "message": "Thanks. I suspect a lot of the extra binary size was because of this; not only does it take more instructions to store an integer in memory and pass around its address than to just pass the integer around directly, you also didn\u0027t consistently pass it by reference, so the compiler had to generate code for converting back and forth between the two representations. Demo here: https://godbolt.org/z/zef3Kz",
      "parentUuid": "33ce64ca_968cef53",
      "revId": "47b471944783bb428d9097f12831614a74ea437e",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e85dd3d1_2c7e5006",
        "filename": "p2p/base/dtls_transport.h",
        "patchSetId": 9
      },
      "lineNbr": 218,
      "author": {
        "id": 13719
      },
      "writtenOn": "2020-10-03T12:54:30Z",
      "side": 1,
      "message": "Thanks Karl.",
      "parentUuid": "8060542d_7a3f8cd6",
      "revId": "47b471944783bb428d9097f12831614a74ea437e",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "cc503617_2962eef0",
        "filename": "pc/jsep_transport_controller.cc",
        "patchSetId": 9
      },
      "lineNbr": 1158,
      "author": {
        "id": 5126
      },
      "writtenOn": "2020-10-01T23:03:25Z",
      "side": 1,
      "message": "Constructing the vector outside the lambda and then capturing it may be bad for binary size, because now we need code for copying/moving the vector. I think this syntax will work, and do the same thing as the old code:\n\n      RTC_FROM_HERE, signaling_thread_, [this, transport_name, candidate] {\n        SignalIceCandidatesGathered.Send(transport_name, std::vector\u003ccricket::Candidate\u003e{candidate});\n\nI haven\u0027t actually tried this, though, so the binary size effect might disappoint!\n\nAlternatively, if you do want to capture the vector in the lambda, replace\n\n  [this, transport_name, candidates]\n\nwith\n\n  [this, transport_name, candidates \u003d std::move(candidates)]\n\nso that you move the vector into the lambda instead of copying it. It looks like this should improve binary size: https://godbolt.org/z/TdTEvT (And it will certainly take less time to execute.)",
      "revId": "47b471944783bb428d9097f12831614a74ea437e",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6d880cb7_3c95b5b0",
        "filename": "pc/jsep_transport_controller.cc",
        "patchSetId": 9
      },
      "lineNbr": 1158,
      "author": {
        "id": 13719
      },
      "writtenOn": "2020-10-02T12:12:36Z",
      "side": 1,
      "message": "Done, Thanks Karl.",
      "parentUuid": "cc503617_2962eef0",
      "revId": "47b471944783bb428d9097f12831614a74ea437e",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "91ceb440_8d617489",
        "filename": "pc/peer_connection.cc",
        "patchSetId": 9
      },
      "lineNbr": 698,
      "author": {
        "id": 5126
      },
      "writtenOn": "2020-10-01T23:03:25Z",
      "side": 1,
      "message": "Did you verify that `this` lives longer than transport_controller_?",
      "revId": "47b471944783bb428d9097f12831614a74ea437e",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f16621f8_71f6242c",
        "filename": "pc/peer_connection.cc",
        "patchSetId": 9
      },
      "lineNbr": 698,
      "author": {
        "id": 13719
      },
      "writtenOn": "2020-10-02T12:12:36Z",
      "side": 1,
      "message": "I think so because I see transport_controller_.reset is invoked in destructor of this class. Would it be enough ?",
      "parentUuid": "91ceb440_8d617489",
      "revId": "47b471944783bb428d9097f12831614a74ea437e",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "64ac95be_0b47613a",
        "filename": "pc/peer_connection.cc",
        "patchSetId": 9
      },
      "lineNbr": 698,
      "author": {
        "id": 5126
      },
      "writtenOn": "2020-10-02T20:03:07Z",
      "side": 1,
      "message": "Yes. Thanks!",
      "parentUuid": "f16621f8_71f6242c",
      "revId": "47b471944783bb428d9097f12831614a74ea437e",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": false
    }
  ]
}