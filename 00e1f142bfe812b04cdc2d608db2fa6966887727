{
  "comments": [
    {
      "key": {
        "uuid": "e26e4619_d748f583",
        "filename": "sdk/android/api/org/webrtc/AudioProcessing.java",
        "patchSetId": 5
      },
      "lineNbr": 17,
      "author": {
        "id": 5112
      },
      "writtenOn": "2017-10-09T12:13:23Z",
      "side": 1,
      "message": "Doesn\u0027t seem to be a pointer to rtc::scoped_refptr but rather raw AudioProcessing pointer (I think this is good, just change the comment)",
      "range": {
        "startLine": 17,
        "startChar": 13,
        "endLine": 17,
        "endChar": 26
      },
      "revId": "00e1f142bfe812b04cdc2d608db2fa6966887727",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bfddd8eb_d9279c9d",
        "filename": "sdk/android/api/org/webrtc/AudioProcessing.java",
        "patchSetId": 5
      },
      "lineNbr": 17,
      "author": {
        "id": 5119
      },
      "writtenOn": "2017-10-09T14:58:35Z",
      "side": 1,
      "message": "Thanks, fixed.",
      "parentUuid": "e26e4619_d748f583",
      "range": {
        "startLine": 17,
        "startChar": 13,
        "endLine": 17,
        "endChar": 26
      },
      "revId": "00e1f142bfe812b04cdc2d608db2fa6966887727",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19f8963f_6adaabf4",
        "filename": "sdk/android/api/org/webrtc/PeerConnectionFactory.java",
        "patchSetId": 5
      },
      "lineNbr": 199,
      "author": {
        "id": 5119
      },
      "writtenOn": "2017-10-09T14:58:35Z",
      "side": 1,
      "message": "Do we have some convention re: allowing/documenting nullable values? I can\u0027t find anything in the Google/Chromium Java style guides.",
      "range": {
        "startLine": 199,
        "startChar": 7,
        "endLine": 199,
        "endChar": 67
      },
      "revId": "00e1f142bfe812b04cdc2d608db2fa6966887727",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f3c5f56e_3d0bec4d",
        "filename": "sdk/android/api/org/webrtc/PeerConnectionFactory.java",
        "patchSetId": 5
      },
      "lineNbr": 199,
      "author": {
        "id": 5119
      },
      "writtenOn": "2017-10-12T10:54:32Z",
      "side": 1,
      "message": "sakal@, thoughts?",
      "parentUuid": "19f8963f_6adaabf4",
      "range": {
        "startLine": 199,
        "startChar": 7,
        "endLine": 199,
        "endChar": 67
      },
      "revId": "00e1f142bfe812b04cdc2d608db2fa6966887727",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9b5e48ca_afe0d9ce",
        "filename": "sdk/android/api/org/webrtc/PostProcessing.java",
        "patchSetId": 5
      },
      "lineNbr": 14,
      "author": {
        "id": 5112
      },
      "writtenOn": "2017-10-09T12:13:23Z",
      "side": 1,
      "message": "Hmm, we have implemented rest of similar cases with a concrete class that holds the pointer instead of an interface. Maybe we should do it here as well for consistency?",
      "range": {
        "startLine": 14,
        "startChar": 17,
        "endLine": 14,
        "endChar": 31
      },
      "revId": "00e1f142bfe812b04cdc2d608db2fa6966887727",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "23fd2977_c9ee5c7c",
        "filename": "sdk/android/api/org/webrtc/PostProcessing.java",
        "patchSetId": 5
      },
      "lineNbr": 14,
      "author": {
        "id": 5119
      },
      "writtenOn": "2017-10-09T14:58:35Z",
      "side": 1,
      "message": "Good point. I\u0027m ok with that, although it itches to impose more restrictions on users.\n\nWould it be better to drop this class entirely and have AudioProcessing\u0027s constructor take the raw native pointer value? On the one hand, PostProcessing.java is not much more than a glorified wrapper of the pointer. On the other hand, this class allows users to hide all JNI stuff behind their PostProcessing implementation.",
      "parentUuid": "9b5e48ca_afe0d9ce",
      "range": {
        "startLine": 14,
        "startChar": 17,
        "endLine": 14,
        "endChar": 31
      },
      "revId": "00e1f142bfe812b04cdc2d608db2fa6966887727",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7705f0cb_1e9ee14c",
        "filename": "sdk/android/api/org/webrtc/PostProcessing.java",
        "patchSetId": 5
      },
      "lineNbr": 14,
      "author": {
        "id": 5119
      },
      "writtenOn": "2017-10-12T10:54:32Z",
      "side": 1,
      "message": "sakal@ said:\n\"\"\"\nI think we have three design options here now:\n1. Rename PostProcessing to PostProcessingFactory and getNativePointer to createNativePostProcessing. Whoever calls this method takes ownership of the object.\n2. Do as Taylor suggested and let the application own the PostProcessing either by modifying the interface or using a proxy class. I think in this case it might be worth considering reference counting so the object can\u0027t be freed from Java while the native code is still using it.\n3. Make PostProcessing a concrete class and make it clear that when it is passed to AudioProcessing, ownership is transferred.\n\nI would be okay with any of these approaches. I have slight preference for option 2 because it matches how handle other similar objects in Java.\n\"\"\"\n\n#1 sounds good, and fits well with the existing PeerConnectionFactory constructor.\nHow to add support for a default implementation? What about this:\n\npublic interface PostProcessingFactory {\n  // caller takes ownership\n  public long createNativePostProcessing();\n}\n\npublic interface AudioProcessingFactory {\n  // caller takes ownership\n  public long createNativeAudioProcessing();\n}\n\npublic class DefaultAudioProcessingFactory implements AudioProcessingFactory {\n  public DefaultAudioProcessingFactory(PostProcessingFactory postProcessingFactory) {\n    this.postProcessingFactory \u003d postProcessingFactory;\n  }\n  public long createNativeAudioProcessing(...) {\n    return nativeCreateAudioProcessing(\n      postProcessingFactory.createNativePostProcessing());\n  }\n  private PostProcessingFactory postProcessingFactory;\n\n  private static native long nativeCreateAudioProcessing(long postProcessing);\n}",
      "parentUuid": "23fd2977_c9ee5c7c",
      "range": {
        "startLine": 14,
        "startChar": 17,
        "endLine": 14,
        "endChar": 31
      },
      "revId": "00e1f142bfe812b04cdc2d608db2fa6966887727",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f3e4b412_ce09a514",
        "filename": "sdk/android/api/org/webrtc/PostProcessing.java",
        "patchSetId": 5
      },
      "lineNbr": 15,
      "author": {
        "id": 5112
      },
      "writtenOn": "2017-10-09T12:13:23Z",
      "side": 1,
      "message": "Pointer to a unique pointer? What is the point of a unique pointer if you have to manually delete it anyway?",
      "range": {
        "startLine": 15,
        "startChar": 19,
        "endLine": 15,
        "endChar": 63
      },
      "revId": "00e1f142bfe812b04cdc2d608db2fa6966887727",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f43d19d9_81637a09",
        "filename": "sdk/android/api/org/webrtc/PostProcessing.java",
        "patchSetId": 5
      },
      "lineNbr": 15,
      "author": {
        "id": 5119
      },
      "writtenOn": "2017-10-09T14:58:35Z",
      "side": 1,
      "message": "Updating the comment (to return a raw pointer), also adding a comment in AudioProcessing that it takes ownership of PostProcessing.",
      "parentUuid": "f3e4b412_ce09a514",
      "range": {
        "startLine": 15,
        "startChar": 19,
        "endLine": 15,
        "endChar": 63
      },
      "revId": "00e1f142bfe812b04cdc2d608db2fa6966887727",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8a97e823_0c05e91c",
        "filename": "sdk/android/instrumentationtests/src/org/webrtc/AudioProcessingTest.java",
        "patchSetId": 5
      },
      "lineNbr": 45,
      "author": {
        "id": 5112
      },
      "writtenOn": "2017-10-09T12:13:23Z",
      "side": 1,
      "message": "nit: literal comments",
      "range": {
        "startLine": 45,
        "startChar": 71,
        "endLine": 45,
        "endChar": 75
      },
      "revId": "00e1f142bfe812b04cdc2d608db2fa6966887727",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "171af24c_acc94e10",
        "filename": "sdk/android/instrumentationtests/src/org/webrtc/AudioProcessingTest.java",
        "patchSetId": 5
      },
      "lineNbr": 45,
      "author": {
        "id": 5119
      },
      "writtenOn": "2017-10-09T14:58:35Z",
      "side": 1,
      "message": "Thanks! Done.",
      "parentUuid": "8a97e823_0c05e91c",
      "range": {
        "startLine": 45,
        "startChar": 71,
        "endLine": 45,
        "endChar": 75
      },
      "revId": "00e1f142bfe812b04cdc2d608db2fa6966887727",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "18563f63_5e9be2ac",
        "filename": "sdk/android/src/jni/pc/audio_jni.cc",
        "patchSetId": 5
      },
      "lineNbr": 39,
      "author": {
        "id": 5112
      },
      "writtenOn": "2017-10-09T12:13:23Z",
      "side": 1,
      "message": "wait the comment before said this is already a unique pointer?",
      "range": {
        "startLine": 39,
        "startChar": 40,
        "endLine": 39,
        "endChar": 55
      },
      "revId": "00e1f142bfe812b04cdc2d608db2fa6966887727",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d0f9d198_1f0c9919",
        "filename": "sdk/android/src/jni/pc/audio_jni.cc",
        "patchSetId": 5
      },
      "lineNbr": 39,
      "author": {
        "id": 5119
      },
      "writtenOn": "2017-10-09T14:58:35Z",
      "side": 1,
      "message": "Yes, the interface comment is in error. Changed.",
      "parentUuid": "18563f63_5e9be2ac",
      "range": {
        "startLine": 39,
        "startChar": 40,
        "endLine": 39,
        "endChar": 55
      },
      "revId": "00e1f142bfe812b04cdc2d608db2fa6966887727",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0072e3ce_d97994e5",
        "filename": "sdk/android/src/jni/pc/audio_jni.cc",
        "patchSetId": 5
      },
      "lineNbr": 42,
      "author": {
        "id": 5112
      },
      "writtenOn": "2017-10-09T12:13:23Z",
      "side": 1,
      "message": "nit: literal comments",
      "range": {
        "startLine": 42,
        "startChar": 30,
        "endLine": 42,
        "endChar": 37
      },
      "revId": "00e1f142bfe812b04cdc2d608db2fa6966887727",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "316c702c_eddaeeeb",
        "filename": "sdk/android/src/jni/pc/audio_jni.cc",
        "patchSetId": 5
      },
      "lineNbr": 42,
      "author": {
        "id": 5119
      },
      "writtenOn": "2017-10-09T14:58:35Z",
      "side": 1,
      "message": "Thanks! Done.",
      "parentUuid": "0072e3ce_d97994e5",
      "range": {
        "startLine": 42,
        "startChar": 30,
        "endLine": 42,
        "endChar": 37
      },
      "revId": "00e1f142bfe812b04cdc2d608db2fa6966887727",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": false
    }
  ]
}