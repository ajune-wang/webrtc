{
  "comments": [
    {
      "key": {
        "uuid": "15fe7dc4_0f75f2f3",
        "filename": "test/fuzzers/BUILD.gn",
        "patchSetId": 1
      },
      "lineNbr": 33,
      "author": {
        "id": 5017
      },
      "writtenOn": "2017-10-05T11:06:26Z",
      "side": 1,
      "message": "It seems better to alter the default value of rtc_link_task_queue_impl [1] using use_libfuzzer and build_with_chromium variables instead. \n\n[1] https://cs.chromium.org/chromium/src/third_party/webrtc/webrtc.gni?rcl\u003d83ccca1864fc4da6f98761223946694a437532d6\u0026l\u003d108 to read",
      "range": {
        "startLine": 31,
        "startChar": 6,
        "endLine": 33,
        "endChar": 43
      },
      "revId": "9ad5bcbb8ce8ab92d502573c78c34793dd09237f",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "33aec715_bc7f2a61",
        "filename": "test/fuzzers/BUILD.gn",
        "patchSetId": 1
      },
      "lineNbr": 33,
      "author": {
        "id": 5234
      },
      "writtenOn": "2017-10-05T12:09:36Z",
      "side": 1,
      "message": "I\u0027d rather not add back a dependency on build_with_chromium into webrtc build files.\n\nIf there\u0027s a way to adjust chromium\u0027s .gn file to tweak the value of rtc_link_task_queue_impl, or adjust dependencies for fuzzers in some other way, that might work.\n\nThe way I understand these things, even in a fuzzer build of chromium, most of the produced executables, including the main chrome executable, should link with chromium\u0027s TaskQueue implementation. So then we can\u0027t set rtc_link_task_queue to true, it\u0027s too global.\n\nCurrent cl ensures that webrtc fuzzer executables use webrtc\u0027s TaskQueue implementation. That makes sense to me. They probably used to link chromium\u0027s implementation from webrtc_overrides. \n\nIf we really want to keep doing that, we\u0027ll need to handle this in some other way, injecting a dependency on chromium\u0027s target webrtc_overrides:task_queue_impl into webrtc\u0027s fuzzer targets.\nDon\u0027t know how to do that, but it seems messy. Such a change would need to go into the reland of https://chromium-review.googlesource.com/c/chromium/src/+/681814, which adds the target in question.",
      "parentUuid": "15fe7dc4_0f75f2f3",
      "range": {
        "startLine": 31,
        "startChar": 6,
        "endLine": 33,
        "endChar": 43
      },
      "revId": "9ad5bcbb8ce8ab92d502573c78c34793dd09237f",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a17b5702_50c5baa4",
        "filename": "test/fuzzers/BUILD.gn",
        "patchSetId": 1
      },
      "lineNbr": 33,
      "author": {
        "id": 5017
      },
      "writtenOn": "2017-10-05T12:34:21Z",
      "side": 1,
      "message": "\u003e I\u0027d rather not add back a dependency on build_with_chromium into webrtc build files.\n\nI\u0027m not entirely sure what you mean with this, we have plenty of such already: https://cs.chromium.org/search/?q\u003df:src/third_party/webrtc+build_with_chromium+f:%5C.gn\u0026type\u003dcs\n\n\u003e If there\u0027s a way to adjust chromium\u0027s .gn file to tweak the value of rtc_link_task_queue_impl, or adjust dependencies for fuzzers in some other way, that might work.\n\nI don\u0027t think you can even evaluate variables in the .gn file, but I\u0027m not sure. Maybe you\u0027ll need to seek advice from GN gurus like brettw@ in order to figure out this build problem.\n\n\u003e The way I understand these things, even in a fuzzer build of chromium, most of the produced executables, including the main chrome executable, should link with chromium\u0027s TaskQueue implementation. So then we can\u0027t set rtc_link_task_queue to true, it\u0027s too global.\n\nI\u0027m not familiar with the details of the fuzzers in Chromium. I assume they want to be similar to the Chromium environment when they can, but not pulling in too much in order to stay small.\n\n\u003e Current cl ensures that webrtc fuzzer executables use webrtc\u0027s TaskQueue implementation. That makes sense to me. They probably used to link chromium\u0027s implementation from webrtc_overrides. \n\u003e \n\u003e If we really want to keep doing that, we\u0027ll need to handle this in some other way, injecting a dependency on chromium\u0027s target webrtc_overrides:task_queue_impl into webrtc\u0027s fuzzer targets.\n\u003e Don\u0027t know how to do that, but it seems messy. Such a change would need to go into the reland of https://chromium-review.googlesource.com/c/chromium/src/+/681814, which adds the target in question.\n\nI don\u0027t know what\u0027s right or wrong here. I think we want to build the fuzzers at our libfuzzer bot identical to how they\u0027re built at the Chromium bots. That\u0027s the only purpose of the bot (it doesn\u0027t actually run the fuzzers, it\u0027s just trying to catch build errors before we roll).",
      "parentUuid": "33aec715_bc7f2a61",
      "range": {
        "startLine": 31,
        "startChar": 6,
        "endLine": 33,
        "endChar": 43
      },
      "revId": "9ad5bcbb8ce8ab92d502573c78c34793dd09237f",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    }
  ]
}