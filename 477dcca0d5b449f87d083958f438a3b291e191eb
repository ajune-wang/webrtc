{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "b3afca15_64b087be",
        "filename": "video/frame_cadence_adapter.cc",
        "patchSetId": 15
      },
      "lineNbr": 46,
      "author": {
        "id": 5142
      },
      "writtenOn": "2021-11-04T09:16:23Z",
      "side": 1,
      "message": "Do we really need multiple \"enabled\" variables? Also it is not clear what is enabled from the name.\n\nHow about is_zero_hertz_screenshare_enabled_?\n\nOr is the idea that we need both this flag to be true and for content type to be \"screenshare\" before the magic happens?\n\nIf so how about variables \"is_zero_hertz_screenshare_allwed_\" and \"content_type_\" instead of two flavours of \"enabled\"?",
      "revId": "477dcca0d5b449f87d083958f438a3b291e191eb",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "625816f3_99164fbc",
        "filename": "video/frame_cadence_adapter.cc",
        "patchSetId": 15
      },
      "lineNbr": 46,
      "author": {
        "id": 9515
      },
      "writtenOn": "2021-11-04T15:33:53Z",
      "side": 1,
      "message": "\u003e Or is the idea that we need both this flag to be true and for content type to be \"screenshare\" before the magic happens?\n\n+ constraints need to be of a certain kind.\n\n\u003e If so how about variables \"is_zero_hertz_screenshare_allwed_\" and \"content_type_\" instead of two flavours of \"enabled\"?\n\nThe exact content type isn\u0027t needed. Only that we\u0027ve chosen to activate based on a prerequisite which happens to be \"content_type\u003d\u003denabled\".\n\nI\u0027ve renamed the field trial flag to |zero_hertz_screenshare_enabled_| in PS16.",
      "parentUuid": "b3afca15_64b087be",
      "revId": "477dcca0d5b449f87d083958f438a3b291e191eb",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "553c4e54_f204b28c",
        "filename": "video/frame_cadence_adapter.cc",
        "patchSetId": 15
      },
      "lineNbr": 61,
      "author": {
        "id": 5142
      },
      "writtenOn": "2021-11-04T09:16:23Z",
      "side": 1,
      "message": "Should this be \"VideoContentType content_type_\"?",
      "revId": "477dcca0d5b449f87d083958f438a3b291e191eb",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b6abb973_99019729",
        "filename": "video/frame_cadence_adapter.cc",
        "patchSetId": 15
      },
      "lineNbr": 61,
      "author": {
        "id": 9515
      },
      "writtenOn": "2021-11-04T15:33:53Z",
      "side": 1,
      "message": "The frame cadence adapter has no use for the exact type of content. See also previous discussion with Niels and Ilya.",
      "parentUuid": "553c4e54_f204b28c",
      "revId": "477dcca0d5b449f87d083958f438a3b291e191eb",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4eec2757_d71e0d77",
        "filename": "video/frame_cadence_adapter.cc",
        "patchSetId": 15
      },
      "lineNbr": 80,
      "author": {
        "id": 5117
      },
      "writtenOn": "2021-11-03T15:36:25Z",
      "side": 1,
      "message": "I suggest to move all this logic to the VSE. It should own a const field trial flag and then combine it with whatever stream related logic as needed.\n\nThen this method could be just SetEnabled or current name works also.\n\nThat way we won\u0027t have plethora of confusing |enabled_by_whatever| flags.",
      "range": {
        "startLine": 80,
        "startChar": 6,
        "endLine": 80,
        "endChar": 36
      },
      "revId": "477dcca0d5b449f87d083958f438a3b291e191eb",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "30dc5458_aea7b55c",
        "filename": "video/frame_cadence_adapter.cc",
        "patchSetId": 15
      },
      "lineNbr": 80,
      "author": {
        "id": 5234
      },
      "writtenOn": "2021-11-03T18:40:04Z",
      "side": 1,
      "message": "Agree it makes sense to have all field trial logic in VSE.",
      "parentUuid": "4eec2757_d71e0d77",
      "range": {
        "startLine": 80,
        "startChar": 6,
        "endLine": 80,
        "endChar": 36
      },
      "revId": "477dcca0d5b449f87d083958f438a3b291e191eb",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "09fc0ee8_70c46a6e",
        "filename": "video/frame_cadence_adapter.cc",
        "patchSetId": 15
      },
      "lineNbr": 80,
      "author": {
        "id": 9515
      },
      "writtenOn": "2021-11-03T22:56:09Z",
      "side": 1,
      "message": "I don\u0027t follow the rationale. The onset of this feature\u0027s activation has several conditions happening from various contexts. Why would we want to complicate the VSE further with this, isn\u0027t VSE complicated and god-like as it is?\n\nI much more believe in Stefan\u0027s suggestion to splice in \"mode\" objects into the FrameCadenceAdapter which will cause them to individually contain their respective functionality, and leave the FrameCadenceAdapter to handle activation/deactivation/forwarding.",
      "parentUuid": "30dc5458_aea7b55c",
      "range": {
        "startLine": 80,
        "startChar": 6,
        "endLine": 80,
        "endChar": 36
      },
      "revId": "477dcca0d5b449f87d083958f438a3b291e191eb",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b7bc82f2_29b6a77d",
        "filename": "video/frame_cadence_adapter.cc",
        "patchSetId": 15
      },
      "lineNbr": 80,
      "author": {
        "id": 5234
      },
      "writtenOn": "2021-11-04T08:44:14Z",
      "side": 1,
      "message": "I was thinking that it helps to have all the field trials affecting the operation of the VSE in one place. Let VSE decide what to do, and just leave the details of doing it to the FrameCadenceAdapter class(es).\n\nBut I don\u0027t have a strong opinion on this. There are already half a dozen field trials in VSE, so it would be nice if setup of new field trials are organized in a consistent way.",
      "parentUuid": "09fc0ee8_70c46a6e",
      "range": {
        "startLine": 80,
        "startChar": 6,
        "endLine": 80,
        "endChar": 36
      },
      "revId": "477dcca0d5b449f87d083958f438a3b291e191eb",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "2ebb30c2_a295af69",
        "filename": "video/frame_cadence_adapter.cc",
        "patchSetId": 15
      },
      "lineNbr": 80,
      "author": {
        "id": 5117
      },
      "writtenOn": "2021-11-04T09:53:29Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "b7bc82f2_29b6a77d",
      "range": {
        "startLine": 80,
        "startChar": 6,
        "endLine": 80,
        "endChar": 36
      },
      "revId": "477dcca0d5b449f87d083958f438a3b291e191eb",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "04e36631_f434ea00",
        "filename": "video/frame_cadence_adapter.cc",
        "patchSetId": 15
      },
      "lineNbr": 90,
      "author": {
        "id": 5142
      },
      "writtenOn": "2021-11-04T09:16:23Z",
      "side": 1,
      "message": "Why are we maybe reporting constrains in \"OnFrame\"? Why not in \"OnConstraintsChanged\"?\n\nIf zero fps capture is the end goal, \"OnFrame\" wouldn\u0027t be called in some cases, right?",
      "revId": "477dcca0d5b449f87d083958f438a3b291e191eb",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6200a35a_7ecea46a",
        "filename": "video/frame_cadence_adapter.cc",
        "patchSetId": 15
      },
      "lineNbr": 90,
      "author": {
        "id": 9515
      },
      "writtenOn": "2021-11-04T15:33:53Z",
      "side": 1,
      "message": "\u003e Why are we maybe reporting constrains in \"OnFrame\"? Why not in \"OnConstraintsChanged\"?\n\nIt\u0027s not enough as I explained elsewhere (and also in the code), I need both constraints AND content type \u003d screenshare for the UMAs. As far as I can tell they could come in any order, and we get notified on the network resp. worker thread.\n\nNote that this code was moved over from VideoStreamEncoder...\n\n\u003e If zero fps capture is the end goal, \"OnFrame\" wouldn\u0027t be called in some cases, right?\n\nIn my testing the capturer does send an initial frame despite min fps 0. Should this turn out flaky I\u0027ll anyway need to add a \"VideoTrackSourceInterface::RequestRefreshFrame\" and plumb to chromium to solve keyframe requests fully.",
      "parentUuid": "04e36631_f434ea00",
      "revId": "477dcca0d5b449f87d083958f438a3b291e191eb",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "66c0f9a5_e6f3d259",
        "filename": "video/frame_cadence_adapter.cc",
        "patchSetId": 15
      },
      "lineNbr": 99,
      "author": {
        "id": 5142
      },
      "writtenOn": "2021-11-04T09:16:23Z",
      "side": 1,
      "message": "Same question as above, but couldn\u0027t we just do this?\n\n  if (source_constraints_ \u003d\u003d constraints)\n    return;\n  source_constraints_ \u003d constraints;\n  ReportFrameRateConstraintUmas();",
      "revId": "477dcca0d5b449f87d083958f438a3b291e191eb",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ab134301_ea671e0f",
        "filename": "video/frame_cadence_adapter.cc",
        "patchSetId": 15
      },
      "lineNbr": 99,
      "author": {
        "id": 9515
      },
      "writtenOn": "2021-11-04T15:33:53Z",
      "side": 1,
      "message": "I think I answered this previously, but the UMAs describe screenshare, so I need to have received both constraints and \"content_type\u003d\u003dscreenshare\" (happening on various contexts) before reporting.",
      "parentUuid": "66c0f9a5_e6f3d259",
      "revId": "477dcca0d5b449f87d083958f438a3b291e191eb",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "53b34d29_8bc45867",
        "filename": "video/frame_cadence_adapter.h",
        "patchSetId": 15
      },
      "lineNbr": 39,
      "author": {
        "id": 5142
      },
      "writtenOn": "2021-11-04T09:16:23Z",
      "side": 1,
      "message": "When we do have zero hertz screenshare, would \"OnDiscardedFrame()\" happen instead of \"OnFrame()\"? Or when would FrameCadenceAdapterInterface discard frames?",
      "revId": "477dcca0d5b449f87d083958f438a3b291e191eb",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a305cf2a_98bda21d",
        "filename": "video/frame_cadence_adapter.h",
        "patchSetId": 15
      },
      "lineNbr": 39,
      "author": {
        "id": 9515
      },
      "writtenOn": "2021-11-04T15:33:53Z",
      "side": 1,
      "message": "No it would not happen instead. OnFrame leads to OnFrame. In my PoC I didn\u0027t deal with OnDiscardedFrame, but theres no logic in this CL to base that discussion.\n\nThis method is kept here because there\u0027s VSE |encoder_stats_observer_| processing related to OnDiscardedFrame which seems to be invoked from the VideoBroadcaster, and I removed VSE\u0027s dependency on VideoSinkInterface (see discussion with Niels).",
      "parentUuid": "53b34d29_8bc45867",
      "revId": "477dcca0d5b449f87d083958f438a3b291e191eb",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "508391f5_d783e981",
        "filename": "video/video_stream_encoder.h",
        "patchSetId": 15
      },
      "lineNbr": 79,
      "author": {
        "id": 5142
      },
      "writtenOn": "2021-11-04T09:16:23Z",
      "side": 1,
      "message": "Can we rename zero_hertz_adapter to frame_cadence_adapter?",
      "revId": "477dcca0d5b449f87d083958f438a3b291e191eb",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "0e1d5ab9_9a34ba48",
        "filename": "video/video_stream_encoder.h",
        "patchSetId": 15
      },
      "lineNbr": 79,
      "author": {
        "id": 9515
      },
      "writtenOn": "2021-11-04T15:33:53Z",
      "side": 1,
      "message": "Yikes, thanks for noting this leftover. Yes.",
      "parentUuid": "508391f5_d783e981",
      "revId": "477dcca0d5b449f87d083958f438a3b291e191eb",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    }
  ]
}