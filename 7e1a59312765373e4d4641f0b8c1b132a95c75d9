{
  "comments": [
    {
      "key": {
        "uuid": "a4d4399c_bb649eb0",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 16
      },
      "lineNbr": 0,
      "author": {
        "id": 5122
      },
      "writtenOn": "2020-09-24T11:43:52Z",
      "side": 1,
      "message": "Hi Minyue,\nCould you also take a look at this CL?\nAlessio",
      "revId": "7e1a59312765373e4d4641f0b8c1b132a95c75d9",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ea21a901_c5c209f2",
        "filename": "modules/audio_processing/agc2/adaptive_mode_level_estimator.cc",
        "patchSetId": 16
      },
      "lineNbr": 75,
      "author": {
        "id": 5607
      },
      "writtenOn": "2020-09-24T12:26:47Z",
      "side": 1,
      "message": "Should this be \u003c\u003d? Or can it never become lower than zero?",
      "range": {
        "startLine": 75,
        "startChar": 60,
        "endLine": 75,
        "endChar": 62
      },
      "revId": "7e1a59312765373e4d4641f0b8c1b132a95c75d9",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "cbbea852_efdb4950",
        "filename": "modules/audio_processing/agc2/adaptive_mode_level_estimator.cc",
        "patchSetId": 16
      },
      "lineNbr": 75,
      "author": {
        "id": 5122
      },
      "writtenOn": "2020-09-24T15:29:08Z",
      "side": 1,
      "message": "it can never become negative, let me add a DCHECK",
      "parentUuid": "ea21a901_c5c209f2",
      "range": {
        "startLine": 75,
        "startChar": 60,
        "endLine": 75,
        "endChar": 62
      },
      "revId": "7e1a59312765373e4d4641f0b8c1b132a95c75d9",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "56b00491_2d050e1a",
        "filename": "modules/audio_processing/agc2/adaptive_mode_level_estimator.cc",
        "patchSetId": 16
      },
      "lineNbr": 100,
      "author": {
        "id": 5607
      },
      "writtenOn": "2020-09-24T12:26:47Z",
      "side": 1,
      "message": "This is not really related to the CL, but I don\u0027t really understand this filter. To me this looks looks like an overly complicated way to implement an exponential filter. Am I missing something? What value do the numerator and denominator add?",
      "range": {
        "startLine": 96,
        "startChar": 0,
        "endLine": 100,
        "endChar": 0
      },
      "revId": "7e1a59312765373e4d4641f0b8c1b132a95c75d9",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2d459ff2_15537ed3",
        "filename": "modules/audio_processing/agc2/adaptive_mode_level_estimator.cc",
        "patchSetId": 16
      },
      "lineNbr": 100,
      "author": {
        "id": 5122
      },
      "writtenOn": "2020-09-24T15:29:08Z",
      "side": 1,
      "message": "Thanks for checking this part.\n\nThis was added by aleloi@ in https://webrtc-review.googlesource.com/c/src/+/64820/ and actually reviewed by you at that time (not a reason to avoid your question).\n\nI spent time on this section a few days ago, in particular to make sure that no overflow can take place. The goal is to compute a weighted average of the audio levels that are classified as speech where the weight is the speech probability. That\u0027s why the numerator adds `probability * level` and the denominator adds `probability`.\n\nThe leak factor is designed to simulate the memory/forgetting behavior of a ring buffer using an exponential process.\n\nFeel free to reopen this comment if there\u0027s anything that can be improved (e.g., adding a comment that explains the process) or that needs more attention.",
      "parentUuid": "56b00491_2d050e1a",
      "range": {
        "startLine": 96,
        "startChar": 0,
        "endLine": 100,
        "endChar": 0
      },
      "revId": "7e1a59312765373e4d4641f0b8c1b132a95c75d9",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4d488721_d4be44a5",
        "filename": "modules/audio_processing/agc2/adaptive_mode_level_estimator.cc",
        "patchSetId": 16
      },
      "lineNbr": 100,
      "author": {
        "id": 5607
      },
      "writtenOn": "2020-09-24T15:45:56Z",
      "side": 1,
      "message": "Funny that I was the original reviewer, I don\u0027t remember it at all. I\u0027ll trust that it\u0027s doing the right thing.",
      "parentUuid": "2d459ff2_15537ed3",
      "range": {
        "startLine": 96,
        "startChar": 0,
        "endLine": 100,
        "endChar": 0
      },
      "revId": "7e1a59312765373e4d4641f0b8c1b132a95c75d9",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9babf7a2_fcbf0f23",
        "filename": "modules/audio_processing/agc2/adaptive_mode_level_estimator.cc",
        "patchSetId": 16
      },
      "lineNbr": 117,
      "author": {
        "id": 5607
      },
      "writtenOn": "2020-09-24T12:26:47Z",
      "side": 1,
      "message": "last_level_dbfs.value_or(kInitialSpeechLevelEstimateDbfs)",
      "range": {
        "startLine": 115,
        "startChar": 21,
        "endLine": 117,
        "endChar": 59
      },
      "revId": "7e1a59312765373e4d4641f0b8c1b132a95c75d9",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "87cec4d5_40cfd853",
        "filename": "modules/audio_processing/agc2/adaptive_mode_level_estimator.cc",
        "patchSetId": 16
      },
      "lineNbr": 117,
      "author": {
        "id": 5122
      },
      "writtenOn": "2020-09-24T15:29:08Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "9babf7a2_fcbf0f23",
      "range": {
        "startLine": 115,
        "startChar": 21,
        "endLine": 117,
        "endChar": 59
      },
      "revId": "7e1a59312765373e4d4641f0b8c1b132a95c75d9",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c94ddafc_886c7626",
        "filename": "modules/audio_processing/agc2/adaptive_mode_level_estimator.h",
        "patchSetId": 16
      },
      "lineNbr": 51,
      "author": {
        "id": 7015
      },
      "writtenOn": "2020-09-24T19:53:05Z",
      "side": 1,
      "message": "more explicit name may be preferred.",
      "range": {
        "startLine": 51,
        "startChar": 0,
        "endLine": 51,
        "endChar": 27
      },
      "revId": "7e1a59312765373e4d4641f0b8c1b132a95c75d9",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7c90a211_9a26fa85",
        "filename": "modules/audio_processing/agc2/adaptive_mode_level_estimator.h",
        "patchSetId": 16
      },
      "lineNbr": 51,
      "author": {
        "id": 5122
      },
      "writtenOn": "2020-09-25T07:12:02Z",
      "side": 1,
      "message": "Can you make a suggestion?\n\nI switched to a shorter name in a recent CL because the caller typically looks like `level_estimator.IsConfident()` which to me reads well. The docstring clarifies what criteria is used. I wouldn\u0027t name after the criteria (e.g., EnoughSpeechObserved() or SpeechBufferIsFull()) as that would reveal an implementation detail.",
      "parentUuid": "c94ddafc_886c7626",
      "range": {
        "startLine": 51,
        "startChar": 0,
        "endLine": 51,
        "endChar": 27
      },
      "revId": "7e1a59312765373e4d4641f0b8c1b132a95c75d9",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "69a86f88_95a91e29",
        "filename": "modules/audio_processing/agc2/adaptive_mode_level_estimator.h",
        "patchSetId": 16
      },
      "lineNbr": 51,
      "author": {
        "id": 7015
      },
      "writtenOn": "2020-09-25T07:19:21Z",
      "side": 1,
      "message": "sure. we can keep the current name, yes, it reads well. but does it make sense to shuffle the comments a bit\n\n\"Returns true if the estimator is confident on its current estimate\" and move the implementation detail \"if enough speech frame have been observed\" to the cc file.",
      "parentUuid": "7c90a211_9a26fa85",
      "range": {
        "startLine": 51,
        "startChar": 0,
        "endLine": 51,
        "endChar": 27
      },
      "revId": "7e1a59312765373e4d4641f0b8c1b132a95c75d9",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "fc9c2bbb_13b59925",
        "filename": "modules/audio_processing/agc2/adaptive_mode_level_estimator.h",
        "patchSetId": 16
      },
      "lineNbr": 51,
      "author": {
        "id": 5122
      },
      "writtenOn": "2020-09-25T07:25:26Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "69a86f88_95a91e29",
      "range": {
        "startLine": 51,
        "startChar": 0,
        "endLine": 51,
        "endChar": 27
      },
      "revId": "7e1a59312765373e4d4641f0b8c1b132a95c75d9",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "21753ca4_6646b3ca",
        "filename": "modules/audio_processing/agc2/adaptive_mode_level_estimator.h",
        "patchSetId": 16
      },
      "lineNbr": 59,
      "author": {
        "id": 5607
      },
      "writtenOn": "2020-09-24T12:26:47Z",
      "side": 1,
      "message": "Should the members of State and Ratio be initialized to zero? That was the behavior before this CL.",
      "range": {
        "startLine": 59,
        "startChar": 12,
        "endLine": 59,
        "endChar": 21
      },
      "revId": "7e1a59312765373e4d4641f0b8c1b132a95c75d9",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4a1491fd_51af2d85",
        "filename": "modules/audio_processing/agc2/adaptive_mode_level_estimator.h",
        "patchSetId": 16
      },
      "lineNbr": 59,
      "author": {
        "id": 5122
      },
      "writtenOn": "2020-09-25T07:12:02Z",
      "side": 1,
      "message": "This is still the case, all AdaptiveModeLevelEstimator ctors call AdaptiveModeLevelEstimator::Reset which zeroes num and den.",
      "parentUuid": "21753ca4_6646b3ca",
      "range": {
        "startLine": 59,
        "startChar": 12,
        "endLine": 59,
        "endChar": 21
      },
      "revId": "7e1a59312765373e4d4641f0b8c1b132a95c75d9",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": false
    }
  ]
}