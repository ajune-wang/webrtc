{
  "comments": [
    {
      "key": {
        "uuid": "81e98a24_d68df91a",
        "filename": "modules/desktop_capture/BUILD.gn",
        "patchSetId": 6
      },
      "lineNbr": 175,
      "author": {
        "id": 5087
      },
      "writtenOn": "2018-11-19T18:07:49Z",
      "side": 1,
      "message": "This is strange, both WEBRTC_USE_PIPEWIRE and DLOPEN_PIPEWIRE are not part of a build target (before WEBRTC_USE_PIPEWIRE was part of modules/desktop_capture:pipewire) but are just variables, I think this doesn\u0027t work. Do you see any error?",
      "range": {
        "startLine": 175,
        "startChar": 4,
        "endLine": 175,
        "endChar": 39
      },
      "revId": "1d30a59946992a3f69fa2fb334fb59f8322e6d32",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "37ac1550_98d8359c",
        "filename": "modules/desktop_capture/BUILD.gn",
        "patchSetId": 6
      },
      "lineNbr": 175,
      "author": {
        "id": 5027
      },
      "writtenOn": "2018-11-20T07:49:52Z",
      "side": 1,
      "message": "Yeah, this looks wrong, the defines is effectively out in the gn top level and not under any target. I missed that earlier in the review, sorry.",
      "parentUuid": "81e98a24_d68df91a",
      "range": {
        "startLine": 175,
        "startChar": 4,
        "endLine": 175,
        "endChar": 39
      },
      "revId": "1d30a59946992a3f69fa2fb334fb59f8322e6d32",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "cd508bb5_322507c7",
        "filename": "modules/desktop_capture/BUILD.gn",
        "patchSetId": 6
      },
      "lineNbr": 175,
      "author": {
        "id": 7996
      },
      "writtenOn": "2018-11-20T08:23:23Z",
      "side": 1,
      "message": "I does work - compare these two files:\n\ngn gen out/Default --args\u003d\"rtc_link_pipewire\u003dfalse\" \u0026\u0026 gn desc out/Default //modules/desktop_capture:desktop_capture_generic\nthat is https://fedorapeople.org/~tpopela/gn_desc.log\n\nand\n\ngn gen out/Default --args\u003d\"rtc_link_pipewire\u003dtrue\" \u0026\u0026 gn desc out/Default //modules/desktop_capture:desktop_capture_generic\nthat is https://fedorapeople.org/~tpopela/gn_desc_link.log\n\nyou will see that the DLOPEN_PIPEWIRE is being defined for that target.",
      "parentUuid": "37ac1550_98d8359c",
      "range": {
        "startLine": 175,
        "startChar": 4,
        "endLine": 175,
        "endChar": 39
      },
      "revId": "1d30a59946992a3f69fa2fb334fb59f8322e6d32",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bd0b60a6_8d6f876c",
        "filename": "modules/desktop_capture/BUILD.gn",
        "patchSetId": 6
      },
      "lineNbr": 175,
      "author": {
        "id": 5087
      },
      "writtenOn": "2018-11-20T10:56:29Z",
      "side": 1,
      "message": "Oh, I know what is happening here! The variable \"defines\" becomes part of :gio because of the GN scoping rules.\n\n$ gn gen out/Default --args\u003d\"rtc_use_pipewire\u003dtrue\" \u0026\u0026 gn desc out/Default //modules/desktop_capture:gio\n[...]\ndefines\n  WEBRTC_USE_PIPEWIRE\n  DLOPEN_PIPEWIRE\n\nlibs\n  gio-2.0\n  gobject-2.0\n  glib-2.0\n\nSo this is working because :gio is a pkg_config on which :desktop_capture_generic depends on, but I suggest you explicitly move the \"defines\" inside the pkg_config because the current situation is error prone. This is why it wasn\u0027t working when you moved the \"defines\" after the :pipewire_generate_stubs action (this should reply to https://webrtc-review.googlesource.com/c/src/+/111081/6#message-b4199ec51bff2d688cb2cfcf7f40ddebcedba5eb).",
      "parentUuid": "cd508bb5_322507c7",
      "range": {
        "startLine": 175,
        "startChar": 4,
        "endLine": 175,
        "endChar": 39
      },
      "revId": "1d30a59946992a3f69fa2fb334fb59f8322e6d32",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bfdcbc0f_b0416100",
        "filename": "modules/desktop_capture/BUILD.gn",
        "patchSetId": 6
      },
      "lineNbr": 175,
      "author": {
        "id": 7996
      },
      "writtenOn": "2018-11-20T11:26:05Z",
      "side": 1,
      "message": "Oh that\u0027s it! Thank you Mirko! I can\u0027t move the defines there as the pkg-config() is not used when using dlopen() and thus these won\u0027t be defined for that case. I will do a separate config for that.",
      "parentUuid": "bd0b60a6_8d6f876c",
      "range": {
        "startLine": 175,
        "startChar": 4,
        "endLine": 175,
        "endChar": 39
      },
      "revId": "1d30a59946992a3f69fa2fb334fb59f8322e6d32",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2a542fc4_ad2891f0",
        "filename": "modules/desktop_capture/BUILD.gn",
        "patchSetId": 6
      },
      "lineNbr": 177,
      "author": {
        "id": 5087
      },
      "writtenOn": "2018-11-19T18:07:49Z",
      "side": 1,
      "message": "Is this a WebRTC macro? In that case I suggest WEBRTC_DLOPEN_PIPEWIRE.",
      "range": {
        "startLine": 177,
        "startChar": 20,
        "endLine": 177,
        "endChar": 35
      },
      "revId": "1d30a59946992a3f69fa2fb334fb59f8322e6d32",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1af4bc2e_ca23767d",
        "filename": "modules/desktop_capture/BUILD.gn",
        "patchSetId": 6
      },
      "lineNbr": 177,
      "author": {
        "id": 7996
      },
      "writtenOn": "2018-11-20T08:23:23Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "2a542fc4_ad2891f0",
      "range": {
        "startLine": 177,
        "startChar": 20,
        "endLine": 177,
        "endChar": 35
      },
      "revId": "1d30a59946992a3f69fa2fb334fb59f8322e6d32",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": false
    }
  ]
}