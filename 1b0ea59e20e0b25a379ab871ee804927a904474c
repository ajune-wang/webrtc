{
  "comments": [
    {
      "key": {
        "uuid": "96562d2e_c9104a81",
        "filename": "modules/audio_coding/codecs/opus/opus_interface.cc",
        "patchSetId": 2
      },
      "lineNbr": 751,
      "author": {
        "id": 6876
      },
      "writtenOn": "2020-06-08T08:51:21Z",
      "side": 1,
      "message": "If the opus payload has more than one frame you are just using getting the information about the first frame. \n\nI would leave the WebRtcOpus_PacketHasFec method as it was and I would create a new one for extracting the VAD flags. \n\nIn my opinion, the opus_packet_parse is sufficiently cheap and we can afford calling it twice.",
      "range": {
        "startLine": 751,
        "startChar": 27,
        "endLine": 751,
        "endChar": 31
      },
      "revId": "1b0ea59e20e0b25a379ab871ee804927a904474c",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5af534eb_72dcb1b7",
        "filename": "modules/audio_coding/codecs/opus/opus_interface.cc",
        "patchSetId": 2
      },
      "lineNbr": 751,
      "author": {
        "id": 7755
      },
      "writtenOn": "2020-06-08T08:57:13Z",
      "side": 1,
      "message": "that is what I thought too for a while but then i looked at the examples in\nhttps://tools.ietf.org/html/rfc6716#section-4.2.2\nwhich have multiple frames but still have the flags on the first byte of the first frame (which for variable length coding may not be immediately after the TOC byte which is why it still makes sense to use opus_packet_parse)",
      "parentUuid": "96562d2e_c9104a81",
      "range": {
        "startLine": 751,
        "startChar": 27,
        "endLine": 751,
        "endChar": 31
      },
      "revId": "1b0ea59e20e0b25a379ab871ee804927a904474c",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "210251db_bfd3a39f",
        "filename": "modules/audio_coding/codecs/opus/opus_interface.cc",
        "patchSetId": 2
      },
      "lineNbr": 751,
      "author": {
        "id": 6876
      },
      "writtenOn": "2020-06-08T10:01:45Z",
      "side": 1,
      "message": "That sections talks about the Silk subframes and the VAD flags for those Silk subframes. All of those flags are all stored in the first byte of the Silk payload. On top of that you might have sereral frames in the Opus payload.\n\nAs an example, you can have a 120 ms Opus payload that is composed of 2 Silk payloads. Each Silk payload would corresponds to a 60 ms Silk frame. Internally, those 60 ms Silk frames are composed of 3 Silk subframes each one of 20 ms. That first byte of each Silk frame would have 3 bits that tells you the VAD flag of each of those subframes. So, for that example you will have 2 frames in that Opus payload, opus_packet_parse will return a number 2 and frames[0] would point out to the first Silk frame (composed of 3 Silk subframes), frames[1] would point out to the second Silk frame (composed of 3 Silk subframes). I hope this example clarifies a bit all this confusion about the number of Opus frames and number of Silk subframes.",
      "parentUuid": "5af534eb_72dcb1b7",
      "range": {
        "startLine": 751,
        "startChar": 27,
        "endLine": 751,
        "endChar": 31
      },
      "revId": "1b0ea59e20e0b25a379ab871ee804927a904474c",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    }
  ]
}