{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "e9d9c4a4_29811500",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 13
      },
      "lineNbr": 0,
      "author": {
        "id": 5142
      },
      "writtenOn": "2021-06-03T08:55:16Z",
      "side": 1,
      "message": "Harald - see reply to one of your questions.\n\nTaylor - please take a look",
      "revId": "60790cb883c865a9b2e0da9c331167dc1f96e785",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "0105ca4b_8c3abd58",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 13
      },
      "lineNbr": 0,
      "author": {
        "id": 5142
      },
      "writtenOn": "2021-06-04T12:21:02Z",
      "side": 1,
      "message": "Please advice - see comment",
      "revId": "60790cb883c865a9b2e0da9c331167dc1f96e785",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e429040e_024412b9",
        "filename": "pc/sdp_offer_answer.cc",
        "patchSetId": 13
      },
      "lineNbr": 4835,
      "author": {
        "id": 5053
      },
      "writtenOn": "2021-06-03T20:52:42Z",
      "side": 1,
      "message": "Do we need to look at both the local and remote description? If the extension is rejected by the remote side, we\u0027ll keep offering it, which could cause the unsignaled streams to be destroyed/recreated on each round of negotiation.\n\nI don\u0027t know if it\u0027s fair to say \"if you want to avoid this, munge the offer\" if SDP munging is against the standard.",
      "revId": "60790cb883c865a9b2e0da9c331167dc1f96e785",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f5b22797_afea1e3a",
        "filename": "pc/sdp_offer_answer.cc",
        "patchSetId": 13
      },
      "lineNbr": 4835,
      "author": {
        "id": 5142
      },
      "writtenOn": "2021-06-04T12:21:02Z",
      "side": 1,
      "message": "I did think about this but I am not sure what is better/worse. Munging is against the standard, but so is supporting BUNDLE without supporting MID, so we\u0027re already in legacy land.\n\nI was trying to pick the lesser of two evils:\n\n- On one hand, if we turn of PT at offer time only to turn it back on at answer time due to the answerer removing the MID, we lose out on packets during negotiation for legacy endpoints. The SDP munging avoids that, but it does require munging.\n\n- On the other hand, if we don\u0027t turn off PT at offer time, we force popular SSRC-based services to always negotiate with dummy m\u003d sections which might not be obvious that you have to do since this is racy.\n\nIdeally, I don\u0027t want to force SSRC endpoints to use dummy m\u003d sections.\n\nBut it\u0027s not nice if every negotiation temporarily disables PT demuxing for clients that do want PT demuxing and don\u0027t want to SDP munge either.\n\nWhat do you think about this compromise: Once we have received an answer that turns PT demuxing on, from that point on we allow PT demuxing for all follow-up offers and answers? Then this is only an initial one-time setup for early media for legacy endpoints.",
      "parentUuid": "e429040e_024412b9",
      "revId": "60790cb883c865a9b2e0da9c331167dc1f96e785",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7fd79190_7c0bd3a6",
        "filename": "pc/sdp_offer_answer.cc",
        "patchSetId": 13
      },
      "lineNbr": 4835,
      "author": {
        "id": 5142
      },
      "writtenOn": "2021-06-05T07:27:10Z",
      "side": 1,
      "message": "Also I just realized that if you are the offerer and want PT demuxing, you ALREADY have to SDP munge because by default the payload types are not unique. So any user of offer-with-PT-demux is already an SDP munger. And otherwise if you are the answerer then SDP munging does not apply to you.\n\nIf we add a boolean that says \"once PT has been disabled, we always allow PT\" then there is no issue with follow-up offers and answers.",
      "parentUuid": "f5b22797_afea1e3a",
      "revId": "60790cb883c865a9b2e0da9c331167dc1f96e785",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "76b2a6c0_53f7124f",
        "filename": "pc/sdp_offer_answer.cc",
        "patchSetId": 13
      },
      "lineNbr": 4835,
      "author": {
        "id": 5142
      },
      "writtenOn": "2021-06-05T07:28:03Z",
      "side": 1,
      "message": "once PT has beeen enabled*",
      "parentUuid": "7fd79190_7c0bd3a6",
      "revId": "60790cb883c865a9b2e0da9c331167dc1f96e785",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f3f1f798_facc4572",
        "filename": "pc/sdp_offer_answer.cc",
        "patchSetId": 13
      },
      "lineNbr": 4835,
      "author": {
        "id": 5142
      },
      "writtenOn": "2021-06-07T13:24:11Z",
      "side": 1,
      "message": "I implemented \"once PT has been enabled, we always allow PT\" and I don\u0027t think the initial O/A exchange matters because then we\u0027re still waiting for fingerprints anyway.",
      "parentUuid": "76b2a6c0_53f7124f",
      "revId": "60790cb883c865a9b2e0da9c331167dc1f96e785",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d3997f96_6bbdf340",
        "filename": "pc/sdp_offer_answer.cc",
        "patchSetId": 13
      },
      "lineNbr": 4835,
      "author": {
        "id": 5053
      },
      "writtenOn": "2021-06-07T21:08:53Z",
      "side": 1,
      "message": "\u003e Munging is against the standard, but so is supporting BUNDLE without supporting MID\n\nBut munging is something the API is supposed to disallow, while supporting legacy endpoints is something it is expected to do.\n\n\u003e If we don\u0027t turn off PT at offer time, we force popular SSRC-based services to always negotiate with dummy m\u003d sections\n\nExcept that as you mentioned in an e mail, this isn\u0027t an issue for the first round of negotiation because we\u0027re waiting on fingerprints anyway.\n\n\u003e What do you think about this compromise: Once we have received an answer that turns PT demuxing on, from that point on we allow PT demuxing for all follow-up offers and answers?\n\nChecking for the extension in both the offer and answer seems more robust (what if only one media type uses the MID extension?), but this should work in general.\n\n\u003e Also I just realized that if you are the offerer and want PT demuxing, you ALREADY have to SDP munge because by default the payload types are not unique.\n\nYou mean when you have multiple m\u003d sections of the same media type? The legacy case we really care about is when you have one section of each media type though.",
      "parentUuid": "f3f1f798_facc4572",
      "revId": "60790cb883c865a9b2e0da9c331167dc1f96e785",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e508b397_75e15f53",
        "filename": "pc/sdp_offer_answer.cc",
        "patchSetId": 13
      },
      "lineNbr": 4835,
      "author": {
        "id": 5142
      },
      "writtenOn": "2021-06-08T10:24:45Z",
      "side": 1,
      "message": "\u003e But munging is something the API is supposed to disallow, while supporting legacy endpoints is something it is expected to do.\n\nTrue. You\u0027re right.\n\n\u003e Checking for the extension in both the offer and answer seems more robust (what if only one media type uses the MID extension?), but this should work in general.\n\nThat\u0027s an interesting case. Or if one BUNDLE uses MID but not another BUNDLE, but that seems far fetched.\n\nI did considered \"mixed\" setups but I *think* people would either use MID or not use MID rather than mix things - I could be wrong though.\n\nIn terms of early media, my thinking is that more complex logic does not make any difference prior to the fingerprint, and in follow-up O/As we have to continue to disable PT until we get the answer or else unsignalled ssrc could happen between offer and answer.\n\nBut in terms of mixed setups, more complex logic could help. Can you clarify, do you think I need to update the code to take care of \"mixed\" setups or is this CL good as-is? I don\u0027t think a more robust solution helps in non-mixed setups since we have to default to PT being off until proven otherwise anyway (after the initial exchange), but maybe I am missing something.\n\n\u003e You mean when you have multiple m\u003d sections of the same media type? The legacy case we really care about is when you have one section of each media type though.\n\nAh, right, that doesn\u0027t require munging.\n\n---\n\nWhat, if anything, do you want me to change with the current CL?\nShould I make PT demuxing per kind instead?",
      "parentUuid": "d3997f96_6bbdf340",
      "revId": "60790cb883c865a9b2e0da9c331167dc1f96e785",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    }
  ]
}