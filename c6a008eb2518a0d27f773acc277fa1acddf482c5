{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "e9080fc1_cebbf6a2",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 5634
      },
      "writtenOn": "2021-06-14T11:12:44Z",
      "side": 1,
      "message": "I think I found the last piece of missing state. Please review.\n",
      "revId": "c6a008eb2518a0d27f773acc277fa1acddf482c5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "3ec5c0c6_dd846d52",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 5142
      },
      "writtenOn": "2021-06-14T14:24:50Z",
      "side": 1,
      "message": "A question and a comment",
      "revId": "c6a008eb2518a0d27f773acc277fa1acddf482c5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4ad6677d_bf35a6dd",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 5634
      },
      "writtenOn": "2021-06-14T15:41:53Z",
      "side": 1,
      "message": "Thanks! Commented on a couple of items, and cleaned up the debug logs.\n",
      "revId": "c6a008eb2518a0d27f773acc277fa1acddf482c5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4b2fe008_2aed7bb4",
        "filename": "api/ice_transport_factory.cc",
        "patchSetId": 6
      },
      "lineNbr": 61,
      "author": {
        "id": 5142
      },
      "writtenOn": "2021-06-14T14:24:50Z",
      "side": 1,
      "message": "Here and in many other places - Remember to remove debug logs",
      "revId": "c6a008eb2518a0d27f773acc277fa1acddf482c5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "fbcc8005_971ae90d",
        "filename": "api/ice_transport_factory.cc",
        "patchSetId": 6
      },
      "lineNbr": 61,
      "author": {
        "id": 5634
      },
      "writtenOn": "2021-06-14T17:36:37Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "4b2fe008_2aed7bb4",
      "revId": "c6a008eb2518a0d27f773acc277fa1acddf482c5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "afb86f51_d62a137d",
        "filename": "pc/jsep_transport_controller.cc",
        "patchSetId": 6
      },
      "lineNbr": 1027,
      "author": {
        "id": 5142
      },
      "writtenOn": "2021-06-14T14:24:50Z",
      "side": 1,
      "message": "If the initial O/A exchange, i.e. before a BUNDLE group has been accepted, contains a lot of m\u003d sections, would we still end up creating all those transports initially? And would that cause a lot of ICE candidates for that exchange even if not in follow-up exchanges?\n\nI am thinking of apps that negotiate what they want immediately versus apps that do an initial dance only to then do a follow-up. Would \"max-bundle\" be able to save you?",
      "revId": "c6a008eb2518a0d27f773acc277fa1acddf482c5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c9b1f6dc_6a5eda54",
        "filename": "pc/jsep_transport_controller.cc",
        "patchSetId": 6
      },
      "lineNbr": 1027,
      "author": {
        "id": 5634
      },
      "writtenOn": "2021-06-14T15:41:53Z",
      "side": 1,
      "message": "Yes, we would; that\u0027s BUNDLE for you (and probably one reason why many apps choose to do an initial data-only offer/answer).\n\nMax-bundle will save you; that\u0027s checked before we call MaybeCreateJsepTransport.",
      "parentUuid": "afb86f51_d62a137d",
      "revId": "c6a008eb2518a0d27f773acc277fa1acddf482c5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "50b5eeca_06213187",
        "filename": "pc/jsep_transport_controller.cc",
        "patchSetId": 6
      },
      "lineNbr": 1029,
      "author": {
        "id": 5142
      },
      "writtenOn": "2021-06-14T14:24:50Z",
      "side": 1,
      "message": "You could have multiple BUNDLEs. It\u0027s probably not very popular, but the issue to support it had 14 stars (https://crbug.com/webrtc/10208) so we should probably not break that use case.\n\nDo we need to sanity check that this m\u003d section is supposed to be part of this group?",
      "revId": "c6a008eb2518a0d27f773acc277fa1acddf482c5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "cceef122_8c35cd7e",
        "filename": "pc/jsep_transport_controller.cc",
        "patchSetId": 6
      },
      "lineNbr": 1029,
      "author": {
        "id": 5634
      },
      "writtenOn": "2021-06-14T15:41:53Z",
      "side": 1,
      "message": "No, we shouldn\u0027t - according to my reading, JSEP demands that new m\u003d sections must be added to the first bundle group. (It doesn\u0027t really admit to there being more than one).\n\nRFC 8829:\n\n   The \"a\u003dgroup:BUNDLE\" attribute MUST include the MID identifiers\n   specified in the bundle group in the most recent answer, minus any\n   \"m\u003d\" sections that have been marked as rejected, plus any newly added\n   or re-enabled \"m\u003d\" sections.  In other words, the bundle attribute\n   MUST contain all \"m\u003d\" sections that were previously bundled, as long\n   as they are still alive, as well as any new \"m\u003d\" sections.\n\nNote that we can only get here in offers; in an answer, we are not allowed to add m\u003d sections. So our acceptance of multi-bundle offers is actually going slightly beyond JSEP.",
      "parentUuid": "50b5eeca_06213187",
      "revId": "c6a008eb2518a0d27f773acc277fa1acddf482c5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a18eefdd_771e6250",
        "filename": "pc/jsep_transport_controller.cc",
        "patchSetId": 6
      },
      "lineNbr": 1029,
      "author": {
        "id": 5053
      },
      "writtenOn": "2021-06-15T00:24:39Z",
      "side": 1,
      "message": "As far as I can see, the \"one BUNDLE group\" restriction only applies to the max-bundle policy; see 5.3.1.",
      "parentUuid": "cceef122_8c35cd7e",
      "revId": "c6a008eb2518a0d27f773acc277fa1acddf482c5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "68940593_7dab6196",
        "filename": "pc/jsep_transport_controller.cc",
        "patchSetId": 6
      },
      "lineNbr": 1029,
      "author": {
        "id": 5634
      },
      "writtenOn": "2021-06-15T05:47:38Z",
      "side": 1,
      "message": "It\u0027s not that it\u0027s a restriction, it\u0027s that JSEP ignores the multi-bundle case.\nI think that\u0027s a technical error in JSEP, but it does mean that when creating a new offer, JSEP only allows adding m- sections to a single BUNDLE attribute, and picking the first one is a reasonable choice.",
      "parentUuid": "a18eefdd_771e6250",
      "revId": "c6a008eb2518a0d27f773acc277fa1acddf482c5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c3066759_00f30eff",
        "filename": "pc/jsep_transport_controller.cc",
        "patchSetId": 6
      },
      "lineNbr": 1029,
      "author": {
        "id": 5142
      },
      "writtenOn": "2021-06-15T09:33:55Z",
      "side": 1,
      "message": "My initial concern was with breaking this demo page:\nhttps://jsfiddle.net/henbos/to89L6ce/59/\n\nAnd Good news. This CL does not break adding more m\u003d sections to existing BUNDLE groups even if there are multiple groups (I checked by pressing \"Two bundles\" followed by \"Re-negotiate 6 sections by two groups\").\n\nWhat about if we want to add new BUNDLE groups after the initial O/A exchange?\n\nIn this case we probably would need to update the logic like so [*], however it looks like this use case is already broken even without this CL (I tested it in Canary by pressing \"One bundle\" followed by \"Re-negotiate 6 sections by two groups\" and it gives me a demux error).\n\nSo bottom line: I think this CL works as-is and creating new groups is already not supported. So adding the [*] logic probably doesn\u0027t help.\n\n[*] Changing the logic from \"if bundles_ is non-zero, use the first transport\" to \"if this m\u003d section\u0027s BUNDLE in SDP already exists in bundle_, then use that BUNDLE\u0027s transport instead of creating a new one\" would let us create more BUNDLE groups after the initial exchange.",
      "parentUuid": "68940593_7dab6196",
      "revId": "c6a008eb2518a0d27f773acc277fa1acddf482c5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "09ebe96b_66f93eeb",
        "filename": "pc/jsep_transport_controller.cc",
        "patchSetId": 6
      },
      "lineNbr": 1029,
      "author": {
        "id": 5634
      },
      "writtenOn": "2021-06-15T09:40:32Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "c3066759_00f30eff",
      "revId": "c6a008eb2518a0d27f773acc277fa1acddf482c5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4ca980ed_572b2e62",
        "filename": "pc/jsep_transport_controller.cc",
        "patchSetId": 6
      },
      "lineNbr": 1029,
      "author": {
        "id": 5053
      },
      "writtenOn": "2021-06-15T22:03:22Z",
      "side": 1,
      "message": "JSEP does address the multi bundle case; it consistently uses terminology like \"a bundle group\" (rather than \"the\"), \"the same bundle group\", \"offered bundled groups\", \"in each bundle\"... For example:\n\n   If \"a\u003dgroup\" attributes with semantics of \"BUNDLE\" are offered,\n   corresponding session-level \"a\u003dgroup\" attributes MUST be added as\n   specified in [RFC5888].  These attributes MUST have semantics\n   \"BUNDLE\" and MUST include all mid identifiers from the offered bundle\n   groups that have not been rejected.",
      "parentUuid": "09ebe96b_66f93eeb",
      "revId": "c6a008eb2518a0d27f773acc277fa1acddf482c5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    }
  ]
}