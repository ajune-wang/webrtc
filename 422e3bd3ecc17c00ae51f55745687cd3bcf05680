{
  "comments": [
    {
      "key": {
        "uuid": "c68c0223_d8d31861",
        "filename": "modules/audio_coding/neteq/neteq_impl.cc",
        "patchSetId": 2
      },
      "lineNbr": 1917,
      "author": {
        "id": 7015
      },
      "writtenOn": "2019-02-28T09:29:01Z",
      "side": 1,
      "message": "I think this may lead to underestimate if there are missing packets.\n\nI think we may need to do something like\nstats_.JitterBufferDelay(newly_extracted_sample, waiting_time_ms);",
      "range": {
        "startLine": 1917,
        "startChar": 0,
        "endLine": 1917,
        "endChar": 0
      },
      "revId": "422e3bd3ecc17c00ae51f55745687cd3bcf05680",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "36e19a05_ab072030",
        "filename": "modules/audio_coding/neteq/neteq_impl.cc",
        "patchSetId": 2
      },
      "lineNbr": 1917,
      "author": {
        "id": 8038
      },
      "writtenOn": "2019-02-28T09:49:01Z",
      "side": 1,
      "message": "Can you elaborate a bit or give me an example when that would happen?",
      "parentUuid": "c68c0223_d8d31861",
      "range": {
        "startLine": 1917,
        "startChar": 0,
        "endLine": 1917,
        "endChar": 0
      },
      "revId": "422e3bd3ecc17c00ae51f55745687cd3bcf05680",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "592c9e13_188666a0",
        "filename": "modules/audio_coding/neteq/neteq_impl.cc",
        "patchSetId": 2
      },
      "lineNbr": 1917,
      "author": {
        "id": 8038
      },
      "writtenOn": "2019-02-28T09:51:32Z",
      "side": 1,
      "message": "Do you mean that it would be better to count packet-\u003etimestamp - prev_timestamp?",
      "parentUuid": "36e19a05_ab072030",
      "range": {
        "startLine": 1917,
        "startChar": 0,
        "endLine": 1917,
        "endChar": 0
      },
      "revId": "422e3bd3ecc17c00ae51f55745687cd3bcf05680",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "cbb93845_121ce332",
        "filename": "modules/audio_coding/neteq/neteq_impl.cc",
        "patchSetId": 2
      },
      "lineNbr": 1917,
      "author": {
        "id": 7015
      },
      "writtenOn": "2019-02-28T10:01:29Z",
      "side": 1,
      "message": "Yes, in principle we can replace first_timestamp with prev_timestamp in line 1916. But we can also do as simple as :\n\nlast_extracted_samples \u003d extracted_samples;\nextracted_samples \u003d packet-\u003etimestamp - first_timestamp + packet_duration;\nstats_.JitterBufferDelay(extracted_samples - last_extracted_samples, waiting_time_ms);",
      "parentUuid": "592c9e13_188666a0",
      "range": {
        "startLine": 1917,
        "startChar": 0,
        "endLine": 1917,
        "endChar": 0
      },
      "revId": "422e3bd3ecc17c00ae51f55745687cd3bcf05680",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9f70559d_42a5f1ae",
        "filename": "modules/audio_coding/neteq/neteq_impl.cc",
        "patchSetId": 2
      },
      "lineNbr": 1917,
      "author": {
        "id": 8038
      },
      "writtenOn": "2019-02-28T10:07:01Z",
      "side": 1,
      "message": "There is a check on line 1930 so that there will not be a timestamp or sequence number gap between extracted packets.",
      "parentUuid": "cbb93845_121ce332",
      "range": {
        "startLine": 1917,
        "startChar": 0,
        "endLine": 1917,
        "endChar": 0
      },
      "revId": "422e3bd3ecc17c00ae51f55745687cd3bcf05680",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "53af5e01_f897d681",
        "filename": "modules/audio_coding/neteq/neteq_impl.cc",
        "patchSetId": 2
      },
      "lineNbr": 1917,
      "author": {
        "id": 7015
      },
      "writtenOn": "2019-02-28T11:39:48Z",
      "side": 1,
      "message": "good point. Then the original formula is kind of to protect timestamp overlaps? and then your proposal can overestimate (in a different way than the overestimate in the original formula), can\u0027t it?",
      "parentUuid": "9f70559d_42a5f1ae",
      "range": {
        "startLine": 1917,
        "startChar": 0,
        "endLine": 1917,
        "endChar": 0
      },
      "revId": "422e3bd3ecc17c00ae51f55745687cd3bcf05680",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6344783f_fdfc6641",
        "filename": "modules/audio_coding/neteq/neteq_impl.cc",
        "patchSetId": 2
      },
      "lineNbr": 1917,
      "author": {
        "id": 8038
      },
      "writtenOn": "2019-02-28T12:32:37Z",
      "side": 1,
      "message": "We have broken down the problem into 3:\n\n1) Over count packets multiple times. This is what the cl fixes.\n2) Packet loss. This is already handled, the loop will exit if we have packet loss on line 1930.\n3) Packets with overlapping timestamps. In this case we will count the total duration of all of the packets, even though all of the samples will not be put into the sync buffer eventually. I think this is the correct behavior given that we track the delay per-packet and weigh the packets on the sample duration. The samples eventually received by the receiver is a different metric, `totalSamplesReceived`.",
      "parentUuid": "53af5e01_f897d681",
      "range": {
        "startLine": 1917,
        "startChar": 0,
        "endLine": 1917,
        "endChar": 0
      },
      "revId": "422e3bd3ecc17c00ae51f55745687cd3bcf05680",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2c11299a_1992b3fc",
        "filename": "modules/audio_coding/neteq/neteq_impl.cc",
        "patchSetId": 2
      },
      "lineNbr": 1917,
      "author": {
        "id": 7015
      },
      "writtenOn": "2019-02-28T12:41:22Z",
      "side": 1,
      "message": "Sure, that is a clear summary of this.",
      "parentUuid": "6344783f_fdfc6641",
      "range": {
        "startLine": 1917,
        "startChar": 0,
        "endLine": 1917,
        "endChar": 0
      },
      "revId": "422e3bd3ecc17c00ae51f55745687cd3bcf05680",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": false
    }
  ]
}