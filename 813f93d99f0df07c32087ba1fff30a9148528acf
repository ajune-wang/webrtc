{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "3c0aedd9_03fb3901",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 5634
      },
      "writtenOn": "2022-12-14T22:42:46Z",
      "side": 1,
      "message": "Adding Kari as reviewer, since this is IOS code.",
      "revId": "813f93d99f0df07c32087ba1fff30a9148528acf",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "aca4827f_28fffc8a",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 5634
      },
      "writtenOn": "2022-12-14T22:46:53Z",
      "side": 1,
      "message": "Had a few questions despite not reading IOS.",
      "revId": "813f93d99f0df07c32087ba1fff30a9148528acf",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "091bbef6_d57addbc",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 5520
      },
      "writtenOn": "2022-12-15T13:39:25Z",
      "side": 1,
      "message": "Thanks Roberto! This is a long-standing issue and great to see this fixed.\n\nAdding henrika@ as well as the audio expert.",
      "revId": "813f93d99f0df07c32087ba1fff30a9148528acf",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "8e685edb_5bfb19c4",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 5091
      },
      "writtenOn": "2022-12-15T14:02:48Z",
      "side": 1,
      "message": "Thanks for doing this!\n\nPlease provide an overview of the changes and explain how the new functionality has been tested? Is any new test needed to ensure that the new support is not broken.\n\nIt is not fully clear to me how adding a local stream will enable recording again.",
      "revId": "813f93d99f0df07c32087ba1fff30a9148528acf",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "9a630004_44be85e6",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 19779
      },
      "writtenOn": "2022-12-15T17:22:23Z",
      "side": 1,
      "message": "Currently, when the `AudioDeviceIOS` is created it always enable the input in the AudioUnit.\n\nThis means that if you have a PC that is only playing the other end audio, and you don\u0027t plan to capture any audio, Microphone permissions are requested, and the record indicator is turned on, creating an awkward experience for the user that is not expecting to have their microphone active if they are not sharing audio.\n\nAfter that, when you add audio tracks to the peerconnection, the `StartRecording` or `StartPlayout` are called, if the track needs to record or play audio samples.\nBut even if `StartRecording` is never called, the input is always enabled.\n\nThe idea behind this PR is to **not** enable the input by default, and handle it in the `StartRecording`/`StopRecording` methods.\nWhen `StartRecording` is called, it enables the input in the AudioUnit by calling the `SetInputEnabled(true)`, and same for `StopRecording()` -\u003e `SetInputEnabled(false)`.\n\nWith this, the light and the permissions will be only requested when the track added to the PC requires to record audio, and then the `StartRecording` is called",
      "parentUuid": "8e685edb_5bfb19c4",
      "revId": "813f93d99f0df07c32087ba1fff30a9148528acf",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "41a16146_29ea6d50",
        "filename": "sdk/objc/native/src/audio/audio_device_ios.h",
        "patchSetId": 2
      },
      "lineNbr": 213,
      "author": {
        "id": 5520
      },
      "writtenOn": "2022-12-15T13:39:25Z",
      "side": 1,
      "message": "the convention for private methods in this class is to return a bool, true for success and false otherwise. I\u0027d prefer to stick to that.",
      "range": {
        "startLine": 213,
        "startChar": 2,
        "endLine": 213,
        "endChar": 9
      },
      "revId": "813f93d99f0df07c32087ba1fff30a9148528acf",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4fdf5bec_a23f1d0c",
        "filename": "sdk/objc/native/src/audio/audio_device_ios.h",
        "patchSetId": 2
      },
      "lineNbr": 213,
      "author": {
        "id": 5520
      },
      "writtenOn": "2022-12-15T13:39:25Z",
      "side": 1,
      "message": "This would be clearer if it was called something like `SetInputEnabled`. `EnableInput(true)` just reads awkwardly.",
      "range": {
        "startLine": 213,
        "startChar": 10,
        "endLine": 213,
        "endChar": 21
      },
      "revId": "813f93d99f0df07c32087ba1fff30a9148528acf",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "2d0ee000_ba7454da",
        "filename": "sdk/objc/native/src/audio/audio_device_ios.h",
        "patchSetId": 2
      },
      "lineNbr": 213,
      "author": {
        "id": 19779
      },
      "writtenOn": "2022-12-15T15:08:30Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "4fdf5bec_a23f1d0c",
      "range": {
        "startLine": 213,
        "startChar": 10,
        "endLine": 213,
        "endChar": 21
      },
      "revId": "813f93d99f0df07c32087ba1fff30a9148528acf",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "589652d0_824f8022",
        "filename": "sdk/objc/native/src/audio/audio_device_ios.h",
        "patchSetId": 2
      },
      "lineNbr": 213,
      "author": {
        "id": 19779
      },
      "writtenOn": "2022-12-15T15:08:30Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "41a16146_29ea6d50",
      "range": {
        "startLine": 213,
        "startChar": 2,
        "endLine": 213,
        "endChar": 9
      },
      "revId": "813f93d99f0df07c32087ba1fff30a9148528acf",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "46284ea8_aa419689",
        "filename": "sdk/objc/native/src/audio/audio_device_ios.mm",
        "patchSetId": 2
      },
      "lineNbr": 274,
      "author": {
        "id": 5634
      },
      "writtenOn": "2022-12-14T22:46:53Z",
      "side": 1,
      "message": "Leftover debug statement, or is it common to mix RTCLog and LOGI?",
      "revId": "813f93d99f0df07c32087ba1fff30a9148528acf",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "199017ff_05f7fdbc",
        "filename": "sdk/objc/native/src/audio/audio_device_ios.mm",
        "patchSetId": 2
      },
      "lineNbr": 274,
      "author": {
        "id": 19779
      },
      "writtenOn": "2022-12-15T15:08:30Z",
      "side": 1,
      "message": "I copied what\u0027s on other class methods. I think it is fine to use LOGI()",
      "parentUuid": "46284ea8_aa419689",
      "revId": "813f93d99f0df07c32087ba1fff30a9148528acf",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0b7e18be_fb23222b",
        "filename": "sdk/objc/native/src/audio/audio_device_ios.mm",
        "patchSetId": 2
      },
      "lineNbr": 286,
      "author": {
        "id": 5634
      },
      "writtenOn": "2022-12-14T22:46:53Z",
      "side": 1,
      "message": "nit: not audio -\u003e no audio, or \"and audio is not being played\"",
      "revId": "813f93d99f0df07c32087ba1fff30a9148528acf",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c7a8cd4a_b19c56d6",
        "filename": "sdk/objc/native/src/audio/audio_device_ios.mm",
        "patchSetId": 2
      },
      "lineNbr": 286,
      "author": {
        "id": 19779
      },
      "writtenOn": "2022-12-15T15:08:30Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "0b7e18be_fb23222b",
      "revId": "813f93d99f0df07c32087ba1fff30a9148528acf",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f4008f8a_ba41ba1e",
        "filename": "sdk/objc/native/src/audio/audio_device_ios.mm",
        "patchSetId": 2
      },
      "lineNbr": 287,
      "author": {
        "id": 5634
      },
      "writtenOn": "2022-12-14T22:46:53Z",
      "side": 1,
      "message": "Will the audio units be initialized if the value of playing_.load() changes later?",
      "revId": "813f93d99f0df07c32087ba1fff30a9148528acf",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f40519e9_8975be6d",
        "filename": "sdk/objc/native/src/audio/audio_device_ios.mm",
        "patchSetId": 2
      },
      "lineNbr": 287,
      "author": {
        "id": 19779
      },
      "writtenOn": "2022-12-15T15:08:30Z",
      "side": 1,
      "message": "Yep, it is changed by using `playing_.store()` and that happens in both `StartPlayout` and `StopPlayout` that take care of updating the audiounits state",
      "parentUuid": "f4008f8a_ba41ba1e",
      "revId": "813f93d99f0df07c32087ba1fff30a9148528acf",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0941b237_ce1206ab",
        "filename": "sdk/objc/native/src/audio/audio_device_ios.mm",
        "patchSetId": 2
      },
      "lineNbr": 351,
      "author": {
        "id": 5520
      },
      "writtenOn": "2022-12-15T13:39:25Z",
      "side": 1,
      "message": "nit: extra newline",
      "revId": "813f93d99f0df07c32087ba1fff30a9148528acf",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "369ece50_1d6832ce",
        "filename": "sdk/objc/native/src/audio/audio_device_ios.mm",
        "patchSetId": 2
      },
      "lineNbr": 351,
      "author": {
        "id": 19779
      },
      "writtenOn": "2022-12-15T15:08:30Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "0941b237_ce1206ab",
      "revId": "813f93d99f0df07c32087ba1fff30a9148528acf",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "33673d97_7bbcb558",
        "filename": "sdk/objc/native/src/audio/voice_processing_audio_unit.mm",
        "patchSetId": 2
      },
      "lineNbr": 199,
      "author": {
        "id": 5091
      },
      "writtenOn": "2022-12-15T14:02:48Z",
      "side": 1,
      "message": "What is the relationship between Init() (where kAudioOutputUnitProperty_EnableIO is set today) and Initialize()?",
      "revId": "813f93d99f0df07c32087ba1fff30a9148528acf",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9797cdc0_5ce67522",
        "filename": "sdk/objc/native/src/audio/voice_processing_audio_unit.mm",
        "patchSetId": 2
      },
      "lineNbr": 199,
      "author": {
        "id": 19779
      },
      "writtenOn": "2022-12-15T17:22:23Z",
      "side": 1,
      "message": "* `Init` is called only once, when the audio device is being initialized\n* `Initialize` was called when some property in the audio units should change, like for example when the sample rate was updated.\n\nIn this PR I\u0027m reusing that logic of `Initialize` to call it when we want to enable the input of the AudioUnit.",
      "parentUuid": "33673d97_7bbcb558",
      "revId": "813f93d99f0df07c32087ba1fff30a9148528acf",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ea7a4d04_2edc51cb",
        "filename": "sdk/objc/native/src/audio/voice_processing_audio_unit.mm",
        "patchSetId": 2
      },
      "lineNbr": 238,
      "author": {
        "id": 5520
      },
      "writtenOn": "2022-12-15T13:39:25Z",
      "side": 1,
      "message": "enable_input_value",
      "range": {
        "startLine": 238,
        "startChar": 33,
        "endLine": 238,
        "endChar": 45
      },
      "revId": "813f93d99f0df07c32087ba1fff30a9148528acf",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "45b416de_95ae53ea",
        "filename": "sdk/objc/native/src/audio/voice_processing_audio_unit.mm",
        "patchSetId": 2
      },
      "lineNbr": 238,
      "author": {
        "id": 19779
      },
      "writtenOn": "2022-12-15T15:08:30Z",
      "side": 1,
      "message": "Oh, good catch!. Thank you!",
      "parentUuid": "ea7a4d04_2edc51cb",
      "range": {
        "startLine": 238,
        "startChar": 33,
        "endLine": 238,
        "endChar": 45
      },
      "revId": "813f93d99f0df07c32087ba1fff30a9148528acf",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    }
  ]
}