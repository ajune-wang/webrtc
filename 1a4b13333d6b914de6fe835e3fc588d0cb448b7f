{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "03803661_1d9f581d",
        "filename": "rtc_base/thread.cc",
        "patchSetId": 4
      },
      "lineNbr": 949,
      "author": {
        "id": 5508
      },
      "writtenOn": "2021-05-11T17:11:57Z",
      "side": 1,
      "message": "this is the line I was wondering about the most. Note the `could_be_blocking_call_count_++;` line; that\u0027s to me an indicator that a synchronous Invoke is being handled e.g. if signaling_thread \u003d\u003d worker_thread, and could sneak past the policy check.\n\nWhat I was basically wondering about was if we could move the `AssertBlockingIsAllowedOnCurrentThread()` call should be moved up a few lines, before the IsCurrent() check.",
      "revId": "1a4b13333d6b914de6fe835e3fc588d0cb448b7f",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "46d210b8_3a533ab6",
        "filename": "rtc_base/thread.cc",
        "patchSetId": 4
      },
      "lineNbr": 949,
      "author": {
        "id": 9515
      },
      "writtenOn": "2021-05-11T17:40:31Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "03803661_1d9f581d",
      "revId": "1a4b13333d6b914de6fe835e3fc588d0cb448b7f",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f96e8b99_e6061fed",
        "filename": "rtc_base/thread.cc",
        "patchSetId": 4
      },
      "lineNbr": 949,
      "author": {
        "id": 9515
      },
      "writtenOn": "2021-05-11T20:18:27Z",
      "side": 1,
      "message": "That went so so. OK if I move it back into CheckSendPoliciesBeforeSendTask?",
      "parentUuid": "46d210b8_3a533ab6",
      "revId": "1a4b13333d6b914de6fe835e3fc588d0cb448b7f",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6b074281_6d321713",
        "filename": "rtc_base/thread.cc",
        "patchSetId": 4
      },
      "lineNbr": 949,
      "author": {
        "id": 5508
      },
      "writtenOn": "2021-05-14T16:33:13Z",
      "side": 1,
      "message": "Maybe we should check with Artem on why the policies aren\u0027t applied for this shortcut.\n\nBtw, I don\u0027t see code calling CheckSendPoliciesBeforeSendTask() outside of Thread. Will that be included in this CL?",
      "parentUuid": "f96e8b99_e6061fed",
      "revId": "1a4b13333d6b914de6fe835e3fc588d0cb448b7f",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e017611a_2067dd01",
        "filename": "rtc_base/thread.cc",
        "patchSetId": 4
      },
      "lineNbr": 949,
      "author": {
        "id": 6337
      },
      "writtenOn": "2021-05-14T17:38:42Z",
      "side": 1,
      "message": "I think the reason behind was that we are not changing thread here and I assumed that invokes from thread to itself are allowed.",
      "parentUuid": "6b074281_6d321713",
      "revId": "1a4b13333d6b914de6fe835e3fc588d0cb448b7f",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6ed7c2a0_e9661cab",
        "filename": "rtc_base/thread.cc",
        "patchSetId": 4
      },
      "lineNbr": 949,
      "author": {
        "id": 9515
      },
      "writtenOn": "2021-05-17T07:02:28Z",
      "side": 1,
      "message": "@tommi - I plan to use the new method in Chromium which overrides Thread::Send.",
      "parentUuid": "e017611a_2067dd01",
      "revId": "1a4b13333d6b914de6fe835e3fc588d0cb448b7f",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a03334cc_d0a3a8a8",
        "filename": "rtc_base/thread.cc",
        "patchSetId": 4
      },
      "lineNbr": 949,
      "author": {
        "id": 5508
      },
      "writtenOn": "2021-05-21T06:30:39Z",
      "side": 1,
      "message": "Artem - I think we shouldn\u0027t consider that to be allowed.\n\nThe conceptual threads, signaling, worker and network, are the concepts that need to follow the policies. The policies are the rules that the code needs to be aware of and respect.  If our tests set all those three conceptual pointers to point to the same thread instance, then all of a sudden they bypass all the policies (as many tests do), then we\u0027ve lost some of the benefits of the policies.",
      "parentUuid": "6ed7c2a0_e9661cab",
      "revId": "1a4b13333d6b914de6fe835e3fc588d0cb448b7f",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4e8f240f_f4a1f738",
        "filename": "rtc_base/thread.cc",
        "patchSetId": 4
      },
      "lineNbr": 949,
      "author": {
        "id": 6337
      },
      "writtenOn": "2021-05-21T12:39:38Z",
      "side": 1,
      "message": "It makes sense. I\u0027ll check it next week. Also invokes to itself might be removed in some places, I suppose.",
      "parentUuid": "a03334cc_d0a3a8a8",
      "revId": "1a4b13333d6b914de6fe835e3fc588d0cb448b7f",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "75b1359f_f16b1e54",
        "filename": "rtc_base/thread.cc",
        "patchSetId": 4
      },
      "lineNbr": 953,
      "author": {
        "id": 5508
      },
      "writtenOn": "2021-05-11T17:11:57Z",
      "side": 1,
      "message": "nit: CheckSendPoliciesBeforeSendTask? (since Post is conceptually supposed to be non-blocking and this is \u0027send\u0027 related).",
      "revId": "1a4b13333d6b914de6fe835e3fc588d0cb448b7f",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "21dd2c95_841c3eda",
        "filename": "rtc_base/thread.cc",
        "patchSetId": 4
      },
      "lineNbr": 953,
      "author": {
        "id": 9515
      },
      "writtenOn": "2021-05-11T17:40:31Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "75b1359f_f16b1e54",
      "revId": "1a4b13333d6b914de6fe835e3fc588d0cb448b7f",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    }
  ]
}