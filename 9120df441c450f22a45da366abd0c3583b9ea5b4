{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "f63c6278_7d63b8d5",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 5117
      },
      "writtenOn": "2020-11-19T14:43:12Z",
      "side": 1,
      "message": "My may concern is that SVC is ignored in this change.\n\nAlso, I believe it could be simplified.\n\nThen, This Cl could be simplified. I don\u0027t believe newly added min frame size is needed. \n\nInitial frame drop would already never trigger for low enough resolutions. See https://source.chromium.org/chromium/chromium/src/+/master:third_party/webrtc/video/video_stream_encoder.cc;l\u003d1864;drc\u003d8a5de62dd01360cfe3d150640d3ff4d974bbe842\n\nOr am I missing something?\n\nWithout it, all changes could be contained inside VideoStreamEncoder::DropDueSize(). Or separate GetHighestActiveStreamResolution() and GetNumActiveStreams() may be added to split the logic in more readable blocks.\n\nAdding this logic to VideoStreamEncoderResourceManager seems a bit excessive.\n",
      "revId": "9120df441c450f22a45da366abd0c3583b9ea5b4",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e1e46be3_1d818990",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 5492
      },
      "writtenOn": "2020-11-19T16:39:16Z",
      "side": 1,
      "message": "The reset can only be triggered once, the min frame size was added to avoid triggering on an already low resolution if the frame size is initially low and then later increased.",
      "parentUuid": "f63c6278_7d63b8d5",
      "revId": "9120df441c450f22a45da366abd0c3583b9ea5b4",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e823566f_34173a5f",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 5117
      },
      "writtenOn": "2020-11-20T09:47:14Z",
      "side": 1,
      "message": "But that\u0027s already in the frame-dropper by design: after a single frame is encoded, initial frame drop is disabled here:\nhttps://source.chromium.org/chromium/chromium/src/+/master:third_party/webrtc/video/adaptation/video_stream_encoder_resource_manager.cc;l\u003d109;drc\u003d820712f20d3eaf481b9d4043a090e4947b52907f\n\nThis is absolutely unneeded complexity. The problem you are trying to solve here is that singlecast-via-deactivating-layers doesn\u0027t behave exactly as singlecast-due-to-one-ssrc, right? So the solution is to remove the difference, not to add new checks and config values.\n\nAnd the difference is an explicit check that we have several streams. So the main change your CL has to make is to refine this check to not disable frame drops if there\u0027s only one active layer. Also, using actual active resolution instead of the input one, is a required change.",
      "parentUuid": "e1e46be3_1d818990",
      "revId": "9120df441c450f22a45da366abd0c3583b9ea5b4",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4bcd78d7_a3b81cd8",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 5492
      },
      "writtenOn": "2020-11-20T15:00:01Z",
      "side": 1,
      "message": "I have split the CL, this part will be done in a follow up cl.",
      "parentUuid": "e823566f_34173a5f",
      "revId": "9120df441c450f22a45da366abd0c3583b9ea5b4",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "7a62ad64_48a3c516",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 5117
      },
      "writtenOn": "2020-11-20T15:09:45Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "4bcd78d7_a3b81cd8",
      "revId": "9120df441c450f22a45da366abd0c3583b9ea5b4",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d20f6804_77dd5029",
        "filename": "video/adaptation/video_stream_encoder_resource_manager.cc",
        "patchSetId": 5
      },
      "lineNbr": 63,
      "author": {
        "id": 5117
      },
      "writtenOn": "2020-11-19T14:43:12Z",
      "side": 1,
      "message": "I believe a separate code path for VP9 is needed. It should check codec.spatialLayers in the same way.",
      "revId": "9120df441c450f22a45da366abd0c3583b9ea5b4",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "32e3ea73_b943f64a",
        "filename": "video/adaptation/video_stream_encoder_resource_manager.cc",
        "patchSetId": 5
      },
      "lineNbr": 63,
      "author": {
        "id": 5492
      },
      "writtenOn": "2020-11-19T16:39:16Z",
      "side": 1,
      "message": "This CL only handles simulcast. Perhaps svc could be handled in a separate CL?",
      "parentUuid": "d20f6804_77dd5029",
      "revId": "9120df441c450f22a45da366abd0c3583b9ea5b4",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f879537d_0ed3fe6b",
        "filename": "video/adaptation/video_stream_encoder_resource_manager.cc",
        "patchSetId": 5
      },
      "lineNbr": 63,
      "author": {
        "id": 5117
      },
      "writtenOn": "2020-11-20T09:47:14Z",
      "side": 1,
      "message": "OK. Would you work on SVC in a follow-up CL or should I pick that up?",
      "parentUuid": "32e3ea73_b943f64a",
      "revId": "9120df441c450f22a45da366abd0c3583b9ea5b4",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b8bb05ab_d4ef7950",
        "filename": "video/adaptation/video_stream_encoder_resource_manager.cc",
        "patchSetId": 5
      },
      "lineNbr": 63,
      "author": {
        "id": 5492
      },
      "writtenOn": "2020-11-20T15:00:01Z",
      "side": 1,
      "message": "Lets discuss.",
      "parentUuid": "f879537d_0ed3fe6b",
      "revId": "9120df441c450f22a45da366abd0c3583b9ea5b4",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "acbb1f36_8f4a8991",
        "filename": "video/video_stream_encoder.cc",
        "patchSetId": 5
      },
      "lineNbr": 1849,
      "author": {
        "id": 5117
      },
      "writtenOn": "2020-11-19T14:43:12Z",
      "side": 1,
      "message": "This shouldn\u0027t be enabled only for simulcast. The same issues are there for SVC. Move the new part outside of \"(simulcast || svc)\" condition.",
      "revId": "9120df441c450f22a45da366abd0c3583b9ea5b4",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "884f9e45_7dc43c42",
        "filename": "video/video_stream_encoder.cc",
        "patchSetId": 5
      },
      "lineNbr": 1856,
      "author": {
        "id": 5117
      },
      "writtenOn": "2020-11-19T14:43:12Z",
      "side": 1,
      "message": "remove this condition, so that if it\u0027s indeed simulcast or svc and only one layer is active, pixel_count would be overriden. Or extend this condition to also include SVC streams.",
      "range": {
        "startLine": 1856,
        "startChar": 6,
        "endLine": 1856,
        "endChar": 49
      },
      "revId": "9120df441c450f22a45da366abd0c3583b9ea5b4",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    }
  ]
}