{
  "comments": [
    {
      "key": {
        "uuid": "e328f39a_445ba05a",
        "filename": "api/stats/rtcstats_objects.h",
        "patchSetId": 4
      },
      "lineNbr": 466,
      "author": {
        "id": 5142
      },
      "writtenOn": "2020-03-02T16:06:09Z",
      "side": 1,
      "message": "Notes for each \"track\" stats that was implemented prior to this CL...\n\ntrackIdentifier: Not in spec\u0027s outbound-rtp. Already available through \"outbound-rtp.mediaSourceId-\u003etrackIdentifier\"\n\nmediaSourceId: NOW IMPLEMENTED FOR SIMULCAST\n\nremoteSource: Not in spec\u0027s outbound-rtp and not needed because if it existed it would always be false.\n\nended: Not in spec\u0027s outbound-rtp. Reflects the ended state of the track, not sure we need that, but if we did we should add it to \"media-source\".\n\ndetached: Not in the spec\u0027s outbound-rtp and N/A.\n\njitterBufferDelay: N/A to sending, only receiving\njitterBufferDelayEmitted: N/A to sending, only receiving\n\nframeWidth: NOW IMPLEMENTED FOR SIMULCAST\nframeHeight: NOW IMPLEMENTED FOR SIMULCAST\n\nframesPerSecond: NOW IMPLEMENTED FOR SIMULCAST (but see other comment)\n\nframesSent: MISSING (see other comment)\nhugeFramesSent: MISSING (see other comment)\n\nframesReceived: N/A to sending, only receiving\nframesDecoded: N/A to sending, only receiving\nframesDropped: N/A to sending, only receiving\naudioLevel: N/A to sending, only receiving\ntotalAudioEnergy: N/A to sending, only receiving\nechoReturnLoss: N/A to sending, only receiving\nechoReturnLossEnhancement: N/A to sending, only receiving\ntotalSamplesReceived: N/A to sending, only receiving\ntotalSamplesDuration: N/A to sending, only receiving\nconcealedSamples: N/A to sending, only receiving\nsilentConcealedSamples: N/A to sending, only receiving\nconcealmentEvents: N/A to sending, only receiving\ninsertedSamplesForDeceleration: N/A to sending, only receiving\nremovedSamplesForAcceleration: N/A to sending, only receiving\njitterBufferFlushes: N/A to sending, only receiving\ndelayedPacketOutageSamples: N/A to sending, only receiving\nrelativePacketArrivalDelay: N/A to sending, only receiving\ninterruptionCount: N/A to sending, only receiving\ntotalInterruptionDuration: N/A to sending, only receiving\nfreezeCount: N/A to sending, only receiving\npauseCount: N/A to sending, only receiving\ntotalFreezesDuration: N/A to sending, only receiving\ntotalPausesDuration: N/A to sending, only receiving\ntotalFramesDuration: N/A to sending, only receiving\nsumSquaredFrameDurations: N/A to sending, only receiving",
      "revId": "eb629b2822f8f469c45665784227bd0918850d43",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "102f9920_e4296173",
        "filename": "api/stats/rtcstats_objects.h",
        "patchSetId": 4
      },
      "lineNbr": 466,
      "author": {
        "id": 5142
      },
      "writtenOn": "2020-03-02T16:22:41Z",
      "side": 1,
      "message": "We should make sure that we have test coverage for the legacy and modern portions of the metrics.",
      "parentUuid": "e328f39a_445ba05a",
      "revId": "eb629b2822f8f469c45665784227bd0918850d43",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "286a496a_216ea00f",
        "filename": "api/stats/rtcstats_objects.h",
        "patchSetId": 4
      },
      "lineNbr": 483,
      "author": {
        "id": 5142
      },
      "writtenOn": "2020-03-02T16:06:09Z",
      "side": 1,
      "message": "[In \"track\" but not \"outbound-rtp\"] What about framesSent and hugeFramesSent?",
      "revId": "eb629b2822f8f469c45665784227bd0918850d43",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "96cee39e_7f52bf3a",
        "filename": "media/engine/webrtc_video_engine.cc",
        "patchSetId": 4
      },
      "lineNbr": 2312,
      "author": {
        "id": 5142
      },
      "writtenOn": "2020-03-02T16:22:41Z",
      "side": 1,
      "message": "I\u0027m happy to take a closer reviewing look, but for now:\n\nIt seems very error prone to have several methods all processing all the same stats. It would be easy, if a metric is modified or added, to forget to do it in all places.\n\nWould it be possible to...\n1) Report the metrics on a per-layer basis, e.g. GetPerLayerVideoSenderInfos().\n2) Aggregate the result of 1) as a separate method, e.g. GetAggregateVideoSenderInfos(), that takes the per-layer infos as input - ensuring that all metrics are snapshot of the exact same point in time. Lower layers need not be collected from twice to get both 1) and 2) type of infos.\n\nFor legacy getStats(), we simply report the aggregate and this should be no difference from before this CL.\n\nFor modern getStats(), for backwards-compatibility reasons, we still create \"track\" stats based on the aggregate infos. But for the simulcast stats, the \"outbound-rtp\" stats are created from the per-layer infos.",
      "revId": "eb629b2822f8f469c45665784227bd0918850d43",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "13262362_4a3b58bb",
        "filename": "media/engine/webrtc_video_engine.cc",
        "patchSetId": 4
      },
      "lineNbr": 2312,
      "author": {
        "id": 5142
      },
      "writtenOn": "2020-03-04T12:14:29Z",
      "side": 1,
      "message": "Let me know when you\u0027ve taken a look at this comment. I\u0027ll do a deeper review then.",
      "parentUuid": "96cee39e_7f52bf3a",
      "revId": "eb629b2822f8f469c45665784227bd0918850d43",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d79078a5_1604ceac",
        "filename": "stats/rtcstats_objects.cc",
        "patchSetId": 4
      },
      "lineNbr": 767,
      "author": {
        "id": 5142
      },
      "writtenOn": "2020-03-02T16:06:09Z",
      "side": 1,
      "message": "\"track.framesPerSecond\" was never implemented...\n\n1. What we had was \"track.framesSent\". To get the same metrics but moved, we need to add \"outbound-rtp.framesSent\". Can we add that? My hope is that if \"outbound-rtp\" has everything that \"track\" did then we can encourage deprecation.\n\n2. But \"outbound-rtp.framesPerSecond\" is indeed in the spec! Implementing that is nice but it is a new feature. Also, since this is defined as \"number of encoded frames during the last second\" and we already have \"outbound-rtp.framesEncoded\", we should be able to cover this with existing metrics. So for the sake of reviewing and landing, can you move framesPerSecond to a separate CL?",
      "revId": "eb629b2822f8f469c45665784227bd0918850d43",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2b25e23a_2759d496",
        "filename": "stats/rtcstats_objects.cc",
        "patchSetId": 4
      },
      "lineNbr": 767,
      "author": {
        "id": 9279
      },
      "writtenOn": "2020-03-04T08:25:47Z",
      "side": 1,
      "message": "Ok, I can add framesSent and hugeFramesSent, but when we already add new stats fields what problem does it create adding also framesPerSecond in one go? Would it be enough to remove just exposing it in RTCOutboundRTPStreamStats or better to revert all related changes?",
      "parentUuid": "d79078a5_1604ceac",
      "revId": "eb629b2822f8f469c45665784227bd0918850d43",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "40b8ebf4_cf92a1e2",
        "filename": "stats/rtcstats_objects.cc",
        "patchSetId": 4
      },
      "lineNbr": 767,
      "author": {
        "id": 5142
      },
      "writtenOn": "2020-03-04T12:13:38Z",
      "side": 1,
      "message": "If you add framesSent and hugeFrameSent in this CL then we\u0027re good.\nIf you want to add framesPerSecond as well in the CL that\u0027s fine by me, my thought was just that this is an additional new feature that could be reviewed and landed as a follow-up (and if we had to revert it we could revert it separately). But you can decide.",
      "parentUuid": "2b25e23a_2759d496",
      "revId": "eb629b2822f8f469c45665784227bd0918850d43",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    }
  ]
}