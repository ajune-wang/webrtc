{
  "comments": [
    {
      "key": {
        "uuid": "30c6420a_0783b0e9",
        "filename": "modules/rtp_rtcp/source/rtp_depacketizer_av1.cc",
        "patchSetId": 3
      },
      "lineNbr": 85,
      "author": {
        "id": 5527
      },
      "writtenOn": "2019-11-13T11:55:39Z",
      "side": 1,
      "message": "Copy pasted comment from the sketch CL, even though there is no WriteLeb128:\n\nI think the code would be simpler if you just had these two functions:\n  Leb128Value Uint64ToLeb128(uint64_t value);\n  uint64_t Leb128ToUint64(Leb128Value value);\nI also think having a class kind of like this could help:\n  class RtpPayloadReader {\n   private:\n    RtpPayloadReader(rtc::ArrayView\u003cconst rtc::ArrayView\u003cconst uint8_t\u003e\u003e rtp_payloads);\n    uint64_t ReadBytes(size_t offset, size_t num_bytes);\n    void CopyBytesTo(size_t offset, size_t num_bytes, uint8_t* destination);\n  };",
      "range": {
        "startLine": 85,
        "startChar": 12,
        "endLine": 85,
        "endChar": 22
      },
      "revId": "7c19f29f94d8bc27465f033adaf9e9be272b6b47",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4d08a14f_382f48f1",
        "filename": "modules/rtp_rtcp/source/rtp_depacketizer_av1.cc",
        "patchSetId": 3
      },
      "lineNbr": 85,
      "author": {
        "id": 5019
      },
      "writtenOn": "2019-11-13T13:16:58Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "30c6420a_0783b0e9",
      "range": {
        "startLine": 85,
        "startChar": 12,
        "endLine": 85,
        "endChar": 22
      },
      "revId": "7c19f29f94d8bc27465f033adaf9e9be272b6b47",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2c3dada6_3cfdada2",
        "filename": "modules/rtp_rtcp/source/rtp_depacketizer_av1.cc",
        "patchSetId": 3
      },
      "lineNbr": 134,
      "author": {
        "id": 5527
      },
      "writtenOn": "2019-11-13T11:55:39Z",
      "side": 1,
      "message": "I don\u0027t like this at all...\n\nWhy not look at the marker bit (other than it not yet being specified to end a frame).",
      "range": {
        "startLine": 126,
        "startChar": 0,
        "endLine": 134,
        "endChar": 47
      },
      "revId": "7c19f29f94d8bc27465f033adaf9e9be272b6b47",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bc9c87dc_e5e41d72",
        "filename": "modules/rtp_rtcp/source/rtp_depacketizer_av1.cc",
        "patchSetId": 3
      },
      "lineNbr": 134,
      "author": {
        "id": 5019
      },
      "writtenOn": "2019-11-13T13:16:58Z",
      "side": 1,
      "message": "e.g. because marker bit is not available here (only rtp_payload is passed).\n\nAre you aware of any place in pipeline that would definitely break when \u0027subframe\u0027 are passed?\nI would prefer to postpone implementing better logic until finding out this simple one doesn\u0027t work.\n\nReasons better logic is far from trivial are current interfaces: there is no way to say \u0027may be first packet in frame or may be last packet in frame\u0027. PacketBuffer also doesn\u0027t have codec-agnostic logic to detect frame boundaries (specially beginning of the frame).\n\nWhen that logic is in place, when interface changed so that this [kind] of class can pass \u0027may be first packet in frame\u0027, Then yes, then there will be no need to rely so heavily on these two flags.",
      "parentUuid": "2c3dada6_3cfdada2",
      "range": {
        "startLine": 126,
        "startChar": 0,
        "endLine": 134,
        "endChar": 47
      },
      "revId": "7c19f29f94d8bc27465f033adaf9e9be272b6b47",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e05845d2_6656dc7a",
        "filename": "modules/rtp_rtcp/source/rtp_depacketizer_av1.h",
        "patchSetId": 3
      },
      "lineNbr": 21,
      "author": {
        "id": 5527
      },
      "writtenOn": "2019-11-13T11:55:39Z",
      "side": 1,
      "message": "WDYT about instead of implementing an RtpDepacketizer, we implement a \"RtpPayloadFrameBoundFinder\" or something like that. It\u0027s only purpose is to figure out if:\n1. There is a start bit.\n2. If so, what the value of the start bit is.\n3. What the value of the end bit is (always assume M bit is used for this).",
      "range": {
        "startLine": 21,
        "startChar": 34,
        "endLine": 21,
        "endChar": 49
      },
      "revId": "7c19f29f94d8bc27465f033adaf9e9be272b6b47",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "977fcfd0_f5c9d969",
        "filename": "modules/rtp_rtcp/source/rtp_depacketizer_av1.h",
        "patchSetId": 3
      },
      "lineNbr": 21,
      "author": {
        "id": 5019
      },
      "writtenOn": "2019-11-13T13:16:58Z",
      "side": 1,
      "message": "I agree that would be nicer in the end, I have some ideas how to move into that direction,\nbut I do not see how to integrate such a class into current pipeline (without adding many hacks).",
      "parentUuid": "e05845d2_6656dc7a",
      "range": {
        "startLine": 21,
        "startChar": 34,
        "endLine": 21,
        "endChar": 49
      },
      "revId": "7c19f29f94d8bc27465f033adaf9e9be272b6b47",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    }
  ]
}