{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "c6c8906c_6a92ddc9",
        "filename": "pc/peer_connection_encodings_integrationtest.cc",
        "patchSetId": 11
      },
      "lineNbr": 434,
      "author": {
        "id": 5142
      },
      "writtenOn": "2024-02-02T07:45:13Z",
      "side": 1,
      "message": "While having the remote asking for VP8 makes this test more clear in the way it triggers the fallback, it also hides a regression that I think we need to fix before landing this CL.\n\nThe following should PASS. I suggest a new test for the following steps:\n\n1. pc1 setCodecPreferences(VP8).\n2. pc1 setParameters(L3T3_KEY) -- should work, but with the current CL fails.\n3. Negotiate and have pc2 setCodecPreferences(VP9) before SRD answer.\n4. pc1 is sending VP9 L3T3_KEY.\n\nA test that does all four steps is ideal, but even just doing steps 1 and 2 and asserting that SetParameters does not reject would give enough test coverage IMO.\n\nWe have a separate test that ensures SetParameters() fails if we attempt L3T3_KEY *after* we have negotiated the codecs and rules out VP9 which is Good. But the problem I\u0027m trying to highlight here is that we shouldn\u0027t refuse to do L3T3_KEY *before* we know if pc2 wants VP9 or not.\n\nThis is important for the unidirectional use case IMO because otherwise we have to flip-flop between scalabilityModes we don\u0027t want.",
      "revId": "ffab6d4db0d22b34ddabefcc1d3b95ff8f496302",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e1263369_5dfd8278",
        "filename": "pc/peer_connection_encodings_integrationtest.cc",
        "patchSetId": 11
      },
      "lineNbr": 434,
      "author": {
        "id": 19549
      },
      "writtenOn": "2024-02-02T08:15:17Z",
      "side": 1,
      "message": "This isn\u0027t a regression in the sense \"used to work, now broken\" but a change in behavior - \"used to fail, now works\".\nStep 2 works with this CL but was rejecting before.\nFollowed by negotiation it results in VP8 with L1T2.\n\nDoing the test you propose requires SDP trickery along the lines of webrtc/protocol/additional-codecs.html\nNot impossible but... somewhat sdp mungy.",
      "parentUuid": "c6c8906c_6a92ddc9",
      "revId": "ffab6d4db0d22b34ddabefcc1d3b95ff8f496302",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d6f5779d_dcb6b4f3",
        "filename": "pc/peer_connection_encodings_integrationtest.cc",
        "patchSetId": 11
      },
      "lineNbr": 434,
      "author": {
        "id": 5142
      },
      "writtenOn": "2024-02-02T08:26:00Z",
      "side": 1,
      "message": "If you just do Step 1 and Step 2 it doesn\u0027t require any trickery and is a quite small test.\n\nDo we agree that doing setParameters(L3T3_KEY) should work *prior* to negotiation, even if we\u0027re only preferring to *receive* VP8?\n\nAnd am I understanding that with this CL, Step 2 goes from working to not working?",
      "parentUuid": "e1263369_5dfd8278",
      "revId": "ffab6d4db0d22b34ddabefcc1d3b95ff8f496302",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a4c40e1e_61c8e6ac",
        "filename": "pc/peer_connection_encodings_integrationtest.cc",
        "patchSetId": 11
      },
      "lineNbr": 434,
      "author": {
        "id": 5142
      },
      "writtenOn": "2024-02-02T09:12:44Z",
      "side": 1,
      "message": "Hey, what I thought broke actually works! Tested here:\nhttps://webrtc-review.googlesource.com/c/src/+/337500/1..2\n\nCan you add this test to this CL? ðŸ˜Š It passes",
      "parentUuid": "d6f5779d_dcb6b4f3",
      "revId": "ffab6d4db0d22b34ddabefcc1d3b95ff8f496302",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8517a2b4_399b6a94",
        "filename": "pc/peer_connection_encodings_integrationtest.cc",
        "patchSetId": 11
      },
      "lineNbr": 434,
      "author": {
        "id": 19549
      },
      "writtenOn": "2024-02-02T09:15:22Z",
      "side": 1,
      "message": "No, Step 2 goes from \"not working currently\" to \"works\".\nAdded a slightly more extensive test in PS13",
      "parentUuid": "d6f5779d_dcb6b4f3",
      "revId": "ffab6d4db0d22b34ddabefcc1d3b95ff8f496302",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "666966b6_d23fc348",
        "filename": "pc/peer_connection_encodings_integrationtest.cc",
        "patchSetId": 11
      },
      "lineNbr": 434,
      "author": {
        "id": 5142
      },
      "writtenOn": "2024-02-02T09:30:19Z",
      "side": 1,
      "message": "Oh amazing, that was the misunderstanding. Yes it works and our new test prove it! Not concerned anymore.",
      "parentUuid": "8517a2b4_399b6a94",
      "revId": "ffab6d4db0d22b34ddabefcc1d3b95ff8f496302",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    }
  ]
}