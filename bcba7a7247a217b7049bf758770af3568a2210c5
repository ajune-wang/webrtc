{
  "comments": [
    {
      "key": {
        "uuid": "a1282be9_88052c34",
        "filename": "sdk/objc/Framework/Classes/PeerConnection/RTCCameraVideoCapturer.m",
        "patchSetId": 2
      },
      "lineNbr": 53,
      "author": {
        "id": 5520
      },
      "writtenOn": "2018-01-18T14:47:03Z",
      "side": 1,
      "message": "Maybe add a comment that this is not part of the public interface and used for testing.",
      "range": {
        "startLine": 53,
        "startChar": 16,
        "endLine": 53,
        "endChar": 32
      },
      "revId": "bcba7a7247a217b7049bf758770af3568a2210c5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b1006a34_38659bf5",
        "filename": "sdk/objc/Framework/Classes/PeerConnection/RTCCameraVideoCapturer.m",
        "patchSetId": 2
      },
      "lineNbr": 154,
      "author": {
        "id": 5520
      },
      "writtenOn": "2018-01-18T14:47:03Z",
      "side": 1,
      "message": "this is a functional change, right? Was this caught by the tests or just careful observation?",
      "range": {
        "startLine": 154,
        "startChar": 24,
        "endLine": 154,
        "endChar": 38
      },
      "revId": "bcba7a7247a217b7049bf758770af3568a2210c5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6b2fdf75_3acd2851",
        "filename": "sdk/objc/Framework/UnitTests/RTCCameraVideoCapturerTests.mm",
        "patchSetId": 2
      },
      "lineNbr": 374,
      "author": {
        "id": 5027
      },
      "writtenOn": "2018-01-18T11:16:10Z",
      "side": 1,
      "message": "Nit: end comment with .\n\nNot sure if the comment is that useful, is it?",
      "range": {
        "startLine": 374,
        "startChar": 2,
        "endLine": 374,
        "endChar": 28
      },
      "revId": "bcba7a7247a217b7049bf758770af3568a2210c5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "dabfff0a_60c42335",
        "filename": "sdk/objc/Framework/UnitTests/RTCCameraVideoCapturerTests.mm",
        "patchSetId": 2
      },
      "lineNbr": 374,
      "author": {
        "id": 5249
      },
      "writtenOn": "2018-01-18T12:27:09Z",
      "side": 1,
      "message": "Yeah maybe not that useful, removed it.",
      "parentUuid": "6b2fdf75_3acd2851",
      "range": {
        "startLine": 374,
        "startChar": 2,
        "endLine": 374,
        "endChar": 28
      },
      "revId": "bcba7a7247a217b7049bf758770af3568a2210c5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fd0c2aad_44ba36b4",
        "filename": "sdk/objc/Framework/UnitTests/RTCCameraVideoCapturerTests.mm",
        "patchSetId": 2
      },
      "lineNbr": 386,
      "author": {
        "id": 5027
      },
      "writtenOn": "2018-01-18T11:16:10Z",
      "side": 1,
      "message": "Nit: comments always end with . (apply throughout)",
      "range": {
        "startLine": 386,
        "startChar": 69,
        "endLine": 386,
        "endChar": 83
      },
      "revId": "bcba7a7247a217b7049bf758770af3568a2210c5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b4df7e82_ac4f792a",
        "filename": "sdk/objc/Framework/UnitTests/RTCCameraVideoCapturerTests.mm",
        "patchSetId": 2
      },
      "lineNbr": 386,
      "author": {
        "id": 5249
      },
      "writtenOn": "2018-01-18T12:27:09Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "fd0c2aad_44ba36b4",
      "range": {
        "startLine": 386,
        "startChar": 69,
        "endLine": 386,
        "endChar": 83
      },
      "revId": "bcba7a7247a217b7049bf758770af3568a2210c5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "436cfc56_a066e322",
        "filename": "sdk/objc/Framework/UnitTests/RTCCameraVideoCapturerTests.mm",
        "patchSetId": 2
      },
      "lineNbr": 387,
      "author": {
        "id": 5027
      },
      "writtenOn": "2018-01-18T11:16:10Z",
      "side": 1,
      "message": "Perhaps call inputMock expectedDeviceMock to make clear it\u0027s the expected device.",
      "range": {
        "startLine": 387,
        "startChar": 33,
        "endLine": 387,
        "endChar": 54
      },
      "revId": "bcba7a7247a217b7049bf758770af3568a2210c5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d3f99b9b_d9fef879",
        "filename": "sdk/objc/Framework/UnitTests/RTCCameraVideoCapturerTests.mm",
        "patchSetId": 2
      },
      "lineNbr": 387,
      "author": {
        "id": 5249
      },
      "writtenOn": "2018-01-18T12:27:09Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "436cfc56_a066e322",
      "range": {
        "startLine": 387,
        "startChar": 33,
        "endLine": 387,
        "endChar": 54
      },
      "revId": "bcba7a7247a217b7049bf758770af3568a2210c5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a0678fd_d8d8f993",
        "filename": "sdk/objc/Framework/UnitTests/RTCCameraVideoCapturerTests.mm",
        "patchSetId": 2
      },
      "lineNbr": 396,
      "author": {
        "id": 5027
      },
      "writtenOn": "2018-01-18T11:16:10Z",
      "side": 1,
      "message": "This looks like something that could go flaky. 0.1 (seconds, I assume?) is nothing. What guarantees do we have that the worker thread finishes its work this quickly?",
      "range": {
        "startLine": 396,
        "startChar": 2,
        "endLine": 396,
        "endChar": 50
      },
      "revId": "bcba7a7247a217b7049bf758770af3568a2210c5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6339b74f_3e0a8b77",
        "filename": "sdk/objc/Framework/UnitTests/RTCCameraVideoCapturerTests.mm",
        "patchSetId": 2
      },
      "lineNbr": 396,
      "author": {
        "id": 5249
      },
      "writtenOn": "2018-01-18T12:27:09Z",
      "side": 1,
      "message": "I just tried something small to see if it worked, but of course it could turn flaky. The WAIT() calls in existing tests in this file looks like they use one second, so I switch to 1. Sounds good?",
      "parentUuid": "9a0678fd_d8d8f993",
      "range": {
        "startLine": 396,
        "startChar": 2,
        "endLine": 396,
        "endChar": 50
      },
      "revId": "bcba7a7247a217b7049bf758770af3568a2210c5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "adab8559_c0bcd258",
        "filename": "sdk/objc/Framework/UnitTests/RTCCameraVideoCapturerTests.mm",
        "patchSetId": 2
      },
      "lineNbr": 396,
      "author": {
        "id": 5027
      },
      "writtenOn": "2018-01-18T12:54:49Z",
      "side": 1,
      "message": "I\u0027d make it 15 seconds. That\u0027s the default \"action timeout\" in chromium tests, and I think that\u0027s a reasonable number.\n\nhttp://ocmock.org/reference/ suggests the delay in OCMVerifyAllWithDelay is the _maximum_ time it will wait, so it doesn\u0027t hurt too much to increase it. Yeah, tests will fail slower but my experience is it\u0027s more annoying and time-consuming with flakes and having to bump the timeout.",
      "parentUuid": "6339b74f_3e0a8b77",
      "range": {
        "startLine": 396,
        "startChar": 2,
        "endLine": 396,
        "endChar": 50
      },
      "revId": "bcba7a7247a217b7049bf758770af3568a2210c5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "dba0e721_764b4b0c",
        "filename": "sdk/objc/Framework/UnitTests/RTCCameraVideoCapturerTests.mm",
        "patchSetId": 2
      },
      "lineNbr": 400,
      "author": {
        "id": 5027
      },
      "writtenOn": "2018-01-18T11:16:10Z",
      "side": 1,
      "message": "What should happen if that fails? This test exercises the code path but doesn\u0027t verify anything as far I can see. That could be acceptable, but is there a return value we can verify? If not, we can perhaps verify a mock doesn\u0027t get called.",
      "range": {
        "startLine": 400,
        "startChar": 2,
        "endLine": 400,
        "endChar": 85
      },
      "revId": "bcba7a7247a217b7049bf758770af3568a2210c5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7fb751ab_378c7587",
        "filename": "sdk/objc/Framework/UnitTests/RTCCameraVideoCapturerTests.mm",
        "patchSetId": 2
      },
      "lineNbr": 400,
      "author": {
        "id": 5249
      },
      "writtenOn": "2018-01-18T12:27:09Z",
      "side": 1,
      "message": "The captureSessionMock is a strict mock, so if the code does not return when it fails to lock the test will crash with `Terminating app due to uncaught exception \u0027NSInternalInconsistencyException\u0027, reason: \u0027OCMockObject(AVCaptureSession): unexpected method invoked: startRunning\u0027`\nI don\u0027t know of a better way with this framework to make sure something is not called. Maybe there is one? I\u0027ll add a comment to make this clear.",
      "parentUuid": "dba0e721_764b4b0c",
      "range": {
        "startLine": 400,
        "startChar": 2,
        "endLine": 400,
        "endChar": 85
      },
      "revId": "bcba7a7247a217b7049bf758770af3568a2210c5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7b84577d_62c4849b",
        "filename": "sdk/objc/Framework/UnitTests/RTCCameraVideoCapturerTests.mm",
        "patchSetId": 2
      },
      "lineNbr": 400,
      "author": {
        "id": 5027
      },
      "writtenOn": "2018-01-18T12:54:49Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "7fb751ab_378c7587",
      "range": {
        "startLine": 400,
        "startChar": 2,
        "endLine": 400,
        "endChar": 85
      },
      "revId": "bcba7a7247a217b7049bf758770af3568a2210c5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "db019a5c_ce7b9b87",
        "filename": "sdk/objc/Framework/UnitTests/RTCCameraVideoCapturerTests.mm",
        "patchSetId": 2
      },
      "lineNbr": 432,
      "author": {
        "id": 5027
      },
      "writtenOn": "2018-01-18T11:16:10Z",
      "side": 1,
      "message": "This is nice, however the test will pass if the completionHandler is not called at all (for instance because of a bug). Do you verify the completionHandler is actually called elsewhere? Otherwise do a check like you do for the the stop completion handler.",
      "range": {
        "startLine": 432,
        "startChar": 24,
        "endLine": 432,
        "endChar": 46
      },
      "revId": "bcba7a7247a217b7049bf758770af3568a2210c5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d9839e44_84417394",
        "filename": "sdk/objc/Framework/UnitTests/RTCCameraVideoCapturerTests.mm",
        "patchSetId": 2
      },
      "lineNbr": 432,
      "author": {
        "id": 5249
      },
      "writtenOn": "2018-01-18T12:27:09Z",
      "side": 1,
      "message": "Yes, good catch.",
      "parentUuid": "db019a5c_ce7b9b87",
      "range": {
        "startLine": 432,
        "startChar": 24,
        "endLine": 432,
        "endChar": 46
      },
      "revId": "bcba7a7247a217b7049bf758770af3568a2210c5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7a2b64e8_f3e57c5e",
        "filename": "sdk/objc/Framework/UnitTests/RTCCameraVideoCapturerTests.mm",
        "patchSetId": 2
      },
      "lineNbr": 469,
      "author": {
        "id": 5027
      },
      "writtenOn": "2018-01-18T11:16:10Z",
      "side": 1,
      "message": "This is a recipe for flakiness, at least if this is a hard one-second wait. I don\u0027t know how to do this in objc, but in Java you would do something like\n\nCountdownLatch latch \u003d new CountdownLatch(1);\n\n...\n   callback() {\n     latch.countDown();\n   }\n...\nlatch.await();\n\nWith your current implementation, the test passes equally well if the completion handler is never called, right?",
      "range": {
        "startLine": 469,
        "startChar": 2,
        "endLine": 469,
        "endChar": 16
      },
      "revId": "bcba7a7247a217b7049bf758770af3568a2210c5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "33541557_eaa4dc93",
        "filename": "sdk/objc/Framework/UnitTests/RTCCameraVideoCapturerTests.mm",
        "patchSetId": 2
      },
      "lineNbr": 469,
      "author": {
        "id": 5249
      },
      "writtenOn": "2018-01-18T12:27:09Z",
      "side": 1,
      "message": "I used WAIT() to copy the style from existing tests but I agree it feels primitive. I replaced it with dispatch_semaphore when using the methods with callbacks. I used 1 second as timeout in case the semaphore is never signalled, maybe this should be higher?",
      "parentUuid": "7a2b64e8_f3e57c5e",
      "range": {
        "startLine": 469,
        "startChar": 2,
        "endLine": 469,
        "endChar": 16
      },
      "revId": "bcba7a7247a217b7049bf758770af3568a2210c5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fb35646f_8f492bb0",
        "filename": "sdk/objc/Framework/UnitTests/RTCCameraVideoCapturerTests.mm",
        "patchSetId": 2
      },
      "lineNbr": 469,
      "author": {
        "id": 5027
      },
      "writtenOn": "2018-01-18T12:54:49Z",
      "side": 1,
      "message": "Yeah, 15 seconds. Nice, this is much better!",
      "parentUuid": "33541557_eaa4dc93",
      "range": {
        "startLine": 469,
        "startChar": 2,
        "endLine": 469,
        "endChar": 16
      },
      "revId": "bcba7a7247a217b7049bf758770af3568a2210c5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": false
    }
  ]
}