{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "6e5861e4_85c7cefa",
        "filename": "media/engine/webrtc_voice_engine_unittest.cc",
        "patchSetId": 2
      },
      "lineNbr": 795,
      "author": {
        "id": 5119
      },
      "writtenOn": "2022-01-17T07:18:31Z",
      "side": 1,
      "message": "Have you found a way to verify that this works? The tests check that IsTypingDetectionEnabled() is true or false in different cases.\n\nOne solution is to rename:\nbool IsTypingDetectionEnabled()\n--\u003e void VerifyTypingDetectionEnabled(bool enabled)\n.. and then `#ifdef return false` should work for Android.\n\nI recognize that getting rtc_media_unittests running on Android is more important than having this one particular test on Android.\nFeel free to make the failing things in here _DISABLED on Android, and I or Per will have to sort out the bug when we can prioritize it.",
      "range": {
        "startLine": 793,
        "startChar": 0,
        "endLine": 795,
        "endChar": 5
      },
      "revId": "43896bd2f1b9e122660746f07fedf19d9e9c9179",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "33dd795a_05887738",
        "filename": "media/engine/webrtc_voice_engine_unittest.cc",
        "patchSetId": 2
      },
      "lineNbr": 795,
      "author": {
        "id": 6192
      },
      "writtenOn": "2022-01-17T15:17:29Z",
      "side": 1,
      "message": "One question, is it only the default that is false/off on Android and it\u0027s possible to activate if requested, or can it not be activated at all?",
      "parentUuid": "6e5861e4_85c7cefa",
      "range": {
        "startLine": 793,
        "startChar": 0,
        "endLine": 795,
        "endChar": 5
      },
      "revId": "43896bd2f1b9e122660746f07fedf19d9e9c9179",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "834b6b24_604956d7",
        "filename": "media/engine/webrtc_voice_engine_unittest.cc",
        "patchSetId": 2
      },
      "lineNbr": 795,
      "author": {
        "id": 5119
      },
      "writtenOn": "2022-01-17T16:06:55Z",
      "side": 1,
      "message": "It cannot be activated at all on Android. (The feature is intentionally not available.)\n\nWebRtcVoiceEngine::ApplyOptions overrides any provided value for it on Android:\n\nhttps://source.chromium.org/chromium/chromium/src/+/main:third_party/webrtc/media/engine/webrtc_voice_engine.cc;l\u003d463-467;drc\u003d94f0194d5a24c31ea80aeff7c8ff0c05668418e9\n\n\nThe default settings seem to enable it by default on Android, but (by the above) the setting is still overridden to `false` upon application.\n\nhttps://source.chromium.org/chromium/chromium/src/+/main:third_party/webrtc/media/engine/webrtc_voice_engine.cc;l\u003d393-416;drc\u003d94f0194d5a24c31ea80aeff7c8ff0c05668418e9\n\n\n\n..so apm_config_.voice_detection.enabled will always end up `false` on Android. Since the tests currently expect it to sometimes be `true` on all platforms, either\n1. - this function needs to start lying (void VerifyTypingDetection(bool) #ifdef to always succeed on Android), or\n2. - the tests need to change their expectations to always EXPECT_FALSE(IsTypingDetectionEnabled()) on Android, or\n3. - the voice engine itself must apply exactly the settings requested by the tests, and remove support for Android typing detection in some other way.\n\n#1 is what I mentioned in my comment above.",
      "parentUuid": "33dd795a_05887738",
      "range": {
        "startLine": 793,
        "startChar": 0,
        "endLine": 795,
        "endChar": 5
      },
      "revId": "43896bd2f1b9e122660746f07fedf19d9e9c9179",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ed6b337b_30f1b298",
        "filename": "media/engine/webrtc_voice_engine_unittest.cc",
        "patchSetId": 2
      },
      "lineNbr": 795,
      "author": {
        "id": 6192
      },
      "writtenOn": "2022-01-18T12:44:38Z",
      "side": 1,
      "message": "Thanks for the thorough answer and I now understand better. I think it\u0027s better to clearly state the expectations for a platform at the expectation itself rather than hiding it in a helper method/function.\n\nWDYT?",
      "parentUuid": "834b6b24_604956d7",
      "range": {
        "startLine": 793,
        "startChar": 0,
        "endLine": 795,
        "endChar": 5
      },
      "revId": "43896bd2f1b9e122660746f07fedf19d9e9c9179",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f6d33fbb_1346ab58",
        "filename": "media/engine/webrtc_voice_engine_unittest.cc",
        "patchSetId": 2
      },
      "lineNbr": 795,
      "author": {
        "id": 5119
      },
      "writtenOn": "2022-01-18T13:18:26Z",
      "side": 1,
      "message": "Sounds good. I had expected option #2 to be messier than what it is. lgtm!",
      "parentUuid": "ed6b337b_30f1b298",
      "range": {
        "startLine": 793,
        "startChar": 0,
        "endLine": 795,
        "endChar": 5
      },
      "revId": "43896bd2f1b9e122660746f07fedf19d9e9c9179",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    }
  ]
}