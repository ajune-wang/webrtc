{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "0cfa05dd_bf633195",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 8046
      },
      "writtenOn": "2022-02-09T16:26:34Z",
      "side": 1,
      "message": "Same change as before, I just had to drop dependency on libwayland-client, which was causing a crash when \"rtc_link_pipewire\u003dtrue\" was used.\n\nThis was because:\n1) Chromium already has a copy of libwayland-client and dlopens it\n2) This probably caused rtc_link_pipewire not to link against it since it is dlopened in Chromium\n3) Then when it was used in WebRTC, it was not linked against it and not even dlopened because of \"rtc_link_pipewire\" and for that reason generated stubs from Chromium were used, but they were not initialized because Chromium probably dlopens libwayland-client only in case wayland backend is used and therefore \"wl_display_connect\" was nullptr.\n\nAnyway, this shouldn\u0027t be a problem, because (from documentation):\nTo obtain an EGLDisplay backed by a Wayland display, call with \u003cplatform\u003e set to EGL_PLATFORM_WAYLAND_KHR.  The native_display\u003e parameter specifies the Wayland display  to use and must point to a `struct wl_display` or be EGL_DEFAULT_DISPLAY. If native_display\u003e is EGL_DEFAULT_DISPLAY, then EGL will create a new structure by connecting to the default Wayland socket.  The page wl_display_connect(3) defines the location of the default socket.\n\nSo it does the same thing, just internally so we don\u0027t have to take care of getting wl_display on our side.",
      "revId": "34f617d448a510653215419619ddb38294ab19ea",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5aac188f_17a43be7",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 8046
      },
      "writtenOn": "2022-02-10T07:43:28Z",
      "side": 1,
      "message": "FYI: I found this issue when backporting this change to Chromium in Flathub, where \"is_official_build\u003dtrue,rtc_link_pipewire\u003dtrue\" is used. Then I managed to reproduce locally since I didn\u0027t get anything useful from the backtrace there.\n\nWith this change as it is now I can confirm it works both locally and even in Chromium from Flathub.",
      "parentUuid": "0cfa05dd_bf633195",
      "revId": "34f617d448a510653215419619ddb38294ab19ea",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "35e47ad1_97f9bea2",
        "filename": "modules/desktop_capture/linux/wayland/egl_dmabuf.cc",
        "patchSetId": 7
      },
      "lineNbr": 295,
      "author": {
        "id": 14134
      },
      "writtenOn": "2022-02-10T20:03:43Z",
      "side": 1,
      "message": "Is it necessary to call LoadEGL() and LoadGL() each time the EglDmaBuf constructor is called (which looks to be once per desktop capture session)?",
      "revId": "34f617d448a510653215419619ddb38294ab19ea",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c67710e4_0a34e4aa",
        "filename": "modules/desktop_capture/linux/wayland/egl_dmabuf.cc",
        "patchSetId": 7
      },
      "lineNbr": 295,
      "author": {
        "id": 8046
      },
      "writtenOn": "2022-02-10T21:14:37Z",
      "side": 1,
      "message": "In an ideal world I would use a library for this, e.g. libepoxy, but that makes things complicated. I think we would have to move it somewhere that survives desktop capture sessions.",
      "parentUuid": "35e47ad1_97f9bea2",
      "revId": "34f617d448a510653215419619ddb38294ab19ea",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "7c7be816_62ec91f1",
        "filename": "modules/desktop_capture/linux/wayland/egl_dmabuf.cc",
        "patchSetId": 7
      },
      "lineNbr": 295,
      "author": {
        "id": 8046
      },
      "writtenOn": "2022-02-11T07:06:24Z",
      "side": 1,
      "message": "Btw. PipeWire and libdrm are also loaded same way for every desktop capture session, just that the code is generated and not written manually, but it does the very same thing.",
      "parentUuid": "c67710e4_0a34e4aa",
      "revId": "34f617d448a510653215419619ddb38294ab19ea",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2e1e1098_70a69b21",
        "filename": "modules/desktop_capture/linux/wayland/egl_dmabuf.cc",
        "patchSetId": 7
      },
      "lineNbr": 372,
      "author": {
        "id": 14134
      },
      "writtenOn": "2022-02-10T20:03:43Z",
      "side": 1,
      "message": "Do you need to close drm_fd_ before returning?",
      "revId": "34f617d448a510653215419619ddb38294ab19ea",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b258d658_845561e2",
        "filename": "modules/desktop_capture/linux/wayland/egl_dmabuf.cc",
        "patchSetId": 7
      },
      "lineNbr": 372,
      "author": {
        "id": 8046
      },
      "writtenOn": "2022-02-10T21:14:37Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "2e1e1098_70a69b21",
      "revId": "34f617d448a510653215419619ddb38294ab19ea",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "848097ab_d5853304",
        "filename": "modules/desktop_capture/linux/wayland/egl_dmabuf.cc",
        "patchSetId": 7
      },
      "lineNbr": 409,
      "author": {
        "id": 14134
      },
      "writtenOn": "2022-02-10T20:03:43Z",
      "side": 1,
      "message": "Guaranteed not to be nullptr?",
      "revId": "34f617d448a510653215419619ddb38294ab19ea",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ac013a85_8057f0a4",
        "filename": "modules/desktop_capture/linux/wayland/egl_dmabuf.cc",
        "patchSetId": 7
      },
      "lineNbr": 409,
      "author": {
        "id": 8046
      },
      "writtenOn": "2022-02-10T21:14:37Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "848097ab_d5853304",
      "revId": "34f617d448a510653215419619ddb38294ab19ea",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ba8c950f_25cdf031",
        "filename": "modules/desktop_capture/linux/wayland/egl_dmabuf.cc",
        "patchSetId": 7
      },
      "lineNbr": 416,
      "author": {
        "id": 14134
      },
      "writtenOn": "2022-02-10T20:03:43Z",
      "side": 1,
      "message": "|extension| is already a std::string.",
      "revId": "34f617d448a510653215419619ddb38294ab19ea",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6e25e616_cd58a952",
        "filename": "modules/desktop_capture/linux/wayland/egl_dmabuf.cc",
        "patchSetId": 7
      },
      "lineNbr": 416,
      "author": {
        "id": 8046
      },
      "writtenOn": "2022-02-10T21:14:37Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "ba8c950f_25cdf031",
      "revId": "34f617d448a510653215419619ddb38294ab19ea",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e6fff786_632ea9b4",
        "filename": "modules/desktop_capture/linux/wayland/egl_dmabuf.cc",
        "patchSetId": 7
      },
      "lineNbr": 417,
      "author": {
        "id": 14134
      },
      "writtenOn": "2022-02-10T20:03:43Z",
      "side": 1,
      "message": "This code looks very similar to the code from 307-324.   Can you factor out a helper function?",
      "revId": "34f617d448a510653215419619ddb38294ab19ea",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "064bc174_aeae6331",
        "filename": "modules/desktop_capture/linux/wayland/egl_dmabuf.cc",
        "patchSetId": 7
      },
      "lineNbr": 417,
      "author": {
        "id": 8046
      },
      "writtenOn": "2022-02-10T21:14:37Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "e6fff786_632ea9b4",
      "revId": "34f617d448a510653215419619ddb38294ab19ea",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7c1ea0f9_55b965a7",
        "filename": "modules/desktop_capture/linux/wayland/egl_dmabuf.cc",
        "patchSetId": 7
      },
      "lineNbr": 446,
      "author": {
        "id": 14134
      },
      "writtenOn": "2022-02-10T20:03:43Z",
      "side": 1,
      "message": "Does this always close drm_fd_?",
      "revId": "34f617d448a510653215419619ddb38294ab19ea",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "0b45c83f_dc6e9baa",
        "filename": "modules/desktop_capture/linux/wayland/egl_dmabuf.cc",
        "patchSetId": 7
      },
      "lineNbr": 446,
      "author": {
        "id": 8046
      },
      "writtenOn": "2022-02-10T21:14:37Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "7c1ea0f9_55b965a7",
      "revId": "34f617d448a510653215419619ddb38294ab19ea",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    }
  ]
}