{
  "comments": [
    {
      "key": {
        "uuid": "d1ef6863_19477fc0",
        "filename": "rtc_base/event_tracer_unittest.cc",
        "patchSetId": 7
      },
      "lineNbr": 38,
      "author": {
        "id": 5126
      },
      "writtenOn": "2019-09-06T02:25:13Z",
      "side": 1,
      "message": "Don\u0027t do this---the runtime will try to run ~TestStatistics on program shutdown. Instead, do something like this:\n\n  static TestStatistics* const test_stats \u003d new TestStatistics();\n  return test_stats;\n\nor this:\n\n  static TestStatistics\u0026 test_stats \u003d *new TestStatistics();\n  return \u0026test_stats;",
      "revId": "445fd424910b191fa2ec513b26f385a9b3dfed74",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a5f42f3b_f6c3fbc3",
        "filename": "rtc_base/event_tracer_unittest.cc",
        "patchSetId": 7
      },
      "lineNbr": 38,
      "author": {
        "id": 7332
      },
      "writtenOn": "2019-09-06T03:05:32Z",
      "side": 1,
      "message": "Done. Out of curiosity, why would it be an issue to destruct the object at shutdown time?",
      "parentUuid": "d1ef6863_19477fc0",
      "revId": "445fd424910b191fa2ec513b26f385a9b3dfed74",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "888cd1ac_40425884",
        "filename": "rtc_base/event_tracer_unittest.cc",
        "patchSetId": 7
      },
      "lineNbr": 38,
      "author": {
        "id": 5087
      },
      "writtenOn": "2019-09-06T07:38:26Z",
      "side": 1,
      "message": "Shouldn\u0027t -Wno-exit-time-destructors catch this? I was expecting some red bots.",
      "parentUuid": "a5f42f3b_f6c3fbc3",
      "revId": "445fd424910b191fa2ec513b26f385a9b3dfed74",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7bed7526_1b8f4230",
        "filename": "rtc_base/event_tracer_unittest.cc",
        "patchSetId": 7
      },
      "lineNbr": 38,
      "author": {
        "id": 5126
      },
      "writtenOn": "2019-09-06T07:46:45Z",
      "side": 1,
      "message": "Yes, TestStatistics is non-trivially-destructible due to its CriticalSection member.\n\nThe style guide explains it briefly [https://google.github.io/styleguide/cppguide.html#Static_and_Global_Variables], but the tl;dr is that it\u0027s too hard to reason about when those destructors run relative to everything else, so we risk accessing the globals after they\u0027ve been destroyed.",
      "parentUuid": "888cd1ac_40425884",
      "revId": "445fd424910b191fa2ec513b26f385a9b3dfed74",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "30294390_deb78bc0",
        "filename": "rtc_base/event_tracer_unittest.cc",
        "patchSetId": 7
      },
      "lineNbr": 38,
      "author": {
        "id": 7332
      },
      "writtenOn": "2019-09-06T07:57:45Z",
      "side": 1,
      "message": "I guess you meant -Wexit-time-destructors.\n\nIt is present in obj/rtc_base/rtc_base_approved.ninja,\nbut not in:      obj/rtc_base/rtc_base_approved_unittests.ninja",
      "parentUuid": "7bed7526_1b8f4230",
      "revId": "445fd424910b191fa2ec513b26f385a9b3dfed74",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a124a1ae_d45d158f",
        "filename": "rtc_base/event_tracer_unittest.cc",
        "patchSetId": 7
      },
      "lineNbr": 38,
      "author": {
        "id": 5087
      },
      "writtenOn": "2019-09-06T08:19:01Z",
      "side": 1,
      "message": "Yes. :)\n\nThis is why the diagnostic is not triggering: https://cs.chromium.org/chromium/src/third_party/webrtc/webrtc.gni?l\u003d467\u0026rcl\u003d2dac4e4e3577d1f61f7249df043d7ed1df7ec611.\n\nNot related to this CL, so case closed. :)\n\nShould we enable it also on test code?",
      "parentUuid": "30294390_deb78bc0",
      "revId": "445fd424910b191fa2ec513b26f385a9b3dfed74",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": false
    }
  ]
}