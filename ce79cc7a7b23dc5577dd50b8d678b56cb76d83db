{
  "comments": [
    {
      "key": {
        "uuid": "c6b79034_99ce907a",
        "filename": "rtc_base/task_queue_for_test.h",
        "patchSetId": 2
      },
      "lineNbr": 56,
      "author": {
        "id": 5126
      },
      "writtenOn": "2019-03-14T11:09:25Z",
      "side": 1,
      "message": "Why allow users to override SendTask? Isn\u0027t it enough if PostTask() runs the task synchronously?",
      "revId": "ce79cc7a7b23dc5577dd50b8d678b56cb76d83db",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8f39d74f_b33595bf",
        "filename": "rtc_base/task_queue_for_test.h",
        "patchSetId": 2
      },
      "lineNbr": 56,
      "author": {
        "id": 5531
      },
      "writtenOn": "2019-03-14T12:19:53Z",
      "side": 1,
      "message": "We can\u0027t always run PostTask synchronously since it can break synchronization guarantees. This triggers TSAN checks where locks are taken in varying order.\n\nThis can be alleviated by making calls made from TaskQueues async and other calls sync, but SendTask should be allowed to be called on a task queue, so in that situation we want to override the implementation.",
      "parentUuid": "c6b79034_99ce907a",
      "revId": "ce79cc7a7b23dc5577dd50b8d678b56cb76d83db",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fc5e3d4b_c500d8e2",
        "filename": "rtc_base/task_queue_for_test.h",
        "patchSetId": 2
      },
      "lineNbr": 56,
      "author": {
        "id": 5126
      },
      "writtenOn": "2019-03-15T09:24:59Z",
      "side": 1,
      "message": "\u003e We can\u0027t always run PostTask synchronously since it can break synchronization guarantees. This triggers TSAN checks where locks are taken in varying order.\n\nCan you give an example? This sounds like exactly the sort of thing we concluded couldn\u0027t (or shouldn\u0027t) happen when Danil proposed running tasks synchronously.\n\n\u003e This can be alleviated by making calls made from TaskQueues async and other calls sync, but SendTask should be allowed to be called on a task queue, so in that situation we want to override the implementation.\n\nHmm---how does this solve the problem? That is, what does the injected sender_ function do?",
      "parentUuid": "8f39d74f_b33595bf",
      "revId": "ce79cc7a7b23dc5577dd50b8d678b56cb76d83db",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": false
    }
  ]
}