{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "c3f3fdbf_a5472575",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 28
      },
      "lineNbr": 0,
      "author": {
        "id": 18829
      },
      "writtenOn": "2022-03-30T14:26:07Z",
      "side": 1,
      "message": "Requesting Mirko to review the changes in modules/desktop_capture/BUILD.gn. This is a roll forward of a previously reviewed CL that caused compilation error for `cast_shell_linux` check in chrome. Summary of changes from the previously submitted and reverted CL can be found here: https://webrtc-review.googlesource.com/c/src/+/257000/1..27/. Please let me know if any other checks will be good to run before submitting this CL so as to not affect any builds.",
      "revId": "b392ce62321f60fc0b2f42df5e1cf1095c73358b",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f7dd102d_67864715",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 28
      },
      "lineNbr": 0,
      "author": {
        "id": 5087
      },
      "writtenOn": "2022-03-30T15:17:10Z",
      "side": 1,
      "message": "BUILD.gn LGTM.\n\nI think this is fine, the only real check would be to create a Chromium CL and run trybots on it to ensure it will not break the roll, but that happens daily so my advice is to land as is and see.\n\nIf this breaks something in Chromium post-submit there is no easy way to know now.",
      "parentUuid": "c3f3fdbf_a5472575",
      "revId": "b392ce62321f60fc0b2f42df5e1cf1095c73358b",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "7ec2c520_981a4f45",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 28
      },
      "lineNbr": 0,
      "author": {
        "id": 18829
      },
      "writtenOn": "2022-03-30T15:25:04Z",
      "side": 1,
      "message": "Appreciate the guidance. I will try it out.",
      "parentUuid": "f7dd102d_67864715",
      "revId": "b392ce62321f60fc0b2f42df5e1cf1095c73358b",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e2fcea74_08f8ce67",
        "filename": "modules/desktop_capture/desktop_capture_metadata.h",
        "patchSetId": 28
      },
      "lineNbr": 14,
      "author": {
        "id": 18474
      },
      "writtenOn": "2022-03-30T17:31:41Z",
      "side": 1,
      "message": "I don\u0027t love this, because there are other .cc files that *also* include gio and this header isn\u0027t in a build-guard for it in BUILD.gn.\n\nI\u0027m okay to land this as-is for now; but please file a bug to help figure out why cast_shell_linux overrode WEBRTC_USE_PIPEWIRE in what I\u0027d argue is an unsupported way (and perhaps tag either the config or this #define with that bug)",
      "range": {
        "startLine": 14,
        "startChar": 33,
        "endLine": 14,
        "endChar": 59
      },
      "revId": "b392ce62321f60fc0b2f42df5e1cf1095c73358b",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "32097f29_389b4ad8",
        "filename": "modules/desktop_capture/desktop_capture_metadata.h",
        "patchSetId": 28
      },
      "lineNbr": 14,
      "author": {
        "id": 18829
      },
      "writtenOn": "2022-03-30T20:29:29Z",
      "side": 1,
      "message": "\u003e I don\u0027t love this, because there are other .cc files that *also* include gio and this header isn\u0027t in a build-guard for it in BUILD.gn.\n\nGuarded the header in BUILD.gn with the same conditions that are used to define the new `WEBRTC_USE_GIO` symbol and replaced all the macros conditional on this new symbol now. PTAL.\n\n\u003e why cast_shell_linux overrode WEBRTC_USE_PIPEWIRE \n\nMy understanding has evolved a little since last time we spoke. I think the problem here is not the overriding but it is related to the gio header missing when the build config uses `is_chromecast` argument. With this change we are basically avoiding dependency on gio.h when `is_chromecast` is set and that is likely why the `cast_shell_linux` check is passing now (it uses `is_chromecast \u003d true` in the build config: https://ci.chromium.org/ui/p/chromium/builders/try/cast_shell_linux/1171403/overview). I can open a bug to track why the gio.h might be missing for chromecast builds. Let me know if that makes sense.",
      "parentUuid": "e2fcea74_08f8ce67",
      "range": {
        "startLine": 14,
        "startChar": 33,
        "endLine": 14,
        "endChar": 59
      },
      "revId": "b392ce62321f60fc0b2f42df5e1cf1095c73358b",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "825f4ee9_eb7b1365",
        "filename": "modules/desktop_capture/desktop_capture_metadata.h",
        "patchSetId": 28
      },
      "lineNbr": 14,
      "author": {
        "id": 18474
      },
      "writtenOn": "2022-03-30T21:53:22Z",
      "side": 1,
      "message": "Right; but it sounded like modifying the `rtc_use_pipewire` definition (https://source.chromium.org/chromium/chromium/src/+/main:third_party/webrtc/webrtc.gni;l\u003d138) to include `\u0026\u0026 !is_chromecast` wasn\u0027t sufficient to fix this? (I\u0027ll note that there are a few places that do seem to override it to this already).",
      "parentUuid": "32097f29_389b4ad8",
      "range": {
        "startLine": 14,
        "startChar": 33,
        "endLine": 14,
        "endChar": 59
      },
      "revId": "b392ce62321f60fc0b2f42df5e1cf1095c73358b",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    }
  ]
}