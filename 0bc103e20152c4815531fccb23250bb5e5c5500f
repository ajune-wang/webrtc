{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "bf4be4eb_2d83d98b",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 9,
      "author": {
        "id": 5117
      },
      "writtenOn": "2021-05-17T08:57:53Z",
      "side": 1,
      "message": "I think this must be at the very bottom of the description ( right before \"Change-id\" field).",
      "revId": "0bc103e20152c4815531fccb23250bb5e5c5500f",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a4dda749_ec4f4e10",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 5117
      },
      "writtenOn": "2021-05-17T08:57:53Z",
      "side": 1,
      "message": "+R sprang@ WDYT?\n\nI\u0027m a little against this change.\n\n\nMax bitrate is bigger than target mainly for a different reason:\nit\u0027s to facilitate bandwidth estimation ramp-up up-to the point where higher simulcast streams will be enabled.\n\nOf course, giving a better quality and better utilization of the available bandwidth is a reason too, but that\u0027s mostly a bonus.\n\nThis max bitrate is usually considered to be wasteful, so sending up-to max bitrate for all the streams may not be a great idea. If the user would like to get a better quality, they should increase the target bitrate instead (there\u0027s even WebAPI for that). There\u0027s always a trade off: users want quality, but at the same time, they want not to use extreme amount of bandwidth.\n\nFor that reason, default configured bitrates have MAX\u003d\u003dTARGET for supposed top layers [1].\n\nAlso, sending all max bitrates might be a bad configuration for SFUs in conference scenario. Lower streams are there for participants with constrained downlinks. Increasing bitrates at the lower layers would result in lower resolution and frame-rate selected for such users.\n\n[1] https://source.chromium.org/chromium/chromium/src/+/main:third_party/webrtc/media/engine/simulcast.cc;l\u003d94;drc\u003d2afff37ba007429cd1cb65369ee815bceee6f3c9\n\n\n",
      "revId": "0bc103e20152c4815531fccb23250bb5e5c5500f",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "25408f28_f3534495",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 14174
      },
      "writtenOn": "2021-05-18T17:51:52Z",
      "side": 1,
      "message": "hmm, actually i didn\u0027t see api open for target bitrate, we could only set max bitrate and min bitrate. The target is calculated from webrtc internal about 3/4 of max bit. This is the rtp encoding parameter api: https://source.chromium.org/chromium/chromium/src/+/main:third_party/webrtc/api/rtp_parameters.h;l\u003d454?q\u003dstruct%20RtpEncodingParameters%20%7B\u0026ss\u003dchromium%2Fchromium%2Fsrc\n\nI also don\u0027t remember web api support that: https://w3c.github.io/webrtc-pc/#rtcrtpencodingparameters, it even doesn\u0027t open min bitrate to config.\n\nI could understand the argument here,\nsince we have a central module already consider all participant downlinks, we could safely use \u0027max bandwidth\u0027 here (it is actually target, but we don\u0027t have open api to set).\nFor the app without a central BWA module, we may want to keep the low layers\u0027 bitrate low. \nSo I think this depends on what we use this max for",
      "parentUuid": "a4dda749_ec4f4e10",
      "revId": "0bc103e20152c4815531fccb23250bb5e5c5500f",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6e102022_36e97c31",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 5117
      },
      "writtenOn": "2021-05-19T08:41:05Z",
      "side": 1,
      "message": "Oh, yes, my bad. There\u0027s only web API for max bitrate. However, as you\u0027ve said, target bitrate is set to be 3/4 of that. So, again, if the user needs better quality, they may increase the bitrate. Otherwise current bitrates are already selected as a reasonable quality-cost trade-off.\n\nI\u0027m not saying they are the absolute best values and would never need to be adjusted, but the system is just not designed to allocate max bitrate to all layers.",
      "parentUuid": "25408f28_f3534495",
      "revId": "0bc103e20152c4815531fccb23250bb5e5c5500f",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c74b80de_98398beb",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 5524
      },
      "writtenOn": "2021-05-19T09:20:36Z",
      "side": 1,
      "message": "This is a question that has been raised before.\nThe problem with the change as is, is that it effectively raises the minimum bitrate required to receive video by 25% - especially concerning for all existing apps using the default allocations.\n\nI\u0027d be more in favor of ditching the 3/4 target when translating from the web apis to codec config.\nIdeally we\u0027d move to using the SvcRateAllocator for vp8/h264 instead, since it imo has a better algorithm for distributing bitrates and does allow lower streams to ramp up to the specified max.",
      "revId": "0bc103e20152c4815531fccb23250bb5e5c5500f",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "83ad3b97_bc69ba29",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 14174
      },
      "writtenOn": "2021-05-19T18:14:48Z",
      "side": 1,
      "message": "Yea, working on the logic when decide target based on external setup seems another way.\nOne concern is increasing target to max will kind of increasing the bar to trigger next layer a bit (in today setup it is 25%)",
      "parentUuid": "c74b80de_98398beb",
      "revId": "0bc103e20152c4815531fccb23250bb5e5c5500f",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    }
  ]
}