{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "856e9957_51a2b317",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 5963
      },
      "writtenOn": "2024-10-24T14:35:37Z",
      "side": 1,
      "message": "Not sure of what causes it, but I am getting a situtation in which video decoding freezes when using dav1d decoder because dav1d_send_data is returning EAGAIN and we are not draining any pending frames.",
      "revId": "ca1599a0794718dd5ddc7c045cde5cb10bb320b3",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e35b8da3_bd57af96",
        "filename": "modules/video_coding/codecs/av1/dav1d_decoder.cc",
        "patchSetId": 1
      },
      "lineNbr": 142,
      "author": {
        "id": 5825
      },
      "writtenOn": "2024-10-25T11:55:11Z",
      "side": 1,
      "message": "Do we expected decoder to actually deliver frames here? If yes, should we pass them to decode_complete_callback_-\u003eDecoded()?",
      "range": {
        "startLine": 142,
        "startChar": 26,
        "endLine": 142,
        "endChar": 43
      },
      "revId": "ca1599a0794718dd5ddc7c045cde5cb10bb320b3",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4f50c2bd_5850f694",
        "filename": "modules/video_coding/codecs/av1/dav1d_decoder.cc",
        "patchSetId": 1
      },
      "lineNbr": 142,
      "author": {
        "id": 5963
      },
      "writtenOn": "2024-10-25T12:11:41Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "e35b8da3_bd57af96",
      "range": {
        "startLine": 142,
        "startChar": 26,
        "endLine": 142,
        "endChar": 43
      },
      "revId": "ca1599a0794718dd5ddc7c045cde5cb10bb320b3",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0a9fdf4d_2e2cc896",
        "filename": "modules/video_coding/codecs/av1/dav1d_decoder.cc",
        "patchSetId": 1
      },
      "lineNbr": 143,
      "author": {
        "id": 5825
      },
      "writtenOn": "2024-10-25T11:14:14Z",
      "side": 1,
      "message": "Looks like a potential for a dead loop. Should we limit max number of attempts and log an error when the limit is reached?",
      "range": {
        "startLine": 143,
        "startChar": 6,
        "endLine": 143,
        "endChar": 37
      },
      "revId": "ca1599a0794718dd5ddc7c045cde5cb10bb320b3",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9e031771_32cbc072",
        "filename": "modules/video_coding/codecs/av1/dav1d_decoder.cc",
        "patchSetId": 1
      },
      "lineNbr": 143,
      "author": {
        "id": 5963
      },
      "writtenOn": "2024-10-25T11:32:12Z",
      "side": 1,
      "message": "get_picture_res will only be 0 if dav1d_get_picture if operation is success, and a frame is returned, so I don\u0027t think it can dead loop.\n\nAlso note that this is the documented way of draining frames on EOS: \n\n```\n// Handle EOS by draining all buffered frames.\ndo {\n    res \u003d dav1d_get_picture(c, \u0026p);\n    if (res \u003c 0) {\n        if (res !\u003d DAV1D_ERR(EAGAIN))\n            free_and_abort();\n    } else\n        output_and_unref_picture(\u0026p);\n} while (res \u003d\u003d 0);\n```\n\nhttps://videolan.videolan.me/dav1d/dav1d_8h.html#a231e6aa679d5e46fcdac7546f03a6506",
      "parentUuid": "0a9fdf4d_2e2cc896",
      "range": {
        "startLine": 143,
        "startChar": 6,
        "endLine": 143,
        "endChar": 37
      },
      "revId": "ca1599a0794718dd5ddc7c045cde5cb10bb320b3",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3cb9eeb9_f1f6e8e1",
        "filename": "modules/video_coding/codecs/av1/dav1d_decoder.cc",
        "patchSetId": 1
      },
      "lineNbr": 143,
      "author": {
        "id": 5963
      },
      "writtenOn": "2024-10-25T11:36:21Z",
      "side": 1,
      "message": "anyway, happy to add a counter to protect us from potential bugs in dav1d if you feel so.",
      "parentUuid": "9e031771_32cbc072",
      "range": {
        "startLine": 143,
        "startChar": 6,
        "endLine": 143,
        "endChar": 37
      },
      "revId": "ca1599a0794718dd5ddc7c045cde5cb10bb320b3",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b96e6ea0_5350a011",
        "filename": "modules/video_coding/codecs/av1/dav1d_decoder.cc",
        "patchSetId": 1
      },
      "lineNbr": 143,
      "author": {
        "id": 5825
      },
      "writtenOn": "2024-10-25T11:55:11Z",
      "side": 1,
      "message": "I think it would be good to have this protection.",
      "parentUuid": "3cb9eeb9_f1f6e8e1",
      "range": {
        "startLine": 143,
        "startChar": 6,
        "endLine": 143,
        "endChar": 37
      },
      "revId": "ca1599a0794718dd5ddc7c045cde5cb10bb320b3",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    }
  ]
}