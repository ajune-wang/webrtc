{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "7952ce59_26377a6b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 10
      },
      "lineNbr": 0,
      "author": {
        "id": 7015
      },
      "writtenOn": "2022-05-10T08:28:09Z",
      "side": 1,
      "message": "Thanks for the CL! Here is my first bunch of comments, on which let me try to focus on the basic concepts used in the packet arrival history.\n\nThe definition of \"packet delay\" makes it a bit hard to follow, because \"packet delay\" is referenced against a reference packet, while a reference packet is defined as the one that makes all other packets a positive \"packet delay\". These definitions are valid but not completely easy to understand.\n\nI think we are actually sorting \"packet.arrival_time_ms - packet.rtp_timestamp_ms\", so it should be ok to define everything based on this quantity. We can call it \"arrival delay (no reference time)\". Then the comparator in PacketArrival just to compare \"arrival delay\".\n\n",
      "revId": "cf30a87b289132f173a12de86406088c59dc6ff5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c7283b45_61af6616",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 10
      },
      "lineNbr": 0,
      "author": {
        "id": 7015
      },
      "writtenOn": "2022-05-11T21:02:50Z",
      "side": 1,
      "message": "just to release my unsent comments",
      "revId": "cf30a87b289132f173a12de86406088c59dc6ff5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "adbca5d7_60c5f8a7",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 10
      },
      "lineNbr": 0,
      "author": {
        "id": 8038
      },
      "writtenOn": "2022-05-11T23:50:28Z",
      "side": 1,
      "message": "Thanks, I reworded things a bit. Hope it makes more sense now :)",
      "parentUuid": "7952ce59_26377a6b",
      "revId": "cf30a87b289132f173a12de86406088c59dc6ff5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "dacc894c_17e48413",
        "filename": "modules/audio_coding/neteq/decision_logic.h",
        "patchSetId": 10
      },
      "lineNbr": 182,
      "author": {
        "id": 7015
      },
      "writtenOn": "2022-05-10T08:28:09Z",
      "side": 1,
      "message": "is this really necessary? better keep Hz, more generic (support 44100 e.g., even though not a case in current implementation)",
      "range": {
        "startLine": 182,
        "startChar": 6,
        "endLine": 182,
        "endChar": 22
      },
      "revId": "cf30a87b289132f173a12de86406088c59dc6ff5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4e7518e0_21a92e1a",
        "filename": "modules/audio_coding/neteq/decision_logic.h",
        "patchSetId": 10
      },
      "lineNbr": 182,
      "author": {
        "id": 8038
      },
      "writtenOn": "2022-05-11T23:50:28Z",
      "side": 1,
      "message": "Well, we would need to divide it by 1000 every time we use it so it\u0027s just easier to do it once :)",
      "parentUuid": "dacc894c_17e48413",
      "range": {
        "startLine": 182,
        "startChar": 6,
        "endLine": 182,
        "endChar": 22
      },
      "revId": "cf30a87b289132f173a12de86406088c59dc6ff5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2c3dd4bf_f4a79dd2",
        "filename": "modules/audio_coding/neteq/packet_arrival_history.cc",
        "patchSetId": 10
      },
      "lineNbr": 30,
      "author": {
        "id": 7015
      },
      "writtenOn": "2022-05-10T08:28:09Z",
      "side": 1,
      "message": "is history_ sorted by rtp_timestamp_ms? looks to me that it is sorted by arrival time. will this while-loop remove all old packets?",
      "range": {
        "startLine": 30,
        "startChar": 0,
        "endLine": 30,
        "endChar": 62
      },
      "revId": "cf30a87b289132f173a12de86406088c59dc6ff5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "9b1ea28b_1c1c316e",
        "filename": "modules/audio_coding/neteq/packet_arrival_history.cc",
        "patchSetId": 10
      },
      "lineNbr": 30,
      "author": {
        "id": 8038
      },
      "writtenOn": "2022-05-11T23:50:28Z",
      "side": 1,
      "message": "You are correct, it will not remove reordered packets. This is similar to how the relative arrival delay tracker works. This is intentional, although I\u0027m not sure what the performance difference would be if we kept the window based on arrival time instead. I think that we should evaluate that as a follow up.",
      "parentUuid": "2c3dd4bf_f4a79dd2",
      "range": {
        "startLine": 30,
        "startChar": 0,
        "endLine": 30,
        "endChar": 62
      },
      "revId": "cf30a87b289132f173a12de86406088c59dc6ff5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ae9f5559_2d1140e4",
        "filename": "modules/audio_coding/neteq/packet_arrival_history.cc",
        "patchSetId": 10
      },
      "lineNbr": 50,
      "author": {
        "id": 7015
      },
      "writtenOn": "2022-05-10T08:28:09Z",
      "side": 1,
      "message": "to not to be confused with \"arrival time\", should this be called reference_packet. Or \"smallest_arrival_delay\", if you take my suggestion on using the terminology of \"arrival delay\"",
      "range": {
        "startLine": 50,
        "startChar": 4,
        "endLine": 50,
        "endChar": 21
      },
      "revId": "cf30a87b289132f173a12de86406088c59dc6ff5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "bb2db53f_633a8a0b",
        "filename": "modules/audio_coding/neteq/packet_arrival_history.cc",
        "patchSetId": 10
      },
      "lineNbr": 50,
      "author": {
        "id": 8038
      },
      "writtenOn": "2022-05-11T23:50:28Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "ae9f5559_2d1140e4",
      "range": {
        "startLine": 50,
        "startChar": 4,
        "endLine": 50,
        "endChar": 21
      },
      "revId": "cf30a87b289132f173a12de86406088c59dc6ff5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "45848982_a11bbe83",
        "filename": "modules/audio_coding/neteq/packet_arrival_history.h",
        "patchSetId": 10
      },
      "lineNbr": 24,
      "author": {
        "id": 7015
      },
      "writtenOn": "2022-05-10T08:28:09Z",
      "side": 1,
      "message": "fixed window size beyond which",
      "range": {
        "startLine": 24,
        "startChar": 21,
        "endLine": 24,
        "endChar": 44
      },
      "revId": "cf30a87b289132f173a12de86406088c59dc6ff5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d98487cb_66013ba7",
        "filename": "modules/audio_coding/neteq/packet_arrival_history.h",
        "patchSetId": 10
      },
      "lineNbr": 24,
      "author": {
        "id": 8038
      },
      "writtenOn": "2022-05-11T23:50:28Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "45848982_a11bbe83",
      "range": {
        "startLine": 24,
        "startChar": 21,
        "endLine": 24,
        "endChar": 44
      },
      "revId": "cf30a87b289132f173a12de86406088c59dc6ff5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6e7be790_a65f3805",
        "filename": "modules/audio_coding/neteq/packet_arrival_history.h",
        "patchSetId": 10
      },
      "lineNbr": 25,
      "author": {
        "id": 7015
      },
      "writtenOn": "2022-05-10T08:28:09Z",
      "side": 1,
      "message": "calculated",
      "range": {
        "startLine": 25,
        "startChar": 19,
        "endLine": 25,
        "endChar": 29
      },
      "revId": "cf30a87b289132f173a12de86406088c59dc6ff5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "63726360_7876f4d5",
        "filename": "modules/audio_coding/neteq/packet_arrival_history.h",
        "patchSetId": 10
      },
      "lineNbr": 25,
      "author": {
        "id": 8038
      },
      "writtenOn": "2022-05-11T23:50:28Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "6e7be790_a65f3805",
      "range": {
        "startLine": 25,
        "startChar": 19,
        "endLine": 25,
        "endChar": 29
      },
      "revId": "cf30a87b289132f173a12de86406088c59dc6ff5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7aef7e71_c1be77ee",
        "filename": "modules/audio_coding/neteq/packet_arrival_history.h",
        "patchSetId": 10
      },
      "lineNbr": 26,
      "author": {
        "id": 7015
      },
      "writtenOn": "2022-05-10T08:28:09Z",
      "side": 1,
      "message": "sounds a bit circular definition. \"packet delay\" is referenced to a packet with the lowest \"packet delay\". we may need to make it clearer.",
      "range": {
        "startLine": 26,
        "startChar": 8,
        "endLine": 26,
        "endChar": 24
      },
      "revId": "cf30a87b289132f173a12de86406088c59dc6ff5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "01ccedc5_2acef68f",
        "filename": "modules/audio_coding/neteq/packet_arrival_history.h",
        "patchSetId": 10
      },
      "lineNbr": 26,
      "author": {
        "id": 8038
      },
      "writtenOn": "2022-05-11T23:50:28Z",
      "side": 1,
      "message": "Hm...let me see if I can reword this, PTAL.",
      "parentUuid": "7aef7e71_c1be77ee",
      "range": {
        "startLine": 26,
        "startChar": 8,
        "endLine": 26,
        "endChar": 24
      },
      "revId": "cf30a87b289132f173a12de86406088c59dc6ff5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "744c6ca2_87c1abd6",
        "filename": "modules/audio_coding/neteq/packet_arrival_history.h",
        "patchSetId": 10
      },
      "lineNbr": 33,
      "author": {
        "id": 7015
      },
      "writtenOn": "2022-05-10T08:28:09Z",
      "side": 1,
      "message": "I think we either add arrival time as input or don\u0027t mention the second sentence to make this clearer. I prefer adding arrival time as input.",
      "range": {
        "startLine": 32,
        "startChar": 56,
        "endLine": 33,
        "endChar": 34
      },
      "revId": "cf30a87b289132f173a12de86406088c59dc6ff5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "0b766fc1_d02b3aba",
        "filename": "modules/audio_coding/neteq/packet_arrival_history.h",
        "patchSetId": 10
      },
      "lineNbr": 33,
      "author": {
        "id": 8038
      },
      "writtenOn": "2022-05-11T23:50:28Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "744c6ca2_87c1abd6",
      "range": {
        "startLine": 32,
        "startChar": 56,
        "endLine": 33,
        "endChar": 34
      },
      "revId": "cf30a87b289132f173a12de86406088c59dc6ff5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e7f18659_4e5c7cb4",
        "filename": "modules/audio_coding/neteq/packet_arrival_history.h",
        "patchSetId": 10
      },
      "lineNbr": 36,
      "author": {
        "id": 7015
      },
      "writtenOn": "2022-05-10T08:28:09Z",
      "side": 1,
      "message": "delay -\u003e packet delay, to be consistent.",
      "range": {
        "startLine": 36,
        "startChar": 9,
        "endLine": 36,
        "endChar": 14
      },
      "revId": "cf30a87b289132f173a12de86406088c59dc6ff5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ac14bd57_d2422004",
        "filename": "modules/audio_coding/neteq/packet_arrival_history.h",
        "patchSetId": 10
      },
      "lineNbr": 36,
      "author": {
        "id": 8038
      },
      "writtenOn": "2022-05-11T23:50:28Z",
      "side": 1,
      "message": "Well, the rtp_timestamp doesn\u0027t have to be connected to a packet (for example we get the delay of the current playout timestamp).",
      "parentUuid": "e7f18659_4e5c7cb4",
      "range": {
        "startLine": 36,
        "startChar": 9,
        "endLine": 36,
        "endChar": 14
      },
      "revId": "cf30a87b289132f173a12de86406088c59dc6ff5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "332e02e1_b9a1f492",
        "filename": "modules/audio_coding/neteq/packet_arrival_history.h",
        "patchSetId": 10
      },
      "lineNbr": 63,
      "author": {
        "id": 7015
      },
      "writtenOn": "2022-05-10T08:28:09Z",
      "side": 1,
      "message": "Seems that we are essentially sorting by \n\npacket.arrival_time_ms - packet.rtp_timestamp_ms",
      "range": {
        "startLine": 61,
        "startChar": 0,
        "endLine": 63,
        "endChar": 57
      },
      "revId": "cf30a87b289132f173a12de86406088c59dc6ff5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b9f766cf_6fbee76d",
        "filename": "modules/audio_coding/neteq/packet_arrival_history.h",
        "patchSetId": 10
      },
      "lineNbr": 63,
      "author": {
        "id": 7015
      },
      "writtenOn": "2022-05-11T21:02:50Z",
      "side": 1,
      "message": "struct PacketArrival {\n    PacketArrival(uint32_t rtp_timestamp_ms, int arrival_time_ms)\n        : rtp_timestamp_ms(rtp_timestamp_ms),\n          arrival_time_ms(arrival_time_ms),\n          arrival_delay(arrival_time_ms - rtp_timestamp_ms) {}\n    // Unwrapped rtp timestamp scaled to milliseconds.\n    const int64_t rtp_timestamp_ms;\n    const int64_t arrival_time_ms;\n    const int64_t arrival_delay;\n    bool operator\u003d\u003d(const PacketArrival\u0026 other) const {\n      return rtp_timestamp_ms \u003d\u003d other.rtp_timestamp_ms \u0026\u0026\n             arrival_time_ms \u003d\u003d other.arrival_time_ms;\n    }\n    int64_t operator\u003c(const PacketArrival\u0026 other) const {\n      return arrival_delay \u003c other.arrival_delay;\n    }\n  };",
      "parentUuid": "332e02e1_b9a1f492",
      "range": {
        "startLine": 61,
        "startChar": 0,
        "endLine": 63,
        "endChar": 57
      },
      "revId": "cf30a87b289132f173a12de86406088c59dc6ff5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "52be4e71_8a0b9633",
        "filename": "modules/audio_coding/neteq/packet_arrival_history.h",
        "patchSetId": 10
      },
      "lineNbr": 63,
      "author": {
        "id": 8038
      },
      "writtenOn": "2022-05-11T23:50:28Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "b9f766cf_6fbee76d",
      "range": {
        "startLine": 61,
        "startChar": 0,
        "endLine": 63,
        "endChar": 57
      },
      "revId": "cf30a87b289132f173a12de86406088c59dc6ff5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "af324244_2fd26458",
        "filename": "modules/audio_coding/neteq/packet_arrival_history.h",
        "patchSetId": 10
      },
      "lineNbr": 69,
      "author": {
        "id": 7015
      },
      "writtenOn": "2022-05-11T21:02:50Z",
      "side": 1,
      "message": "packet_min_arrival_delay_",
      "range": {
        "startLine": 69,
        "startChar": 32,
        "endLine": 69,
        "endChar": 49
      },
      "revId": "cf30a87b289132f173a12de86406088c59dc6ff5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "137e21ae_47fc7e93",
        "filename": "modules/audio_coding/neteq/packet_arrival_history.h",
        "patchSetId": 10
      },
      "lineNbr": 69,
      "author": {
        "id": 7015
      },
      "writtenOn": "2022-05-11T21:02:50Z",
      "side": 1,
      "message": "I would prefer std::deque\u003cPacketArrival\u003e::iterator or a pointer to PacketArrival",
      "range": {
        "startLine": 69,
        "startChar": 2,
        "endLine": 69,
        "endChar": 31
      },
      "revId": "cf30a87b289132f173a12de86406088c59dc6ff5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "bb08a91d_7ac023ce",
        "filename": "modules/audio_coding/neteq/packet_arrival_history.h",
        "patchSetId": 10
      },
      "lineNbr": 69,
      "author": {
        "id": 8038
      },
      "writtenOn": "2022-05-11T23:50:28Z",
      "side": 1,
      "message": "named this min_packet_arrival_",
      "parentUuid": "af324244_2fd26458",
      "range": {
        "startLine": 69,
        "startChar": 32,
        "endLine": 69,
        "endChar": 49
      },
      "revId": "cf30a87b289132f173a12de86406088c59dc6ff5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ff550ffd_826057cc",
        "filename": "modules/audio_coding/neteq/packet_arrival_history.h",
        "patchSetId": 10
      },
      "lineNbr": 69,
      "author": {
        "id": 8038
      },
      "writtenOn": "2022-05-11T23:50:28Z",
      "side": 1,
      "message": "Done, this works since push_back and pop_front never invalidates any pointer to the rest of the elements according to the spec.",
      "parentUuid": "137e21ae_47fc7e93",
      "range": {
        "startLine": 69,
        "startChar": 2,
        "endLine": 69,
        "endChar": 31
      },
      "revId": "cf30a87b289132f173a12de86406088c59dc6ff5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "addd6891_f52a1a1c",
        "filename": "modules/audio_coding/neteq/packet_arrival_history.h",
        "patchSetId": 10
      },
      "lineNbr": 70,
      "author": {
        "id": 7015
      },
      "writtenOn": "2022-05-11T21:02:50Z",
      "side": 1,
      "message": "packet_max_arrival_delay_",
      "range": {
        "startLine": 70,
        "startChar": 32,
        "endLine": 70,
        "endChar": 47
      },
      "revId": "cf30a87b289132f173a12de86406088c59dc6ff5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "84dd3337_6c40865c",
        "filename": "modules/audio_coding/neteq/packet_arrival_history.h",
        "patchSetId": 10
      },
      "lineNbr": 70,
      "author": {
        "id": 8038
      },
      "writtenOn": "2022-05-11T23:50:28Z",
      "side": 1,
      "message": "named this max_packet_arrival_",
      "parentUuid": "addd6891_f52a1a1c",
      "range": {
        "startLine": 70,
        "startChar": 32,
        "endLine": 70,
        "endChar": 47
      },
      "revId": "cf30a87b289132f173a12de86406088c59dc6ff5",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    }
  ]
}