{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "69202d10_a230095d",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 9405
      },
      "writtenOn": "2021-11-08T02:20:11Z",
      "side": 1,
      "message": "Hi, please take a look. Thanks!",
      "revId": "335078656045a2243ee56145b9681f765d0ea65e",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6b28f4de_a12c14f7",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 5142
      },
      "writtenOn": "2021-11-08T09:15:27Z",
      "side": 1,
      "message": "The spec says that framesPerSecond is \"number of frames in the last second\". The way I interpret this is that this would necessarily always be an integer, so I don\u0027t know why the spec uses double here.\n\nOn the other hand, the way the implementation calculates this is by approximating a second, and calculating a rate that may not be an integer.\n\nHarald can you advice - should the spec be updated to match the implementation, where double makes sense, or should the implementation change so that it knows the true integer number of frames in the last second (in which case the spec should say unsigned int)?",
      "revId": "335078656045a2243ee56145b9681f765d0ea65e",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "576cab61_3d58e08f",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 5634
      },
      "writtenOn": "2021-11-08T09:44:39Z",
      "side": 1,
      "message": "Replying to the spec issue only.\n",
      "revId": "335078656045a2243ee56145b9681f765d0ea65e",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5220279a_24c54462",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 5634
      },
      "writtenOn": "2021-11-08T09:44:39Z",
      "side": 1,
      "message": "I think the definition of RTCVideoSourceStats is not that useful. For the most common non-integer source rate, 29.97 fps, if defined as it says, it will jump up and down between 29 (3/100 of the time) and 30 (97/100 of the time). It\u0027s also one of the very few places in stats where we say that we calculate something over a precise interval.\n\nI\u0027m happy leaving it as double, but think that we might add some words to the definition to say that it\u0027s a double to leave some room for approximation.",
      "parentUuid": "6b28f4de_a12c14f7",
      "revId": "335078656045a2243ee56145b9681f765d0ea65e",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "20cde3f7_9d44a7f1",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 5142
      },
      "writtenOn": "2021-11-08T10:05:50Z",
      "side": 1,
      "message": "OK. If we\u0027re interpreting the spec as an approximation, then the current rate tracker makes sense and SGTM to update to double like this CL is doing.\n\nI don\u0027t think the current RateTracker does any attempt to avoid reporting toggly values, but if it\u0027s an approximation then that is not necessarily bad, and any improvements could be done separately from updating this to double.",
      "parentUuid": "5220279a_24c54462",
      "revId": "335078656045a2243ee56145b9681f765d0ea65e",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "aeb63af2_9caaae48",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 5142
      },
      "writtenOn": "2021-11-08T10:05:50Z",
      "side": 1,
      "message": "LGTM",
      "revId": "335078656045a2243ee56145b9681f765d0ea65e",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "09969988_ca202891",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 9405
      },
      "writtenOn": "2021-11-08T13:56:27Z",
      "side": 1,
      "message": "I have submitted an issue to the spec repository. https://github.com/w3c/webrtc-stats/issues/612\n\nIf this implementation is okay as an approximation of what the spec wants, I think it would be nice to land this as is.\n\nI also discovered that the definitions of RTCInboundRtpStreamStats.framesPerSecond and RTCOutboundRtpStreamStats.framesPerSecond are doubles, but they are internally rounded to integers. I\u0027ll file a bug about this and fix it later.",
      "parentUuid": "20cde3f7_9d44a7f1",
      "revId": "335078656045a2243ee56145b9681f765d0ea65e",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e4a806fc_38271d45",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 5142
      },
      "writtenOn": "2021-11-08T14:22:58Z",
      "side": 1,
      "message": "Thanks. I think we should land this CL. But you\u0027ll need to add more reviewers to get all the OWNERS approvals",
      "parentUuid": "09969988_ca202891",
      "revId": "335078656045a2243ee56145b9681f765d0ea65e",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "af623dd5_af671b00",
        "filename": "video/send_statistics_proxy.cc",
        "patchSetId": 1
      },
      "lineNbr": 740,
      "author": {
        "id": 5142
      },
      "writtenOn": "2021-11-08T09:15:27Z",
      "side": 1,
      "message": "This is initialized as \"input_frame_rate_tracker_(100, 10u)\"\n\nhttps://source.chromium.org/chromium/chromium/src/+/main:third_party/webrtc/video/send_statistics_proxy.h;drc\u003df78106f1fb37b3aa9e660993c62e645ea92f34f1;bpv\u003d1;bpt\u003d1;l\u003d345\n\nWhich calculates FPS according to rates into buckets of a RateTracker...\n\nhttps://source.chromium.org/chromium/chromium/src/+/main:third_party/webrtc/rtc_base/rate_tracker.h;l\u003d24;drc\u003df78106f1fb37b3aa9e660993c62e645ea92f34f1;bpv\u003d1;bpt\u003d1\n\nWhile this approximates the number of frames in the last second, the bucketization logic means the actual interval we get is a multiple of the buckets, and so we may get an interval other than 1 second:\n\nhttps://source.chromium.org/chromium/chromium/src/+/main:third_party/webrtc/rtc_base/rate_tracker.cc;l\u003d90;drc\u003df78106f1fb37b3aa9e660993c62e645ea92f34f1;bpv\u003d1;bpt\u003d1\n\nThis may yield non-integer frame rates... but the spec says that framesPerSecond is \"the number of frames in the last second\", which would always be an integer. Even though the spec uses the type double.",
      "revId": "335078656045a2243ee56145b9681f765d0ea65e",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "21abeed7_750c94e0",
        "filename": "video/send_statistics_proxy.cc",
        "patchSetId": 1
      },
      "lineNbr": 740,
      "author": {
        "id": 5142
      },
      "writtenOn": "2021-11-08T10:05:50Z",
      "side": 1,
      "message": "Resolving this based on other comment.",
      "parentUuid": "af623dd5_af671b00",
      "revId": "335078656045a2243ee56145b9681f765d0ea65e",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    }
  ]
}