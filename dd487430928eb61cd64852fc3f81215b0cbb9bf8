{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "9e4c09c0_81e5660a",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 7641
      },
      "writtenOn": "2024-09-02T07:50:32Z",
      "side": 1,
      "message": "Sergey, can you take a first look at this CL?",
      "revId": "dd487430928eb61cd64852fc3f81215b0cbb9bf8",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e119d8b3_4e70590a",
        "filename": "modules/video_coding/codecs/av1/libaom_av1_encoder.cc",
        "patchSetId": 1
      },
      "lineNbr": 874,
      "author": {
        "id": 5825
      },
      "writtenOn": "2024-09-02T08:34:02Z",
      "side": 1,
      "message": "I think we need a field trial that modifies QP threshold in QualityConvergenceController and sets the final value to: `convergence_qp_threshold \u003d max(qp_threhsold_from_field_trial, encoder_min_qp)`.\n\nEncoderInfo::min_qp should be set to what encoder is configured to use.",
      "range": {
        "startLine": 874,
        "startChar": 7,
        "endLine": 874,
        "endChar": 13
      },
      "revId": "dd487430928eb61cd64852fc3f81215b0cbb9bf8",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "72154879_e936db1a",
        "filename": "modules/video_coding/codecs/av1/libaom_av1_encoder.cc",
        "patchSetId": 1
      },
      "lineNbr": 874,
      "author": {
        "id": 7641
      },
      "writtenOn": "2024-09-02T08:37:26Z",
      "side": 1,
      "message": "Wasn\u0027t the idea with the min_qp in EncoderInfo that we wanted to keep the qp threshold in the encoder? So that the threshold should not diverge from what is used in the encoder?",
      "parentUuid": "e119d8b3_4e70590a",
      "range": {
        "startLine": 874,
        "startChar": 7,
        "endLine": 874,
        "endChar": 13
      },
      "revId": "dd487430928eb61cd64852fc3f81215b0cbb9bf8",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3d1dadd3_42b5022f",
        "filename": "modules/video_coding/codecs/av1/libaom_av1_encoder.cc",
        "patchSetId": 1
      },
      "lineNbr": 874,
      "author": {
        "id": 5825
      },
      "writtenOn": "2024-09-02T08:46:53Z",
      "side": 1,
      "message": "We want encoder to expose its min_qp so that components which depend on it (like quality convergence) can make right decision (make sure the threshold is \u003e\u003d to what encoder uses).",
      "parentUuid": "72154879_e936db1a",
      "range": {
        "startLine": 874,
        "startChar": 7,
        "endLine": 874,
        "endChar": 13
      },
      "revId": "dd487430928eb61cd64852fc3f81215b0cbb9bf8",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6dcee893_20464e73",
        "filename": "modules/video_coding/codecs/av1/libaom_av1_encoder.cc",
        "patchSetId": 1
      },
      "lineNbr": 874,
      "author": {
        "id": 7641
      },
      "writtenOn": "2024-09-02T09:13:26Z",
      "side": 1,
      "message": "I\u0027ll rework the code. I can see that it makes experimenting with the threshold simpler with an independent Finch parameter, but I still believe that it kind of breaks the reason to have a min qp reported by the encoder.",
      "parentUuid": "3d1dadd3_42b5022f",
      "range": {
        "startLine": 874,
        "startChar": 7,
        "endLine": 874,
        "endChar": 13
      },
      "revId": "dd487430928eb61cd64852fc3f81215b0cbb9bf8",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "45915a1e_078812f5",
        "filename": "modules/video_coding/codecs/av1/libaom_av1_encoder.cc",
        "patchSetId": 1
      },
      "lineNbr": 874,
      "author": {
        "id": 5825
      },
      "writtenOn": "2024-09-02T09:32:21Z",
      "side": 1,
      "message": "Encoder knows nothing about quality convergence. It is quality convergence algo that needs to know encoder\u0027s min QP to guarantee this:\n\n```\nconvergence_qp_threshold \u003d max(qp_threhsold_from_field_trial, encoder_min_qp).\n```\n\nThis is why we need to report min_qp in EncoderInfo. But we don\u0027t need to adjust its value for users like quality convergence about which encoder knows nothing.\n\nIt is not about simplicity. It is about proper API and component boundaries.",
      "parentUuid": "6dcee893_20464e73",
      "range": {
        "startLine": 874,
        "startChar": 7,
        "endLine": 874,
        "endChar": 13
      },
      "revId": "dd487430928eb61cd64852fc3f81215b0cbb9bf8",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a14b727a_44918000",
        "filename": "modules/video_coding/codecs/av1/libaom_av1_encoder.cc",
        "patchSetId": 1
      },
      "lineNbr": 874,
      "author": {
        "id": 7641
      },
      "writtenOn": "2024-09-02T12:20:01Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "45915a1e_078812f5",
      "range": {
        "startLine": 874,
        "startChar": 7,
        "endLine": 874,
        "endChar": 13
      },
      "revId": "dd487430928eb61cd64852fc3f81215b0cbb9bf8",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    }
  ]
}