{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "da0d0993_db3b9898",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 16681
      },
      "writtenOn": "2022-04-27T15:10:30Z",
      "side": 1,
      "message": "I relaxed the resolution alignment requirement from 16 to 2.",
      "revId": "08292b90fc11db3be3f7b0e4edfd9bf600cc2073",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a168fbc3_54fbedf3",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 9405
      },
      "writtenOn": "2022-04-27T21:51:32Z",
      "side": 1,
      "message": "I\u0027m not an OWNER of these codes, so I added a proper OWNER for these codes.",
      "revId": "08292b90fc11db3be3f7b0e4edfd9bf600cc2073",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7cdfeac2_9396b024",
        "filename": "sdk/android/src/java/org/webrtc/HardwareVideoEncoder.java",
        "patchSetId": 2
      },
      "lineNbr": 54,
      "author": {
        "id": 9405
      },
      "writtenOn": "2022-04-27T21:51:32Z",
      "side": 1,
      "message": "In my comment (https://bugs.webrtc.org/13973#c5), I meant that you could add alternative behavior (for example, pixel alignment requirement 2 or using MediaCodecInfo.VideoCapabilities). However, these changes should be behind the field trial, so other users of WebRTC Android don\u0027t affect. (i.e., Using with pixel alignment requirement 16)",
      "revId": "08292b90fc11db3be3f7b0e4edfd9bf600cc2073",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f1e56394_586a5b38",
        "filename": "sdk/android/src/java/org/webrtc/HardwareVideoEncoder.java",
        "patchSetId": 2
      },
      "lineNbr": 54,
      "author": {
        "id": 16681
      },
      "writtenOn": "2022-04-28T05:21:06Z",
      "side": 1,
      "message": "Sorry for misunderstanding.\n\nAfter researching, I found several fields as follows and test codes using field trial.\n\n- WebRTC-GetEncoderInfoOverride/requested_resolution_alignment:3/\n- WebRTC-VP8-GetEncoderInfoOverride/requested_resolution_alignment:2/\n\nI tested it with the following Kotlin code to override requested_resolution_alignment but it didn\u0027t work.\n\n```\n                val options \u003d PeerConnectionFactory.InitializationOptions\n                    .builder(context)\n                    .setEnableInternalTracer(false)\n                    .setFieldTrials(\"WebRTC-GetEncoderInfoOverride/requested_resolution_alignment:9/\")\n                    .createInitializationOptions()\n                PeerConnectionFactory.initialize(options)\n```\n\nPlease tell me if my understanding is correct:\n\n- Need to define a new field to override requested_resolution_alignment of Android\u0027s HardwareVideoEncoder\n- If the field specified, the default value (currently 16) should be overridden with the specified value\n\nAdditionally, if there are any documents I should read to lean field trial, please let me aknow.\nFor example, is there a comprehensive list of all field trials?",
      "parentUuid": "7cdfeac2_9396b024",
      "revId": "08292b90fc11db3be3f7b0e4edfd9bf600cc2073",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "10953b86_c3dcbf48",
        "filename": "sdk/android/src/java/org/webrtc/HardwareVideoEncoder.java",
        "patchSetId": 2
      },
      "lineNbr": 54,
      "author": {
        "id": 9405
      },
      "writtenOn": "2022-04-28T06:05:11Z",
      "side": 1,
      "message": "\u003e After researching, I found several fields as follows and test codes using field trial.\n\u003e \n\u003e - WebRTC-GetEncoderInfoOverride/requested_resolution_alignment:3/\n\u003e - WebRTC-VP8-GetEncoderInfoOverride/requested_resolution_alignment:2/\n\u003e \n\u003e I tested it with the following Kotlin code to override requested_resolution_alignment but it didn\u0027t work.\n\n\nThe field trials you mentioned aren\u0027t for this, and you need to make another one to implement what you want.\n\n\u003e Please tell me if my understanding is correct:\n\u003e \n\u003e - Need to define a new field to override requested_resolution_alignment of Android\u0027s HardwareVideoEncoder\n\u003e - If the field specified, the default value (currently 16) should be overridden with the specified value\n\nIt seems like your description is a correct way to implement it.\n\n\u003e Additionally, if there are any documents I should read to lean field trial, please let me aknow.\n\u003e For example, is there a comprehensive list of all field trials?\n\nThere isn\u0027t a complete list of all field trials, but you\u0027ll find lots of field trials from the WebRTC codebase.\nhttps://source.chromium.org/search?q\u003dfield_%3Ftrial%20f:webrtc%20(lang:c%2B%2B%20OR%20lang:java)\u0026ss\u003dchromium%2Fchromium%2Fsrc\n\nFor example, \"WebRTC-Audio-MinimizeResamplingOnMobile\" is used as a boolean value in media/engine/webrtc_voice_engine.cc.",
      "parentUuid": "f1e56394_586a5b38",
      "revId": "08292b90fc11db3be3f7b0e4edfd9bf600cc2073",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "66da1310_aa5f00a0",
        "filename": "sdk/android/src/java/org/webrtc/HardwareVideoEncoder.java",
        "patchSetId": 2
      },
      "lineNbr": 54,
      "author": {
        "id": 16681
      },
      "writtenOn": "2022-04-29T09:07:13Z",
      "side": 1,
      "message": "Thank you.\nCould you give me additional advice?\n\nAt first, I tried and was able to access field trial values in sdk/android/src/jni/video_encoder_wrapper.cc.\nHowever, I could only update requested_resolution_alignment in C++. In Java, it\u0027s defined as a final variable.\n\nThen, I tried to use PeerConnectionFactory.fieldTrialsFindFullName in HardwareVideoEncoder.java. Unfortunately, I couldn\u0027t build it due to a dependency cycle error.\n\nNow I\u0027m thinking about implementing a wrapper function of webrtc::field_trial::FindFullName to Java EncoderInfo class or somewhere and use it from HardwareVideoEncoder.java.\n\nIs there any other straight-forward way to access field trial values?",
      "parentUuid": "10953b86_c3dcbf48",
      "revId": "08292b90fc11db3be3f7b0e4edfd9bf600cc2073",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e7b93ffe_0ea24f49",
        "filename": "sdk/android/src/java/org/webrtc/HardwareVideoEncoder.java",
        "patchSetId": 2
      },
      "lineNbr": 54,
      "author": {
        "id": 9405
      },
      "writtenOn": "2022-04-29T09:36:19Z",
      "side": 1,
      "message": "Hmm. In that case, I don\u0027t know.\n\njonaso@, it looks like you\u0027ve been working on field trials lately. Can you give us some advice?",
      "parentUuid": "66da1310_aa5f00a0",
      "revId": "08292b90fc11db3be3f7b0e4edfd9bf600cc2073",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6f2156df_158a0fab",
        "filename": "sdk/android/src/java/org/webrtc/HardwareVideoEncoder.java",
        "patchSetId": 2
      },
      "lineNbr": 54,
      "author": {
        "id": 8527
      },
      "writtenOn": "2022-05-06T06:09:31Z",
      "side": 1,
      "message": "Hi,\n\nSorry for late reply.\n\n1) About the change: Why do you want to change this ?\nThe current value 16, is most certainly set to avoid bugs in hw-encoders\non misc chipsets. Bugs in hw-encoders are not uncommon and using safety margin\nis \"standard procedure\".\n\nSpeculation: if you want to use hw-encoder on a resolution that is not a multiple of 16, then maybe you can capture a multiple of 16, and then crop away the part that you don\u0027t want ?\n\n2) Using PeerConnectionFactory.fieldTrialsFindFullName is the \"correct\" solution.\nCan you do a version with that, and I can help fix build problem ?\n\nWDYT ?",
      "parentUuid": "e7b93ffe_0ea24f49",
      "revId": "08292b90fc11db3be3f7b0e4edfd9bf600cc2073",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "63516ee2_6b373de3",
        "filename": "sdk/android/src/java/org/webrtc/HardwareVideoEncoder.java",
        "patchSetId": 2
      },
      "lineNbr": 54,
      "author": {
        "id": 9405
      },
      "writtenOn": "2022-05-06T06:23:32Z",
      "side": 1,
      "message": "Aha, I thought `fieldTrialsFindFullName` was a non-static method, so I wondered if we should send the field trial string from C++ to Java as `NetworkMonitor.java does`. But, that method was static, so it is okay then.",
      "parentUuid": "6f2156df_158a0fab",
      "revId": "08292b90fc11db3be3f7b0e4edfd9bf600cc2073",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "44571ef4_3c3b559f",
        "filename": "sdk/android/src/java/org/webrtc/HardwareVideoEncoder.java",
        "patchSetId": 2
      },
      "lineNbr": 54,
      "author": {
        "id": 16681
      },
      "writtenOn": "2022-05-07T10:32:44Z",
      "side": 1,
      "message": "jonaso@\n\nHi,\n\nThanks for the reply.\n\n\u003e 1) About the change: Why do you want to change this ?\n\u003e ...\n\nAs I mentioned previously, in the following issue, I think it\u0027s nice to have a way to opt-out of the restriction.\nI don\u0027t mean to change the default behavior.\nThat\u0027s why I want to use field trials.\n\nhttps://bugs.chromium.org/p/webrtc/issues/detail?id\u003d13973\n\u003e - Some well-used resolutions like FHD: 1920x1080 are affected.\n\u003e - Some products are developed for specific Android devices and specific resolution. For those use cases, no need to implement the strict check on libwebrtc.\n\n\u003e 2) Using PeerConnectionFactory.fieldTrialsFindFullName is the \"correct\" solution.\n\u003e Can you do a version with that, and I can help fix build problem ?\n\nAppreciate your help.\n\nI updated a new patchset.\nIn that patchset. I tried to use PeerConnectionFactory.fieldTrialsFindFullName in HardwareVideoEncoder.java but I got the error as follows.\nCould you give me advice on this?\n\n\u003e ...\n\u003e INFO:root:Arch: x86_64\n\u003e INFO:root:Building: arm64-v8a\n\u003e ERROR Dependency cycle:\n\u003e   //sdk/android:default_video_codec_factory_java__build_config_crbug_908819 -\u003e\n\u003e   //sdk/android:hwcodecs_java__build_config_crbug_908819 -\u003e\n\u003e   //sdk/android:peerconnection_java__build_config_crbug_908819 -\u003e\n\u003e   //sdk/android:default_video_codec_factory_java__build_config_crbug_908819\n\u003e ...",
      "parentUuid": "63516ee2_6b373de3",
      "revId": "08292b90fc11db3be3f7b0e4edfd9bf600cc2073",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    }
  ]
}