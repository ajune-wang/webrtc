{
  "comments": [
    {
      "key": {
        "uuid": "b2ce6429_491447f1",
        "filename": "rtc_base/format_macros.h",
        "patchSetId": 4
      },
      "lineNbr": 42,
      "author": {
        "id": 5126
      },
      "writtenOn": "2019-08-07T10:38:20Z",
      "side": 1,
      "message": "We already use %zu in a handful of places: https://cs.chromium.org/search/?q\u003d%25zu+file:webrtc\u0026sq\u003dpackage:chromium\u0026type\u003dcs\n\nDoesen\u0027t that mean we could live without this macro?",
      "revId": "39b5f4e8afaa3833e8826dd26c3fbe7bd5384fbf",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "195800ec_76ad12f8",
        "filename": "rtc_base/format_macros.h",
        "patchSetId": 4
      },
      "lineNbr": 42,
      "author": {
        "id": 5234
      },
      "writtenOn": "2019-08-07T10:54:21Z",
      "side": 1,
      "message": "I think we should either delete the macro, or use it everywhere.\n\nWhat\u0027s the failure mode if we attempt to use %zu with the microsoft C library not supporting it? I\u0027d guess we\u0027ll get %zu printed literally without consuming any argument, and then the remaining format specifiers are out of sync with the arguments (at least, that\u0027s how glibc treats unknown format specifiers). Example program:\n\n  #include \u003cstdio.h\u003e\n\n  int main (int argc, char **argv) {\n    printf (\"%d %y %d %d\\n\", 1,2,3,4);\n    return 0;\n  }\n\nproduces a compiler warning (with gcc -Wall), and when run the output is\n\n  1 %y 2 3",
      "parentUuid": "b2ce6429_491447f1",
      "revId": "39b5f4e8afaa3833e8826dd26c3fbe7bd5384fbf",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2851dbc7_131cc488",
        "filename": "rtc_base/format_macros.h",
        "patchSetId": 4
      },
      "lineNbr": 42,
      "author": {
        "id": 5114
      },
      "writtenOn": "2019-08-07T11:23:37Z",
      "side": 1,
      "message": "I don\u0027t see deleting this macro as viable, and regardless of that, it will not be part of this CL.\n\nWe could live without this macro if we accept that we will cause WebRTC to get really obscure failures on old MSVC.\n\n\u003e We already use %zu in a handful of places \n\nSo the problems probably already exist and may be security problems. I\u0027m particularly worried about snprintf and sscanf:\n\nhttps://cs.chromium.org/search/?q\u003d%25zu+file:webrtc+%2Bsnprintf%7Csscanf",
      "parentUuid": "195800ec_76ad12f8",
      "revId": "39b5f4e8afaa3833e8826dd26c3fbe7bd5384fbf",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3588c7ec_2ef37904",
        "filename": "rtc_base/format_macros.h",
        "patchSetId": 4
      },
      "lineNbr": 56,
      "author": {
        "id": 5126
      },
      "writtenOn": "2019-08-07T10:38:20Z",
      "side": 1,
      "message": "I can\u0027t fine any uses of these three.",
      "revId": "39b5f4e8afaa3833e8826dd26c3fbe7bd5384fbf",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0d7a2730_1c0d3630",
        "filename": "rtc_base/format_macros.h",
        "patchSetId": 4
      },
      "lineNbr": 56,
      "author": {
        "id": 5114
      },
      "writtenOn": "2019-08-07T11:23:37Z",
      "side": 1,
      "message": "Good point. I don\u0027t much care for that, but I can just make another CL to delete them.",
      "parentUuid": "3588c7ec_2ef37904",
      "revId": "39b5f4e8afaa3833e8826dd26c3fbe7bd5384fbf",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ed2ec847_eb1bb247",
        "filename": "rtc_base/format_macros.h",
        "patchSetId": 4
      },
      "lineNbr": 56,
      "author": {
        "id": 5126
      },
      "writtenOn": "2019-08-07T11:47:45Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "0d7a2730_1c0d3630",
      "revId": "39b5f4e8afaa3833e8826dd26c3fbe7bd5384fbf",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1ef05f46_8e8bad79",
        "filename": "rtc_base/format_macros.h",
        "patchSetId": 4
      },
      "lineNbr": 83,
      "author": {
        "id": 5126
      },
      "writtenOn": "2019-08-07T10:38:20Z",
      "side": 1,
      "message": "Since we apparently use raw %zu without breaking, does this mean we could remove PRI*64 too?",
      "revId": "39b5f4e8afaa3833e8826dd26c3fbe7bd5384fbf",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e63a22c2_d0dfcec2",
        "filename": "rtc_base/format_macros.h",
        "patchSetId": 4
      },
      "lineNbr": 83,
      "author": {
        "id": 5114
      },
      "writtenOn": "2019-08-07T11:23:37Z",
      "side": 1,
      "message": "\u003e Since we apparently use raw %zu without breaking\n\nHow can you make that claim? I\u0027m sure it\u0027s very much breaking, just that we don\u0027t test it.",
      "parentUuid": "1ef05f46_8e8bad79",
      "revId": "39b5f4e8afaa3833e8826dd26c3fbe7bd5384fbf",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1eac1407_b66c6925",
        "filename": "rtc_base/format_macros.h",
        "patchSetId": 4
      },
      "lineNbr": 83,
      "author": {
        "id": 5126
      },
      "writtenOn": "2019-08-07T11:47:45Z",
      "side": 1,
      "message": "Ah, I was assuming that printf would do something sensible when given an unrecognized format parameter. My bad.\n\nThat said, IIRC we went from the oldest supported MSVC being 2013 to 2015 to 2017 before finally dropping MSVC support, so how sure are you that these old compilers need supporting?",
      "parentUuid": "e63a22c2_d0dfcec2",
      "revId": "39b5f4e8afaa3833e8826dd26c3fbe7bd5384fbf",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "47a9e653_bda6cb64",
        "filename": "rtc_base/format_macros.h",
        "patchSetId": 4
      },
      "lineNbr": 83,
      "author": {
        "id": 5234
      },
      "writtenOn": "2019-08-07T11:59:09Z",
      "side": 1,
      "message": "\u003e Ah, I was assuming that printf would do something sensible when given an unrecognized format parameter.\n\nI see no way for printf to skip the corresponding argument without knowing what type it is.\nIt could crash on the spot, if you consider that sensible (it would at least avoid subtle security implications), but I\u0027d be a bit surprised if an implementation did that.",
      "parentUuid": "1eac1407_b66c6925",
      "revId": "39b5f4e8afaa3833e8826dd26c3fbe7bd5384fbf",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "dbcf2584_19f61b1e",
        "filename": "rtc_base/format_macros.h",
        "patchSetId": 4
      },
      "lineNbr": 83,
      "author": {
        "id": 5126
      },
      "writtenOn": "2019-08-07T12:06:06Z",
      "side": 1,
      "message": "Crashing was what I had in mind, but yes, that would be out of character for the C standard library. It could plausibly turn into a no-op, though, or stop printing+consuming arguments when it encountered the unknown format.",
      "parentUuid": "47a9e653_bda6cb64",
      "revId": "39b5f4e8afaa3833e8826dd26c3fbe7bd5384fbf",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4d83521d_04ab4d50",
        "filename": "rtc_base/format_macros.h",
        "patchSetId": 4
      },
      "lineNbr": 83,
      "author": {
        "id": 5114
      },
      "writtenOn": "2019-08-07T12:09:46Z",
      "side": 1,
      "message": "\u003e IIRC we went from the oldest supported MSVC being 2013 to 2015 to 2017\n\nI don\u0027t think we ever officially dropped support (or I just don\u0027t know any reference to such an event), it probably just happened by itself because we only test on latest.\n\nWell then, follow up to remove PRI*64 because Chromium has done it long ago:\nhttps://webrtc-review.googlesource.com/c/src/+/148443",
      "parentUuid": "dbcf2584_19f61b1e",
      "revId": "39b5f4e8afaa3833e8826dd26c3fbe7bd5384fbf",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767",
      "unresolved": false
    }
  ]
}