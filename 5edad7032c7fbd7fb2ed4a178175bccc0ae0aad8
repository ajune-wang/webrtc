{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "fd4aa880_730f17bc",
        "filename": "common_video/libyuv/webrtc_libyuv.cc",
        "patchSetId": 4
      },
      "lineNbr": 258,
      "author": {
        "id": 5525
      },
      "writtenOn": "2022-03-23T15:26:47Z",
      "side": 1,
      "message": "What does YUV mean? I420PSNR() also computes PSNR based on Y, U and V, right? Isn\u0027t it only the weights that differ?",
      "range": {
        "startLine": 258,
        "startChar": 15,
        "endLine": 258,
        "endChar": 18
      },
      "revId": "5edad7032c7fbd7fb2ed4a178175bccc0ae0aad8",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2db09e1b_3d5e8027",
        "filename": "common_video/libyuv/webrtc_libyuv.cc",
        "patchSetId": 4
      },
      "lineNbr": 258,
      "author": {
        "id": 5023
      },
      "writtenOn": "2022-03-23T15:45:14Z",
      "side": 1,
      "message": "Yes, both PSNR metrics are calculating the distortion for Y, U, and V, but in different ways. The existing metric [bunches the squared error of all planes together](https://source.chromium.org/chromium/chromium/src/+/main:third_party/libyuv/source/compare.cc;l\u003d312;drc\u003d3624432200505d1314429803fda95e8f37a83c6a), whereas the added metric keeps the squared errors of the planes separate. The final metric is then the linearly weighted dB version of the per-plane PSNRs. TBH, I don\u0027t know why the weight for luma is 6 instead of 4, but that is how it is defined in the paper...\n\nI used the name \"PSNRYUV\" in the code since \"PSNR_{YUV}\" is the name of the metric in the original paper. The \"Video Coding: Part II of Fundamentals of Source and Video Coding\" book refers to it as \"PSNR_{YCbCr}\", which I guess is more correct.\n\nMaybe it\u0027s a bit unclear to use the literature name in the code. I could change the function name to \"I420WeightedPSNR\", wdyt? I have no strong preferences.",
      "parentUuid": "fd4aa880_730f17bc",
      "range": {
        "startLine": 258,
        "startChar": 15,
        "endLine": 258,
        "endChar": 18
      },
      "revId": "5edad7032c7fbd7fb2ed4a178175bccc0ae0aad8",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e5c08f40_34a9b655",
        "filename": "common_video/libyuv/webrtc_libyuv.cc",
        "patchSetId": 4
      },
      "lineNbr": 258,
      "author": {
        "id": 5525
      },
      "writtenOn": "2022-03-23T15:46:59Z",
      "side": 1,
      "message": "Ah, got it. I like the I420WeightedPSNR name.",
      "parentUuid": "2db09e1b_3d5e8027",
      "range": {
        "startLine": 258,
        "startChar": 15,
        "endLine": 258,
        "endChar": 18
      },
      "revId": "5edad7032c7fbd7fb2ed4a178175bccc0ae0aad8",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "311ad625_fe0c234d",
        "filename": "common_video/libyuv/webrtc_libyuv.cc",
        "patchSetId": 4
      },
      "lineNbr": 258,
      "author": {
        "id": 5023
      },
      "writtenOn": "2022-03-23T19:02:40Z",
      "side": 1,
      "message": "Done, renamed to `I420WeightedPSNR`.",
      "parentUuid": "e5c08f40_34a9b655",
      "range": {
        "startLine": 258,
        "startChar": 15,
        "endLine": 258,
        "endChar": 18
      },
      "revId": "5edad7032c7fbd7fb2ed4a178175bccc0ae0aad8",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ee48e7d5_d12a52c7",
        "filename": "test/pc/e2e/analyzer/video/default_video_quality_analyzer_shared_objects.h",
        "patchSetId": 4
      },
      "lineNbr": 216,
      "author": {
        "id": 6337
      },
      "writtenOn": "2022-03-23T16:26:49Z",
      "side": 1,
      "message": "Does it make sense to compute both weighted and regular PSNR?",
      "range": {
        "startLine": 213,
        "startChar": 2,
        "endLine": 216,
        "endChar": 33
      },
      "revId": "5edad7032c7fbd7fb2ed4a178175bccc0ae0aad8",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "8ec7ae5a_bde16fdb",
        "filename": "test/pc/e2e/analyzer/video/default_video_quality_analyzer_shared_objects.h",
        "patchSetId": 4
      },
      "lineNbr": 216,
      "author": {
        "id": 5023
      },
      "writtenOn": "2022-03-23T19:02:40Z",
      "side": 1,
      "message": "No, I don\u0027t think so: I haven\u0027t directly compared the metrics, but my guess is that they are similar enough that one of them is enough for regression tests, but different enough for opinionated test authors to pick one over the other. So it wouldn\u0027t be worth the time to compute both.\n\nBtw, I snuck in the change with `compute_ssim` in this CL, even though it has nothing to do with the added PSNR metric. The reason is that a downstream test I\u0027m writing will use PSNR, but not SSIM, and I\u0027d like to save some CPU cycles by not computing the latter.",
      "parentUuid": "ee48e7d5_d12a52c7",
      "range": {
        "startLine": 213,
        "startChar": 2,
        "endLine": 216,
        "endChar": 33
      },
      "revId": "5edad7032c7fbd7fb2ed4a178175bccc0ae0aad8",
      "serverId": "58829da1-049c-39fb-b951-ebdcd0984767"
    }
  ]
}